---
title: "Bulk RNA-seq | From reads to DEGs"
date: "2025-07-28"
# image: slurm.png
categories: [NGS, RNA-seq, scRNA-seq]
execute:
    eval: false
---

## Overall Workflow
![RNA-seq Workflow](counts-workflow.png)

### Counting reads associated with genes
- featureCounts (subread package)
- HTSeq-count


    The above tools only report the “raw” counts of reads that map to a single location (uniquely mapping) and are best at counting at the gene level. Essentially, total read count associated with a gene (meta-feature) = the sum of reads associated with each of the exons (feature) that “belong” to that gene.

    There are other tools available that are able to account for multiple transcripts for a given gene. In this case the counts are not whole numbers, but have fractions. In the simplest example case, if 1 read is associated with 2 transcripts, it can get counted as 0.5 and 0.5 and the resulting count for that transcript is not a whole number.

    In addition there are other tools that will count multimapping reads, but this is a dangerous thing to do since you will be overcounting the total number of reads which can cause issues with normalization and eventually with accuracy of differential gene expression results.


## DEG Analysis Tools

DESeq2, edgeR, and limma are widely used Bioconductor packages in R for differential gene expression analysis of RNA-seq or microarray data. Each employs distinct statistical approaches to identify differentially expressed genes, with differences in their underlying models, assumptions, and use cases. Below is an introduction and a summary of their key differences.

- **DESeq2**: DESeq2 is designed for analyzing count-based data, primarily RNA-seq, using a negative binomial distribution to model read counts. It estimates variance-mean dependence in count data and applies shrinkage techniques for dispersion and fold-change estimates to improve robustness, especially for low-count genes. DESeq2 is particularly suited for experiments with small sample sizes and handles complex experimental designs well.

- **edgeR**: edgeR (empirical analysis of digital gene expression in R) is also tailored for count-based data like RNA-seq, using a negative binomial model. It emphasizes empirical Bayes methods to moderate dispersion estimates across genes, enhancing statistical power. edgeR is flexible for various experimental designs and is known for its speed and efficiency, particularly for large datasets.

- **limma**: Originally developed for microarray data, limma (linear models for microarray analysis) uses linear modeling and empirical Bayes methods to analyze log-transformed expression data. For RNA-seq, it employs the voom transformation to adapt count data for linear modeling, making it suitable for both microarray and RNA-seq. limma excels in handling complex experimental designs and is computationally efficient.

### Key Differences

| **Aspect**              | **DESeq2**                                                                 | **edgeR**                                                                 | **limma**                                                                 |
|-------------------------|---------------------------------------------------------------------------|---------------------------------------------------------------------------|---------------------------------------------------------------------------|
| **Primary Data Type**   | RNA-seq count data (negative binomial model)                              | RNA-seq count data (negative binomial model)                              | Microarray (log-transformed) or RNA-seq (via voom transformation)          |
| **Statistical Model**   | Negative binomial generalized linear model                                | Negative binomial generalized linear model                                | Linear model with empirical Bayes moderation (voom for RNA-seq)           |
| **Normalization**       | Median of ratios (geometric mean-based)                                  | TMM (trimmed mean of M-values) or other methods                          | Quantile normalization (microarray) or voom (RNA-seq)                     |
| **Dispersion Estimation**| Shrinkage of gene-wise dispersions toward a fitted trend                  | Empirical Bayes shrinkage of dispersions                                  | Empirical Bayes moderation of variance (via voom weights for RNA-seq)     |
| **Shrinkage Approach**  | Shrinks both dispersions and log-fold changes for stable estimates        | Shrinks dispersions but not log-fold changes                              | Shrinks variance estimates (not directly log-fold changes)                |
| **Performance**         | Robust for small sample sizes; slower for large datasets                  | Fast and efficient, especially for large datasets                        | Very fast, especially for large datasets; less optimal for small samples   |
| **Use Case**            | RNA-seq, small sample sizes, complex designs                             | RNA-seq, large datasets, flexible designs                                | Microarray or RNA-seq, complex designs, large sample sizes                |
| **Transformation**      | No transformation; directly models counts                                | No transformation; directly models counts                                | Log-transformation (voom for RNA-seq to estimate precision weights)        |
| **Input and Outputs**   | **Input**: Raw count data (integer counts from RNA-seq) <br> **Output**: Log2 fold changes, p-values, adjusted p-values (FDR) | **Input**: Raw count data (integer counts from RNA-seq) <br> **Output**: Log2 fold changes, p-values, adjusted p-values (FDR) | **Input**: Log-transformed data (microarray) or raw counts transformed via voom (RNA-seq) <br> **Output**: Log2 fold changes, p-values, adjusted p-values (FDR) |
| **Flexibility**         | Handles complex designs; less flexible for non-count data                 | Highly flexible for count-based data and designs                         | Most flexible for complex designs across microarray and RNA-seq           |

### Summary
- **DESeq2** is ideal for RNA-seq data with small sample sizes, offering robust shrinkage for dispersion and fold-change estimates, making it reliable for low-count genes. It uses a negative binomial model and median-of-ratios normalization.
- **edgeR** is also tailored for RNA-seq, with fast performance and empirical Bayes dispersion shrinkage, making it suitable for large datasets and flexible designs. It uses TMM normalization and is less aggressive in fold-change shrinkage.
- **limma** is versatile for both microarray and RNA-seq (via voom), excelling in complex experimental designs and large datasets. It uses linear models with empirical Bayes variance moderation, requiring log-transformation of data.

In practice, the choice depends on the data type (RNA-seq vs. microarray), sample size, and experimental complexity. DESeq2 and edgeR are preferred for RNA-seq with count data, while limma is more versatile for both data types, especially with large samples or complex designs. All three produce comparable results in many cases, but their performance can vary based on dataset characteristics.

## Bulk RNA-seq

- Cheaper
- Simpler
- Statistically stronger with replicates

Suitable for:
✔️ Homogeneous samples (like cell lines)
✔️ High-throughput designs with many conditions
✔️ Studies where replication is key (e.g., drug treatments, time-course)
✔️ Situations where per-cell resolution won’t change your biological conclusion

## Single-Cell RNA-seq
Use scRNA-seq if your question depends on:

- Detecting rare populations
- Disentangling heterogeneous tissues
- Discovering cell-type-specific signals

In these cases, resolution matters—and scRNA-seq earns its price tag.

But know this: you’re trading off simplicity, QC, and replicability.


## Reference

- [Introduction to bulk RNA-seq: From reads to count matrix](https://hbctraining.github.io/Intro-to-bulk-RNAseq/schedule/links-to-lessons.html)
