<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Guorui Zhong</title>
<link>https://guoruizhong.github.io/atom.html</link>
<atom:link href="https://guoruizhong.github.io/atom.xml" rel="self" type="application/rss+xml"/>
<description>Guorui Zhong is an assistant professor at Georgia State University, researching international NGOs and teaching data science &amp; economics.</description>
<generator>quarto-1.2.269</generator>
<lastBuildDate>Thu, 01 Sep 2022 16:00:00 GMT</lastBuildDate>
<item>
  <title>Add experimental conditions to multi-well plates</title>
  <dc:creator>Guorui Zhong</dc:creator>
  <link>https://guoruizhong.github.io/blog/2022/09/02/index.html</link>
  <description><![CDATA[ <div class="cell">
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://docs.ropensci.org/plater/">plater</a></span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;"># check_plater_format("data/palter.csv", sep = ",")</span></span>
<span><span class="va" style="color: #111111;">Treatment</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://docs.ropensci.org/plater/reference/read_plates.html">read_plates</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"plater1.csv"</span>,</span>
<span>    plate_names <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"ZG22006"</span>,</span>
<span>    well_ids_column <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Well.ID"</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">Treatment</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 3
   Plate   Well.ID Treatment
   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;    
 1 ZG22006 C03     DMSO     
 2 ZG22006 C04     Eto_1    
 3 ZG22006 C05     Eto_10   
 4 ZG22006 C06     Eto_100  
 5 ZG22006 D03     DMSO     
 6 ZG22006 D04     Eto_1    
 7 ZG22006 D05     Eto_10   
 8 ZG22006 D06     Eto_100  
 9 ZG22006 E03     DMSO     
10 ZG22006 E04     Eto_1    
11 ZG22006 E05     Eto_10   
12 ZG22006 E06     Eto_100  
13 ZG22006 F03     DMSO     
14 ZG22006 F04     Eto_1    
15 ZG22006 F05     Eto_10   
16 ZG22006 F06     Eto_100  </code></pre>
</div>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">Group</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://docs.ropensci.org/plater/reference/read_plates.html">read_plates</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"plater2.csv"</span>,</span>
<span>    plate_names <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"ZG22006"</span>,</span>
<span>    well_ids_column <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Well.ID"</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">Group</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 32 × 4
   Plate   Well.ID Treatment Group  
   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;  
 1 ZG22006 C03     DMSO      WT     
 2 ZG22006 C04     Eto_1     WT     
 3 ZG22006 C05     Eto_10    WT     
 4 ZG22006 C06     Eto_100   WT     
 5 ZG22006 C07     DMSO      Variant
 6 ZG22006 C08     Eto_1     Variant
 7 ZG22006 C09     Eto_10    Variant
 8 ZG22006 C10     Eto_100   Variant
 9 ZG22006 D03     DMSO      WT     
10 ZG22006 D04     Eto_1     WT     
# … with 22 more rows</code></pre>
</div>
</div>
<section id="reference" class="level2"><h2 class="anchored" data-anchor-id="reference">Reference</h2>
<hr>
<ol type="1">
<li><a href="https://ropensci.org/blog/2017/02/06/plater-blog-post">From a million nested ifelses to the plater package</a></li>
<li><a href="https://cran.r-project.org/web/packages/plater/vignettes/plater-basics.html">Getting started with plater</a></li>
</ol>


</section> ]]></description>
  <category>plater</category>
  <category>R</category>
  <guid>https://guoruizhong.github.io/blog/2022/09/02/index.html</guid>
  <pubDate>Thu, 01 Sep 2022 16:00:00 GMT</pubDate>
  <media:content url="https://guoruizhong.github.io/blog/2022/09/02/f1.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>View data from 96/384 multi-well plates</title>
  <dc:creator>Guorui Zhong</dc:creator>
  <link>https://guoruizhong.github.io/blog/2022/08/01/index.html</link>
  <description><![CDATA[ <div class="cell">
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;"># library(plater)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://github.com/swarchal/platetools">platetools</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://sjmgarnier.github.io/viridis/">viridis</a></span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">numbers</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">:</span><span class="fl" style="color: #AD0000;">96</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/platetools/man/num_to_well.html">num_to_well</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">numbers</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "A01" "A02" "A03" "A04" "A05" "A06" "A07" "A08" "A09" "A10" "A11" "A12"
[13] "B01" "B02" "B03" "B04" "B05" "B06" "B07" "B08" "B09" "B10" "B11" "B12"
[25] "C01" "C02" "C03" "C04" "C05" "C06" "C07" "C08" "C09" "C10" "C11" "C12"
[37] "D01" "D02" "D03" "D04" "D05" "D06" "D07" "D08" "D09" "D10" "D11" "D12"
[49] "E01" "E02" "E03" "E04" "E05" "E06" "E07" "E08" "E09" "E10" "E11" "E12"
[61] "F01" "F02" "F03" "F04" "F05" "F06" "F07" "F08" "F09" "F10" "F11" "F12"
[73] "G01" "G02" "G03" "G04" "G05" "G06" "G07" "G08" "G09" "G10" "G11" "G12"
[85] "H01" "H02" "H03" "H04" "H05" "H06" "H07" "H08" "H09" "H10" "H11" "H12"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">numbers</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fl" style="color: #AD0000;">320</span><span class="op" style="color: #5E5E5E;">:</span><span class="fl" style="color: #AD0000;">384</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/platetools/man/num_to_well.html">num_to_well</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">numbers</span>, plate <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">384</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "N08" "N09" "N10" "N11" "N12" "N13" "N14" "N15" "N16" "N17" "N18" "N19"
[13] "N20" "N21" "N22" "N23" "N24" "O01" "O02" "O03" "O04" "O05" "O06" "O07"
[25] "O08" "O09" "O10" "O11" "O12" "O13" "O14" "O15" "O16" "O17" "O18" "O19"
[37] "O20" "O21" "O22" "O23" "O24" "P01" "P02" "P03" "P04" "P05" "P06" "P07"
[49] "P08" "P09" "P10" "P11" "P12" "P13" "P14" "P15" "P16" "P17" "P18" "P19"
[61] "P20" "P21" "P22" "P23" "P24"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;"># example dataframe</span></span>
<span><span class="va" style="color: #111111;">df</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op" style="color: #5E5E5E;">(</span>vals <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">384</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>                 well <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/platetools/man/num_to_well.html">num_to_well</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">:</span><span class="fl" style="color: #AD0000;">384</span>, plate <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">384</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/platetools/man/raw_map.html">raw_map</a></span><span class="op" style="color: #5E5E5E;">(</span>data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">df</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">vals</span>,</span>
<span>        well <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">df</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">well</span>,</span>
<span>        plate <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">384</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"Example 384-well plate"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_dark</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html">scale_fill_viridis</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://guoruizhong.github.io/blog/2022/08/01/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">df01</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op" style="color: #5E5E5E;">(</span>well <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/platetools/man/num_to_well.html">num_to_well</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">:</span><span class="fl" style="color: #AD0000;">96</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>  vals <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">96</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>  plate <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;">df02</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op" style="color: #5E5E5E;">(</span>well <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/platetools/man/num_to_well.html">num_to_well</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">:</span><span class="fl" style="color: #AD0000;">96</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>  vals <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">96</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>  plate <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;">df</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">df01</span>, <span class="va" style="color: #111111;">df02</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/platetools/man/raw_grid.html">raw_grid</a></span><span class="op" style="color: #5E5E5E;">(</span>data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">df</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">vals</span>,</span>
<span>    well <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">df</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">well</span>,</span>
<span>    plate_id <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">df</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">plate</span>,</span>
<span>    plate <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">96</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://guoruizhong.github.io/blog/2022/08/01/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="reference" class="level2"><h2 class="anchored" data-anchor-id="reference">Reference</h2>
<ol type="1">
<li>https://gist.github.com/Swarchal/b938933ae9ded94b3c14d6485b27cf69</li>
<li>https://rpubs.com/Swarchal/phenoScreen</li>
<li>https://ropensci.org/blog/2017/02/06/plater-blog-post/</li>
<li>https://cran.r-project.org/web/packages/plater/vignettes/plater-basics.html</li>
</ol>


</section> ]]></description>
  <category>platetools</category>
  <category>R</category>
  <guid>https://guoruizhong.github.io/blog/2022/08/01/index.html</guid>
  <pubDate>Sun, 31 Jul 2022 16:00:00 GMT</pubDate>
  <media:content url="https://guoruizhong.github.io/blog/2022/08/01/platetools.png" medium="image" type="image/png" height="103" width="144"/>
</item>
<item>
  <title>Volano plot with ggvolcano</title>
  <dc:creator>Guorui Zhong</dc:creator>
  <link>https://guoruizhong.github.io/blog/2022/07/01/index.html</link>
  <description><![CDATA[ <section id="ggvolcano" class="level2"><h2 class="anchored" data-anchor-id="ggvolcano">ggvolcano</h2>
<div class="cell">
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">ggVolcano</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">deg_data</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;">view</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">deg_data</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">data</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/ggVolcano/man/add_regulate.html">add_regulate</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">deg_data</span>,</span>
<span>  log2FC_name <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"log2FoldChange"</span>,</span>
<span>  fdr_name <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"padj"</span>, log2FC <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span>, fdr <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0.05</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span> <span class="co" style="color: #5E5E5E;"># add column</span></span>
<span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/ggVolcano/man/ggvolcano.html">ggvolcano</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">data</span>,</span>
<span>  x <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"log2FoldChange"</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"padj"</span>,</span>
<span>  label <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"row"</span>, label_number <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">10</span>, output <span class="op" style="color: #5E5E5E;">=</span> <span class="cn" style="color: #8f5902;">FALSE</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://guoruizhong.github.io/blog/2022/07/01/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;"># Change the fill and color manually:</span></span>
<span><span class="va" style="color: #111111;">p1</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/ggVolcano/man/ggvolcano.html">ggvolcano</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">data</span>,</span>
<span>  x <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"log2FoldChange"</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"padj"</span>,</span>
<span>  fills <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"#e94234"</span>, <span class="st" style="color: #20794D;">"#b4b4d8"</span>, <span class="st" style="color: #20794D;">"#269846"</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>  colors <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"#e94234"</span>, <span class="st" style="color: #20794D;">"#b4b4d8"</span>, <span class="st" style="color: #20794D;">"#269846"</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>  label <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"row"</span>, label_number <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">10</span>, output <span class="op" style="color: #5E5E5E;">=</span> <span class="cn" style="color: #8f5902;">FALSE</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;">p2</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/ggVolcano/man/ggvolcano.html">ggvolcano</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">data</span>,</span>
<span>  x <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"log2FoldChange"</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"padj"</span>,</span>
<span>  label <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"row"</span>, label_number <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">10</span>, output <span class="op" style="color: #5E5E5E;">=</span> <span class="cn" style="color: #8f5902;">FALSE</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;">ggsci</span><span class="fu" style="color: #4758AB;">::</span><span class="fu" style="color: #4758AB;"><a href="https://nanx.me/ggsci/reference/scale_aaas.html">scale_color_aaas</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;">ggsci</span><span class="fu" style="color: #4758AB;">::</span><span class="fu" style="color: #4758AB;"><a href="https://nanx.me/ggsci/reference/scale_aaas.html">scale_fill_aaas</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Scale for colour is already present.
Adding another scale for colour, which will replace the existing scale.
Scale for fill is already present.
Adding another scale for fill, which will replace the existing scale.</code></pre>
</div>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;">#&gt; Scale for 'colour' is already present. Adding another scale for 'colour', which</span></span>
<span><span class="co" style="color: #5E5E5E;">#&gt; will replace the existing scale.</span></span>
<span><span class="co" style="color: #5E5E5E;">#&gt; Scale for 'fill' is already present. Adding another scale for 'fill', which</span></span>
<span><span class="co" style="color: #5E5E5E;">#&gt; will replace the existing scale.</span></span>
<span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">p1</span> <span class="op" style="color: #5E5E5E;">|</span> <span class="va" style="color: #111111;">p2</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://guoruizhong.github.io/blog/2022/07/01/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="gradual_volcano" class="level2"><h2 class="anchored" data-anchor-id="gradual_volcano">gradual_volcano</h2>
<div class="cell">
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;"># plot</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/ggVolcano/man/gradual_volcano.html">gradual_volcano</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">deg_data</span>,</span>
<span>  x <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"log2FoldChange"</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"padj"</span>,</span>
<span>  label <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"row"</span>, label_number <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">10</span>, output <span class="op" style="color: #5E5E5E;">=</span> <span class="cn" style="color: #8f5902;">FALSE</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://guoruizhong.github.io/blog/2022/07/01/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">RColorBrewer</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;"># Change the fill and color manually:</span></span>
<span><span class="va" style="color: #111111;">p1</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/ggVolcano/man/gradual_volcano.html">gradual_volcano</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">data</span>,</span>
<span>  x <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"log2FoldChange"</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"padj"</span>,</span>
<span>  fills <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">5</span>, <span class="st" style="color: #20794D;">"RdYlBu"</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>  colors <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">8</span>, <span class="st" style="color: #20794D;">"RdYlBu"</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>  label <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"row"</span>, label_number <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">10</span>, output <span class="op" style="color: #5E5E5E;">=</span> <span class="cn" style="color: #8f5902;">FALSE</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;">p2</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/ggVolcano/man/gradual_volcano.html">gradual_volcano</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">data</span>,</span>
<span>  x <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"log2FoldChange"</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"padj"</span>,</span>
<span>  label <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"row"</span>, label_number <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">10</span>, output <span class="op" style="color: #5E5E5E;">=</span> <span class="cn" style="color: #8f5902;">FALSE</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;">ggsci</span><span class="fu" style="color: #4758AB;">::</span><span class="fu" style="color: #4758AB;"><a href="https://nanx.me/ggsci/reference/scale_gsea.html">scale_color_gsea</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;">ggsci</span><span class="fu" style="color: #4758AB;">::</span><span class="fu" style="color: #4758AB;"><a href="https://nanx.me/ggsci/reference/scale_gsea.html">scale_fill_gsea</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Scale for colour is already present.
Adding another scale for colour, which will replace the existing scale.
Scale for fill is already present.
Adding another scale for fill, which will replace the existing scale.</code></pre>
</div>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;">#&gt; Scale for 'colour' is already present. Adding another scale for 'colour', which</span></span>
<span><span class="co" style="color: #5E5E5E;">#&gt; will replace the existing scale.</span></span>
<span><span class="co" style="color: #5E5E5E;">#&gt; Scale for 'fill' is already present. Adding another scale for 'fill', which</span></span>
<span><span class="co" style="color: #5E5E5E;">#&gt; will replace the existing scale.</span></span>
<span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">p1</span> <span class="op" style="color: #5E5E5E;">|</span> <span class="va" style="color: #111111;">p2</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://guoruizhong.github.io/blog/2022/07/01/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="term_volcano-for-go-pathway" class="level2"><h2 class="anchored" data-anchor-id="term_volcano-for-go-pathway">term_volcano for go pathway</h2>
<div class="cell">
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"term_data"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;"># plot</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/ggVolcano/man/term_volcano.html">term_volcano</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">deg_data</span>, <span class="va" style="color: #111111;">term_data</span>,</span>
<span>  x <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"log2FoldChange"</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"padj"</span>,</span>
<span>  label <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"row"</span>, label_number <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">10</span>, output <span class="op" style="color: #5E5E5E;">=</span> <span class="cn" style="color: #8f5902;">FALSE</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://guoruizhong.github.io/blog/2022/07/01/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">RColorBrewer</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="co" style="color: #5E5E5E;"># Change the fill and color manually:</span></span>
<span><span class="va" style="color: #111111;">deg_point_fill</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">5</span>, <span class="st" style="color: #20794D;">"RdYlBu"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">deg_point_fill</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">term_data</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">term</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/ggVolcano/man/term_volcano.html">term_volcano</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">data</span>, <span class="va" style="color: #111111;">term_data</span>,</span>
<span>  x <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"log2FoldChange"</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"padj"</span>,</span>
<span>  normal_point_color <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"#75aadb"</span>,</span>
<span>  deg_point_fill <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">deg_point_fill</span>,</span>
<span>  deg_point_color <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"grey"</span>,</span>
<span>  legend_background_fill <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"#deeffc"</span>,</span>
<span>  label <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"row"</span>, label_number <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">10</span>, output <span class="op" style="color: #5E5E5E;">=</span> <span class="cn" style="color: #8f5902;">FALSE</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://guoruizhong.github.io/blog/2022/07/01/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Ref: 1. https://github.com/BioSenior/ggGantt</p>


</section> ]]></description>
  <category>ggvolcano</category>
  <category>R</category>
  <guid>https://guoruizhong.github.io/blog/2022/07/01/index.html</guid>
  <pubDate>Thu, 30 Jun 2022 16:00:00 GMT</pubDate>
  <media:content url="https://guoruizhong.github.io/blog/2022/07/01/ggvolcano.png" medium="image" type="image/png" height="103" width="144"/>
</item>
<item>
  <title>Visualizing clusters with heatmaps</title>
  <dc:creator>Guorui Zhong</dc:creator>
  <link>https://guoruizhong.github.io/blog/2022/06/01/index.html</link>
  <description><![CDATA[ <section id="heatmap-packages" class="level2"><h2 class="anchored" data-anchor-id="heatmap-packages">Heatmap packages</h2>
<div class="cell">
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">pheatmap</span><span class="op" style="color: #5E5E5E;">)</span> <span class="co" style="color: #5E5E5E;">## for heatmap generation</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op" style="color: #5E5E5E;">)</span> <span class="co" style="color: #5E5E5E;">## for data wrangling</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://github.com/GuangchuangYu/ggplotify">ggplotify</a></span><span class="op" style="color: #5E5E5E;">)</span> <span class="co" style="color: #5E5E5E;">## to convert pheatmap to ggplot2</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://talgalili.github.io/heatmaply/">heatmaply</a></span><span class="op" style="color: #5E5E5E;">)</span> <span class="co" style="color: #5E5E5E;">## for constructing interactive heatmap</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://github.com/jokergoo/ComplexHeatmap">ComplexHeatmap</a></span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</div>
</section><section id="prepare-data" class="level2"><h2 class="anchored" data-anchor-id="prepare-data">Prepare data</h2>
<div class="cell">
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">test</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">200</span><span class="op" style="color: #5E5E5E;">)</span>, <span class="fl" style="color: #AD0000;">20</span>, <span class="fl" style="color: #AD0000;">10</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">test</span><span class="op" style="color: #5E5E5E;">[</span><span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">:</span><span class="fl" style="color: #AD0000;">10</span>, <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1</span>, <span class="fl" style="color: #AD0000;">10</span>, <span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">]</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="va" style="color: #111111;">test</span><span class="op" style="color: #5E5E5E;">[</span><span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">:</span><span class="fl" style="color: #AD0000;">10</span>, <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1</span>, <span class="fl" style="color: #AD0000;">10</span>, <span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">]</span> <span class="op" style="color: #5E5E5E;">+</span> <span class="fl" style="color: #AD0000;">3</span></span>
<span><span class="va" style="color: #111111;">test</span><span class="op" style="color: #5E5E5E;">[</span><span class="fl" style="color: #AD0000;">11</span><span class="op" style="color: #5E5E5E;">:</span><span class="fl" style="color: #AD0000;">20</span>, <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">2</span>, <span class="fl" style="color: #AD0000;">10</span>, <span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">]</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="va" style="color: #111111;">test</span><span class="op" style="color: #5E5E5E;">[</span><span class="fl" style="color: #AD0000;">11</span><span class="op" style="color: #5E5E5E;">:</span><span class="fl" style="color: #AD0000;">20</span>, <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">2</span>, <span class="fl" style="color: #AD0000;">10</span>, <span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">]</span> <span class="op" style="color: #5E5E5E;">+</span> <span class="fl" style="color: #AD0000;">2</span></span>
<span><span class="va" style="color: #111111;">test</span><span class="op" style="color: #5E5E5E;">[</span><span class="fl" style="color: #AD0000;">15</span><span class="op" style="color: #5E5E5E;">:</span><span class="fl" style="color: #AD0000;">20</span>, <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">2</span>, <span class="fl" style="color: #AD0000;">10</span>, <span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">]</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="va" style="color: #111111;">test</span><span class="op" style="color: #5E5E5E;">[</span><span class="fl" style="color: #AD0000;">15</span><span class="op" style="color: #5E5E5E;">:</span><span class="fl" style="color: #AD0000;">20</span>, <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">2</span>, <span class="fl" style="color: #AD0000;">10</span>, <span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">]</span> <span class="op" style="color: #5E5E5E;">+</span> <span class="fl" style="color: #AD0000;">4</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">test</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"Test"</span>, <span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">:</span><span class="fl" style="color: #AD0000;">10</span>, sep <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">""</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">test</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"Gene"</span>, <span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">:</span><span class="fl" style="color: #AD0000;">20</span>, sep <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">""</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">test</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Test1       Test2      Test3       Test4      Test5      Test6
Gene1   1.6101920 -0.36083185  2.9419856 -0.77843617  3.3601305  1.7155838
Gene2   1.7888341  0.25399548  3.2275570 -0.63279331  3.4230905  0.8322741
Gene3   3.7140276  1.38742541  2.2297897 -0.66596674  1.9400389  0.1852566
Gene4   2.3404101 -0.12534671  3.1307937 -0.27051326  3.9165792 -2.1516039
Gene5   2.4154800  1.38997339  4.6213946 -1.91931446  1.6072542  2.0194700
Gene6   4.3764934  0.01495267  1.8540463  0.41587290  3.3043292 -0.3496422
Gene7   2.5729961  0.20959449  3.3112268  1.07589995  2.7270495 -0.2211672
Gene8   2.7977074  1.13004408  1.8496947 -1.18815717  2.2768207 -0.9870381
Gene9   2.4753143  0.27392906  4.0437985  0.73601929  2.3160668  0.6751547
Gene10  3.7928631  0.08072923  2.5143368 -0.00498094  4.1076280 -0.2518542
Gene11 -0.3560912  2.86555081  1.1274958  2.04703001 -2.5874892  0.5933322
Gene12  0.7778166  1.42211819 -0.2889914  1.96542341 -0.3108358  1.4200012
Gene13  0.2092981  2.73473109 -0.1913925  1.02241547 -3.1603589  1.9805313
Gene14  0.9624349  2.80749442 -2.2040140  2.45535874  1.0724724  3.3352803
Gene15 -0.2520438  6.59794338  0.9711581  5.40530706  1.1725079  6.2781478
Gene16  0.9569997  5.09113523 -0.6873934  5.32550787  0.7611673  7.8612532
Gene17 -2.3975850  6.60513341 -1.1037555  5.51212146  0.5570226  4.0428877
Gene18 -0.8237663  5.05654057  0.5333799  5.50484026 -0.3289425  5.0955091
Gene19  0.7315109  6.95773144 -1.1014985  6.39877479 -0.5359625  5.1377011
Gene20 -1.2835494  6.87021888 -0.8186217  5.67954226  0.3043498  5.6519702
            Test7      Test8       Test9     Test10
Gene1   3.6704358  0.7810713  2.59710019 -0.6639444
Gene2   2.2397840  0.8708925  3.64860275  0.7879721
Gene3   2.9355681  0.2587471  4.54197547  2.3937978
Gene4   1.2268859 -1.2187872  5.52687323  0.7331436
Gene5   3.9929190 -1.1033196  3.50401556  0.5616194
Gene6   3.1583987 -0.1998753  3.79265956 -1.4549084
Gene7   5.2525945  1.2405634  2.92927386 -0.1387731
Gene8   2.6089302 -1.2309571  4.01341245  1.0699240
Gene9   3.1017760 -0.4964436  3.08748087 -0.3586242
Gene10  3.3141882  1.3754729  4.48935332  0.2807511
Gene11 -1.3112621  3.0238229  0.64526084  3.9392547
Gene12  0.2515411  2.2402767  1.73604467  3.0443134
Gene13  0.6167012  2.2541606  0.20913017  0.3711738
Gene14  1.9832614 -0.2122922 -0.12479896  1.2863279
Gene15 -1.5473633  7.4548500 -0.39711393  5.5722074
Gene16  1.0397222  6.2104608  1.03863251  6.2886689
Gene17 -0.4315814  6.4424516  0.05465291  6.3328976
Gene18  0.8932720  5.0177915  0.59899716  5.1968273
Gene19  0.5575794  7.0525224  0.22005584  6.4387061
Gene20  1.8908738  5.4879034  0.69349838  6.4402674</code></pre>
</div>
</div>
</section><section id="pheatmap" class="level2"><h2 class="anchored" data-anchor-id="pheatmap">pheatmap</h2>
<div class="cell">
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;">### Add anotation col</span></span>
<span><span class="va" style="color: #111111;">annotation_col</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>  CellType <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"CT1"</span>, <span class="st" style="color: #20794D;">"CT2"</span><span class="op" style="color: #5E5E5E;">)</span>, <span class="fl" style="color: #AD0000;">5</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>  Time <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">:</span><span class="fl" style="color: #AD0000;">5</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">annotation_col</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"Test"</span>, <span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">:</span><span class="fl" style="color: #AD0000;">10</span>, sep <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">""</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;">annotation_row</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>  GeneClass <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"Path1"</span>, <span class="st" style="color: #20794D;">"Path2"</span>, <span class="st" style="color: #20794D;">"Path3"</span><span class="op" style="color: #5E5E5E;">)</span>, <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">10</span>, <span class="fl" style="color: #AD0000;">4</span>, <span class="fl" style="color: #AD0000;">6</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">annotation_row</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"Gene"</span>, <span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">:</span><span class="fl" style="color: #AD0000;">20</span>, sep <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">""</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;">ann_colors</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>  Time <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"white"</span>, <span class="st" style="color: #20794D;">"firebrick"</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>  CellType <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span>CT1 <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"#1B9E77"</span>, CT2 <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"#D95F02"</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>  GeneClass <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span>Path1 <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"#7570B3"</span>, Path2 <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"#E7298A"</span>, Path3 <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"#66A61E"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html">pheatmap</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">test</span>,</span>
<span>  annotation_col <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">annotation_col</span>,</span>
<span>  annotation_row <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">annotation_row</span>,</span>
<span>  annotation_colors <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">ann_colors</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://guoruizhong.github.io/blog/2022/06/01/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;">### split column and row</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html">pheatmap</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">test</span>,</span>
<span>  annotation_col <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">annotation_col</span>,</span>
<span>  annotation_row <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">annotation_row</span>,</span>
<span>  annotation_colors <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">ann_colors</span>,</span>
<span>  row_split <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">annotation_row</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">GeneClass</span>,</span>
<span>  column_split <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">annotation_col</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">CellType</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://guoruizhong.github.io/blog/2022/06/01/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;">## Combine multiple heatmap</span></span>
<span><span class="va" style="color: #111111;">p1</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html">pheatmap</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">test</span>, name <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"mat1"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">p2</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/rowAnnotation.html">rowAnnotation</a></span><span class="op" style="color: #5E5E5E;">(</span>foo <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_barplot.html">anno_barplot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">:</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">test</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">p3</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html">pheatmap</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">test</span>,</span>
<span>  name <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"mat2"</span>,</span>
<span>  col <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"navy"</span>, <span class="st" style="color: #20794D;">"white"</span>, <span class="st" style="color: #20794D;">"firebrick3"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">p1</span> <span class="op" style="color: #5E5E5E;">+</span> <span class="va" style="color: #111111;">p2</span> <span class="op" style="color: #5E5E5E;">+</span> <span class="va" style="color: #111111;">p3</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://guoruizhong.github.io/blog/2022/06/01/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;">## Don't cluster</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html">pheatmap</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">test</span>,</span>
<span>  annotation_col <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">annotation_col</span>,</span>
<span>  annotation_row <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">annotation_row</span>,</span>
<span>  annotation_colors <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">ann_colors</span>,</span>
<span>  row_split <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">annotation_row</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">GeneClass</span>,</span>
<span>  column_split <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">annotation_col</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">CellType</span>,</span>
<span>  cluster_rows <span class="op" style="color: #5E5E5E;">=</span> <span class="cn" style="color: #8f5902;">FALSE</span>,</span>
<span>  cluster_cols <span class="op" style="color: #5E5E5E;">=</span> <span class="cn" style="color: #8f5902;">FALSE</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://guoruizhong.github.io/blog/2022/06/01/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Reference:</p>
<ol type="1">
<li>https://jokergoo.github.io/ComplexHeatmap-reference/book/index.html</li>
<li>https://jcoliver.github.io/learn-r/006-heatmaps.html</li>
<li>https://statisticsglobe.com/draw-heatmap-like-plot-categorical-variables-r</li>
<li>https://btep.ccr.cancer.gov/docs/data-visualization-with-r/Lesson5_intro_to_ggplot/</li>
</ol>


</section> ]]></description>
  <category>pheatmap</category>
  <category>R</category>
  <guid>https://guoruizhong.github.io/blog/2022/06/01/index.html</guid>
  <pubDate>Tue, 31 May 2022 16:00:00 GMT</pubDate>
  <media:content url="https://guoruizhong.github.io/blog/2022/06/01/pheatmap.png" medium="image" type="image/png" height="103" width="144"/>
</item>
<item>
  <title>How to plot scatter plot with truncated axis</title>
  <dc:creator>Guorui Zhong</dc:creator>
  <link>https://guoruizhong.github.io/blog/2022/05/02/index.html</link>
  <description><![CDATA[ <section id="load-data" class="level1"><h1>Load data</h1>
<div class="cell">
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://github.com/teunbrand/ggh4x">ggh4x</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://www.stefanom.io/latex2exp/">latex2exp</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="va" style="color: #111111;">fig1a</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"data.xlsx"</span>, sheet <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Figure_1A"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">fig1a</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  animal.number genotype Fat.mass Lean.Mass sex  
          &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;
1           109 WT           3.87      31.4 Male 
2           140 WT           6.98      28.0 Male 
3           141 WT           5.66      29.6 Male 
4           144 WT           4.37      30.8 Male 
5           145 WT           4.32      29.1 Male 
6           199 WT           1.62      27.7 Male </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">p1</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="va" style="color: #111111;">fig1a</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">genotype</span> <span class="op" style="color: #5E5E5E;">==</span> <span class="st" style="color: #20794D;">"WT"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">Lean.Mass</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">Fat.mass</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op" style="color: #5E5E5E;">(</span>shape <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">21</span>, size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">5</span>, fill <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"#929292"</span>, color <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"black"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>    limits <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">20</span>, <span class="fl" style="color: #AD0000;">40</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>    breaks <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">20</span>, <span class="fl" style="color: #AD0000;">40</span>, <span class="fl" style="color: #AD0000;">5</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>    guide <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"axis_minor"</span>,</span>
<span>    minor_breaks <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">22.5</span>, <span class="fl" style="color: #AD0000;">37.5</span>, by <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">5</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span>  <span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>    limits <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">0</span>, <span class="fl" style="color: #AD0000;">25</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>    breaks <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">0</span>, <span class="fl" style="color: #AD0000;">25</span>, <span class="fl" style="color: #AD0000;">5</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>    guide <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"axis_minor"</span>,</span>
<span>    minor_breaks <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">8</span>, <span class="fl" style="color: #AD0000;">12</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span>  <span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>    ggh4x.axis.ticks.length.minor <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/element.html">rel</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">0.5</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>    axis.ticks.length.x <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">0.5</span>, <span class="st" style="color: #20794D;">"lines"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span>  <span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>    x <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://teunbrand.github.io/ggh4x/reference/guide_axis_minor.html">guide_axis_minor</a></span><span class="op" style="color: #5E5E5E;">(</span>trunc_lower <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">20</span>, trunc_upper <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">40</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>    y <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://teunbrand.github.io/ggh4x/reference/guide_axis_truncated.html">guide_axis_truncated</a></span><span class="op" style="color: #5E5E5E;">(</span>trunc_lower <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0</span>, trunc_upper <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">25</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span>  <span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op" style="color: #5E5E5E;">(</span>xintercept <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">32.5</span>, lty <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"dashed"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op" style="color: #5E5E5E;">(</span>yintercept <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">10</span>, lty <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"dashed"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>    x <span class="op" style="color: #5E5E5E;">=</span> <span class="cn" style="color: #8f5902;">NULL</span>,</span>
<span>    y <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Fat mass (g)"</span></span>
<span>  <span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op" style="color: #5E5E5E;">(</span>geom <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"point"</span>, x <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">20</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">23</span> <span class="op" style="color: #5E5E5E;">+</span> <span class="fl" style="color: #AD0000;">1</span>, shape <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">21</span>, size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">5</span>, fill <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"#929292"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op" style="color: #5E5E5E;">(</span>geom <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"text"</span>, x <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">20.5</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">23</span> <span class="op" style="color: #5E5E5E;">+</span> <span class="fl" style="color: #AD0000;">1</span>, label <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"WT"</span>, size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">5</span>, hjust <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op" style="color: #5E5E5E;">(</span>geom <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"point"</span>, x <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">20</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">22</span> <span class="op" style="color: #5E5E5E;">-</span> <span class="fl" style="color: #AD0000;">1</span>, shape <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">21</span>, size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">5</span>, fill <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"#0533ff"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op" style="color: #5E5E5E;">(</span>geom <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"text"</span>, x <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">20.5</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">22</span> <span class="op" style="color: #5E5E5E;">-</span> <span class="fl" style="color: #AD0000;">1</span>, label <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">r"(\textit{Nnat}${^+}{^/}{^-}{^p}$)"</span><span class="op" style="color: #5E5E5E;">)</span>, size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">5</span>, hjust <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span></span>
<span><span class="va" style="color: #111111;">p2</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="va" style="color: #111111;">fig1a</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">genotype</span> <span class="op" style="color: #5E5E5E;">==</span> <span class="st" style="color: #20794D;">"Nnat+/-p"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">Lean.Mass</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">Fat.mass</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op" style="color: #5E5E5E;">(</span>shape <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">21</span>, size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">5</span>, fill <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"#0533ff"</span>, color <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"black"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>    limits <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">20</span>, <span class="fl" style="color: #AD0000;">40</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>    breaks <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">20</span>, <span class="fl" style="color: #AD0000;">40</span>, <span class="fl" style="color: #AD0000;">5</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>    guide <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"axis_minor"</span>,</span>
<span>    minor_breaks <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">22.5</span>, <span class="fl" style="color: #AD0000;">37.5</span>, by <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">5</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span>  <span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>    limits <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">0</span>, <span class="fl" style="color: #AD0000;">25</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>    breaks <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">0</span>, <span class="fl" style="color: #AD0000;">25</span>, <span class="fl" style="color: #AD0000;">5</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>    guide <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"axis_minor"</span>,</span>
<span>    minor_breaks <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">8</span>, <span class="fl" style="color: #AD0000;">12</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span>  <span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>    ggh4x.axis.ticks.length.minor <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/element.html">rel</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">0.5</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>    axis.ticks.length.x <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">0.5</span>, <span class="st" style="color: #20794D;">"lines"</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>    axis.line.y <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>    axis.ticks.y <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>    axis.text.y <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span>  <span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>    x <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://teunbrand.github.io/ggh4x/reference/guide_axis_minor.html">guide_axis_minor</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>      trunc_lower <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">20</span>,</span>
<span>      trunc_upper <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">40</span></span>
<span>    <span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>    y <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://teunbrand.github.io/ggh4x/reference/guide_axis_truncated.html">guide_axis_truncated</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>      trunc_lower <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0</span>,</span>
<span>      trunc_upper <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">25</span></span>
<span>    <span class="op" style="color: #5E5E5E;">)</span></span>
<span>  <span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op" style="color: #5E5E5E;">(</span>xintercept <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">32.5</span>, lty <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"dashed"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op" style="color: #5E5E5E;">(</span>yintercept <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">10</span>, lty <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"dashed"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="cn" style="color: #8f5902;">NULL</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="cn" style="color: #8f5902;">NULL</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">p1</span> <span class="op" style="color: #5E5E5E;">+</span> <span class="va" style="color: #111111;">p2</span> <span class="op" style="color: #5E5E5E;">+</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Lean mass (g)"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op" style="color: #5E5E5E;">(</span>axis.title.x <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op" style="color: #5E5E5E;">(</span>hjust <span class="op" style="color: #5E5E5E;">=</span> <span class="op" style="color: #5E5E5E;">-</span><span class="fl" style="color: #AD0000;">0.12</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in is.na(x): is.na() applied to non-(list or vector) of type
'expression'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://guoruizhong.github.io/blog/2022/05/02/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section> ]]></description>
  <category>ggh4x</category>
  <category>ggplot2</category>
  <category>tidyverse</category>
  <category>R</category>
  <guid>https://guoruizhong.github.io/blog/2022/05/02/index.html</guid>
  <pubDate>Sun, 01 May 2022 16:00:00 GMT</pubDate>
  <media:content url="https://guoruizhong.github.io/blog/2022/05/02/truncated.png" medium="image" type="image/png" height="103" width="144"/>
</item>
<item>
  <title>Add errorbar and p-value on barplot with ggsignif</title>
  <dc:creator>Guorui Zhong</dc:creator>
  <link>https://guoruizhong.github.io/blog/2022/02/01/index.html</link>
  <description><![CDATA[ <section id="prepare-data" class="level2"><h2 class="anchored" data-anchor-id="prepare-data">Prepare data</h2>
<div class="cell">
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://const-ae.github.io/ggsignif/">ggsignif</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://github.com/teunbrand/ggh4x">ggh4x</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">dfb</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"221001_barplot.csv"</span>, header <span class="op" style="color: #5E5E5E;">=</span> <span class="cn" style="color: #8f5902;">FALSE</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">dfb</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   V1   V2   V3   V4   V5   V6   V7 V8
1             Control 0.06 0.00 0.39 0.22 0.22 0.36 NA
2                  F5 0.99 1.00 0.95 0.97 0.97   NA NA
3 pAtUbi3:CDS-Rps11-1 1.00 0.67 0.94 1.00 1.00   NA NA
4 pAtUbi3:CDS-Rps11-2 0.94 1.00 0.94 0.94 1.00 1.00  1</code></pre>
</div>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">dfb.1</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="va" style="color: #111111;">dfb</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">!</span><span class="va" style="color: #111111;">V1</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">V1</span>, <span class="va" style="color: #111111;">value</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">dfb.1</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 23 × 2
   V1      value
   &lt;chr&gt;   &lt;dbl&gt;
 1 Control  0.06
 2 Control  0   
 3 Control  0.39
 4 Control  0.22
 5 Control  0.22
 6 Control  0.36
 7 F5       0.99
 8 F5       1   
 9 F5       0.95
10 F5       0.97
# … with 13 more rows</code></pre>
</div>
</div>
</section><section id="define-errorbar-function" class="level2"><h2 class="anchored" data-anchor-id="define-errorbar-function">Define errorbar function</h2>
<div class="cell">
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">ebtop</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="kw" style="color: #003B4F;">function</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">x</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">{</span></span>
<span>    <span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">x</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">x</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">/</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">x</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="op" style="color: #5E5E5E;">}</span></span>
<span><span class="va" style="color: #111111;">ebbottom</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="kw" style="color: #003B4F;">function</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">x</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">{</span></span>
<span>    <span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">x</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">x</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">/</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">x</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="op" style="color: #5E5E5E;">}</span></span></code></pre></div>
</div>
</section><section id="add-errorbar-and-p-value" class="level2"><h2 class="anchored" data-anchor-id="add-errorbar-and-p-value">Add errorbar and p-value</h2>
<div class="cell">
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">p</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;">(</span>data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">dfb.1</span>, <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">V1</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">value</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>        geom <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"bar"</span>,</span>
<span>        fun <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">mean</span>,</span>
<span>        fill <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"#c6c3c3"</span></span>
<span>    <span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>        geom <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"errorbar"</span>,</span>
<span>        fun.min <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">ebbottom</span>,</span>
<span>        fun.max <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">ebtop</span>,</span>
<span>        width <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0.2</span></span>
<span>    <span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op" style="color: #5E5E5E;">(</span>width <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0.3</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://const-ae.github.io/ggsignif/reference/stat_signif.html">geom_signif</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>        comparisons <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>            <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"Control"</span>, <span class="st" style="color: #20794D;">"F5"</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>            <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"Control"</span>, <span class="st" style="color: #20794D;">"pAtUbi3:CDS-Rps11-1"</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>            <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"Control"</span>, <span class="st" style="color: #20794D;">"pAtUbi3:CDS-Rps11-2"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span>        <span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>        test <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">t.test</span>,</span>
<span>        test.args <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>            var.equal <span class="op" style="color: #5E5E5E;">=</span> <span class="cn" style="color: #8f5902;">T</span>,</span>
<span>            alternative <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"two.side"</span></span>
<span>        <span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>        y_position <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1.1</span>, <span class="fl" style="color: #AD0000;">1.3</span>, <span class="fl" style="color: #AD0000;">1.5</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>        annotations <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">""</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>        parse <span class="op" style="color: #5E5E5E;">=</span> <span class="cn" style="color: #8f5902;">T</span></span>
<span>    <span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>        geom <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"text"</span>,</span>
<span>        x <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1.5</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1.15</span>,</span>
<span>        label <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;">italic</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">P</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">~</span> <span class="st" style="color: #20794D;">"="</span> <span class="op" style="color: #5E5E5E;">~</span> <span class="fl" style="color: #AD0000;">1.83</span> <span class="op" style="color: #5E5E5E;"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fl" style="color: #AD0000;">10</span><span class="op" style="color: #5E5E5E;">^</span><span class="op" style="color: #5E5E5E;">-</span><span class="fl" style="color: #AD0000;">6</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span>    <span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>        geom <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"text"</span>,</span>
<span>        x <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">2</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1.35</span>,</span>
<span>        label <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;">italic</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">P</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">~</span> <span class="st" style="color: #20794D;">"="</span> <span class="op" style="color: #5E5E5E;">~</span> <span class="fl" style="color: #AD0000;">2.71</span> <span class="op" style="color: #5E5E5E;"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fl" style="color: #AD0000;">10</span><span class="op" style="color: #5E5E5E;">^</span><span class="op" style="color: #5E5E5E;">-</span><span class="fl" style="color: #AD0000;">5</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span>    <span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>        geom <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"text"</span>,</span>
<span>        x <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">2.5</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1.55</span>,</span>
<span>        label <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;">italic</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">P</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">~</span> <span class="st" style="color: #20794D;">"="</span> <span class="op" style="color: #5E5E5E;">~</span> <span class="fl" style="color: #AD0000;">5.75</span> <span class="op" style="color: #5E5E5E;"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fl" style="color: #AD0000;">10</span><span class="op" style="color: #5E5E5E;">^</span><span class="op" style="color: #5E5E5E;">-</span><span class="fl" style="color: #AD0000;">8</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span>    <span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>        expand <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">0</span>, <span class="fl" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>        limits <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">0</span>, <span class="fl" style="color: #AD0000;">1.6</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>        breaks <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">0</span>, <span class="fl" style="color: #AD0000;">1</span>, <span class="fl" style="color: #AD0000;">0.2</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span>    <span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>        panel.grid <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>        axis.line.y <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>        axis.ticks.y <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>        axis.title.y <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>            hjust <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0.25</span>,</span>
<span>            size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">15</span></span>
<span>        <span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>        axis.text.x <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>            angle <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">30</span>,</span>
<span>            hjust <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span>,</span>
<span>            size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">10</span></span>
<span>        <span class="op" style="color: #5E5E5E;">)</span></span>
<span>    <span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op" style="color: #5E5E5E;">(</span>y <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://teunbrand.github.io/ggh4x/reference/guide_axis_truncated.html">guide_axis_truncated</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>        trunc_lower <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">0</span>,</span>
<span>        trunc_upper <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span></span>
<span>    <span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op" style="color: #5E5E5E;">(</span>x <span class="op" style="color: #5E5E5E;">=</span> <span class="cn" style="color: #8f5902;">NULL</span>, y <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Survival Rate"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">p</span></span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://guoruizhong.github.io/blog/2022/02/01/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="reference" class="level2"><h2 class="anchored" data-anchor-id="reference">Reference</h2>
<ol type="1">
<li>https://www.nature.com/articles/s41467-021-26554-8#Sec23</li>
<li>https://statisticsglobe.com/ggsignif-package-r</li>
<li>https://mp.weixin.qq.com/s/JBxu9jeCduCy-UQ5MoHyKw</li>
</ol>


</section> ]]></description>
  <category>ggsignif</category>
  <category>ggh4x</category>
  <category>ggplot2</category>
  <category>tidyverse</category>
  <category>R</category>
  <guid>https://guoruizhong.github.io/blog/2022/02/01/index.html</guid>
  <pubDate>Mon, 31 Jan 2022 16:00:00 GMT</pubDate>
  <media:content url="https://guoruizhong.github.io/blog/2022/02/01/barplot.png" medium="image" type="image/png" height="103" width="144"/>
</item>
<item>
  <title>Use colorblind-friendly palette for visualization</title>
  <dc:creator>Guorui Zhong</dc:creator>
  <link>https://guoruizhong.github.io/blog/2022/01/22/index.html</link>
  <description><![CDATA[ <p><img src="https://guoruizhong.github.io/blog/2022/01/22/colorblind_palette.jpg" class="img-fluid"></p>
<section id="friendly-palette" class="level2"><h2 class="anchored" data-anchor-id="friendly-palette">Friendly palette</h2>
<div>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;">### friendly colors</span></span>
<span></span>
<span><span class="va" style="color: #111111;">cbPalette</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>    <span class="st" style="color: #20794D;">"#000000"</span>, <span class="st" style="color: #20794D;">"#999999"</span>, <span class="st" style="color: #20794D;">"#E69F00"</span>, <span class="st" style="color: #20794D;">"#56B4E9"</span>, </span>
<span>    <span class="st" style="color: #20794D;">"#009E73"</span>, <span class="st" style="color: #20794D;">"#F0E442"</span>, <span class="st" style="color: #20794D;">"#0072B2"</span>, <span class="st" style="color: #20794D;">"#D55E00"</span>, <span class="st" style="color: #20794D;">"#CC79A7"</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span></span>
<span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">:</span><span class="fl" style="color: #AD0000;">8</span>, col <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">cbPalette</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="co" style="color: #5E5E5E;">### gray colors</span></span>
<span><span class="va" style="color: #111111;">cb</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"gray"</span>, <span class="st" style="color: #20794D;">"lightgray"</span>, <span class="st" style="color: #20794D;">"darkgray"</span>, <span class="st" style="color: #20794D;">"black"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">:</span><span class="fl" style="color: #AD0000;">4</span>, col <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">cb</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://guoruizhong.github.io/blog/2022/01/22/index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://guoruizhong.github.io/blog/2022/01/22/index_files/figure-html/unnamed-chunk-1-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section><section id="use-colors-with-ggplot2" class="level2"><h2 class="anchored" data-anchor-id="use-colors-with-ggplot2">Use colors with ggplot2</h2>
<div>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="co" style="color: #5E5E5E;">### To use for fills, add scale_fill_manual(values=cbPalette)</span></span>
<span><span class="co" style="color: #5E5E5E;">### To use for line and point colors, add scale_colour_manual(values=cbPalette)</span></span>
<span><span class="co" style="color: #5E5E5E;">### Generate a basic `ggplot2`. Map the color argument to a factor or grouping variable:</span></span>
<span><span class="va" style="color: #111111;">p1</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">iris</span>, <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">Sepal.Length</span>, <span class="va" style="color: #111111;">Sepal.Width</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>color <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">Species</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">p1</span></span>
<span><span class="co" style="color: #5E5E5E;">## Set the color palette manually using a custom color scale:</span></span>
<span><span class="va" style="color: #111111;">p2</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="va" style="color: #111111;">p1</span> <span class="op" style="color: #5E5E5E;">+</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op" style="color: #5E5E5E;">(</span>values <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"#00AFBB"</span>, <span class="st" style="color: #20794D;">"#E7B800"</span>, <span class="st" style="color: #20794D;">"#FC4E07"</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">p2</span></span></code></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://guoruizhong.github.io/blog/2022/01/22/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://guoruizhong.github.io/blog/2022/01/22/index_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<div>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co" style="color: #5E5E5E;">## Use color blind-friendly palette:</span></span>
<span><span class="va" style="color: #111111;">cbp1</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span></span>
<span>  <span class="st" style="color: #20794D;">"#999999"</span>, <span class="st" style="color: #20794D;">"#E69F00"</span>, <span class="st" style="color: #20794D;">"#56B4E9"</span>, <span class="st" style="color: #20794D;">"#009E73"</span>,</span>
<span>  <span class="st" style="color: #20794D;">"#F0E442"</span>, <span class="st" style="color: #20794D;">"#0072B2"</span>, <span class="st" style="color: #20794D;">"#D55E00"</span>, <span class="st" style="color: #20794D;">"#CC79A7"</span></span>
<span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">p3</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="va" style="color: #111111;">p1</span> <span class="op" style="color: #5E5E5E;">+</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op" style="color: #5E5E5E;">(</span>values <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">cbp1</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">p3</span></span>
<span><span class="co" style="color: #5E5E5E;">## Use RColorBrewer palettes:</span></span>
<span><span class="va" style="color: #111111;">p4</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="va" style="color: #111111;">p1</span> <span class="op" style="color: #5E5E5E;">+</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_color_brewer</a></span><span class="op" style="color: #5E5E5E;">(</span>palette <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"Dark2"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">p4</span></span></code></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://guoruizhong.github.io/blog/2022/01/22/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://guoruizhong.github.io/blog/2022/01/22/index_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section><section id="reference" class="level2"><h2 class="anchored" data-anchor-id="reference">Reference</h2>
<ol type="1">
<li>http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/</li>
<li>http://www.sthda.com/english/wiki/colors-in-r</li>
<li>https://stackoverflow.com/questions/57153428/r-plot-color-combinations-that-are-colorblind-accessible</li>
</ol>


</section> ]]></description>
  <category>r</category>
  <category>tidyverse</category>
  <category>ggplot2</category>
  <category>color</category>
  <guid>https://guoruizhong.github.io/blog/2022/01/22/index.html</guid>
  <pubDate>Fri, 21 Jan 2022 16:00:00 GMT</pubDate>
  <media:content url="https://guoruizhong.github.io/blog/2022/01/22/colorblind_palette.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Blog</title>
  <dc:creator>Guorui Zhong</dc:creator>
  <link>https://guoruizhong.github.io/blog/index.html</link>
  <description><![CDATA[ 




<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section">2022</h2>
<div id="listing-posts_2022" class="quarto-listing quarto-listing-container-custom">
<div class="list blog">
    <div class="blog-entry" data-index="0" data-categories="Nomenclature" data-listing-date-sort="1664553600000" data-listing-file-modified-sort="1671183302387" data-listing-reading-time-sort="5.995">
        <div class="metadata">          
            <p class="date listing-date">October 1, 2022</p>
        </div>
        <div class="body">
            <p class="title listing-title"><a href="../blog/2022/10/01/index.html">Nomenclature for the description of mutations and variations</a></p>
            <div class="post-categories listing-categories">
                <div class="post-category listing-category" onclick="window.quartoListingCategory('Nomenclature'); return false;">
                    Nomenclature
                </div>
            </div>
            <p class="description listing-description"><!-- desc(5A0113B34292)[max=175]:blog/2022/10/01/index.html --></p>
        </div>
        <div class="thumbnail">
            <img src="https://guoruizhong.github.io/blog/2022/10/01/Mutation.jpg" alt="Nomenclature for the description of mutations and variations" title="Nomenclature for the description of mutations and variations">
        </div>
    </div>
    <div class="blog-entry" data-index="1" data-categories="plater,R" data-listing-date-sort="1662048000000" data-listing-file-modified-sort="1671182491785" data-listing-reading-time-sort="0.215">
        <div class="metadata">          
            <p class="date listing-date">September 2, 2022</p>
        </div>
        <div class="body">
            <p class="title listing-title"><a href="../blog/2022/09/02/index.html">Add experimental conditions to multi-well plates</a></p>
            <div class="post-categories listing-categories">
                <div class="post-category listing-category" onclick="window.quartoListingCategory('plater'); return false;">
                    plater
                </div>
                <div class="post-category listing-category" onclick="window.quartoListingCategory('R'); return false;">
                    R
                </div>
            </div>
            <p class="description listing-description">Tools for interacting with data from experiments done in microtiter plates. Easily read in plate-shaped data and convert it to tidy format, combine plate-shaped data with tidy data, and view tidy data in plate shape.</p>
        </div>
        <div class="thumbnail">
            <img src="https://guoruizhong.github.io/blog/2022/09/02/f1.jpg" alt="Add experimental conditions to multi-well plates" title="Add experimental conditions to multi-well plates">
        </div>
    </div>
    <div class="blog-entry" data-index="2" data-categories="platetools,R" data-listing-date-sort="1659283200000" data-listing-file-modified-sort="1671170591287" data-listing-reading-time-sort="0.64">
        <div class="metadata">          
            <p class="date listing-date">August 1, 2022</p>
        </div>
        <div class="body">
            <p class="title listing-title"><a href="../blog/2022/08/01/index.html">View data from 96/384 multi-well plates</a></p>
            <div class="post-categories listing-categories">
                <div class="post-category listing-category" onclick="window.quartoListingCategory('platetools'); return false;">
                    platetools
                </div>
                <div class="post-category listing-category" onclick="window.quartoListingCategory('R'); return false;">
                    R
                </div>
            </div>
            <p class="description listing-description">plater makes it easy to work with data from experiments performed in plates.</p>
        </div>
        <div class="thumbnail">
            <img src="https://guoruizhong.github.io/blog/2022/08/01/platetools.png" alt="View data from 96/384 multi-well plates" title="View data from 96/384 multi-well plates">
        </div>
    </div>
    <div class="blog-entry" data-index="3" data-categories="ggvolcano,R" data-listing-date-sort="1656604800000" data-listing-file-modified-sort="1671169297422" data-listing-reading-time-sort="1.61">
        <div class="metadata">          
            <p class="date listing-date">July 1, 2022</p>
        </div>
        <div class="body">
            <p class="title listing-title"><a href="../blog/2022/07/01/index.html">Volano plot with ggvolcano</a></p>
            <div class="post-categories listing-categories">
                <div class="post-category listing-category" onclick="window.quartoListingCategory('ggvolcano'); return false;">
                    ggvolcano
                </div>
                <div class="post-category listing-category" onclick="window.quartoListingCategory('R'); return false;">
                    R
                </div>
            </div>
            <p class="description listing-description"><!-- desc(5A0113B34292)[max=175]:blog/2022/07/01/index.html --></p>
        </div>
        <div class="thumbnail">
            <img src="https://guoruizhong.github.io/blog/2022/07/01/ggvolcano.png" alt="Volano plot with ggvolcano" title="Volano plot with ggvolcano">
        </div>
    </div>
    <div class="blog-entry" data-index="4" data-categories="pheatmap,R" data-listing-date-sort="1654012800000" data-listing-file-modified-sort="1671168764763" data-listing-reading-time-sort="1.18">
        <div class="metadata">          
            <p class="date listing-date">June 1, 2022</p>
        </div>
        <div class="body">
            <p class="title listing-title"><a href="../blog/2022/06/01/index.html">Visualizing clusters with heatmaps</a></p>
            <div class="post-categories listing-categories">
                <div class="post-category listing-category" onclick="window.quartoListingCategory('pheatmap'); return false;">
                    pheatmap
                </div>
                <div class="post-category listing-category" onclick="window.quartoListingCategory('R'); return false;">
                    R
                </div>
            </div>
            <p class="description listing-description"><!-- desc(5A0113B34292)[max=175]:blog/2022/06/01/index.html --></p>
        </div>
        <div class="thumbnail">
            <img src="https://guoruizhong.github.io/blog/2022/06/01/pheatmap.png" alt="Visualizing clusters with heatmaps" title="Visualizing clusters with heatmaps">
        </div>
    </div>
    <div class="blog-entry" data-index="5" data-categories="ggh4x,ggplot2,tidyverse,R" data-listing-date-sort="1651420800000" data-listing-file-modified-sort="1671168130915" data-listing-reading-time-sort="2.555">
        <div class="metadata">          
            <p class="date listing-date">May 2, 2022</p>
        </div>
        <div class="body">
            <p class="title listing-title"><a href="../blog/2022/05/02/index.html">How to plot scatter plot with truncated axis</a></p>
            <div class="post-categories listing-categories">
                <div class="post-category listing-category" onclick="window.quartoListingCategory('ggh4x'); return false;">
                    ggh4x
                </div>
                <div class="post-category listing-category" onclick="window.quartoListingCategory('ggplot2'); return false;">
                    ggplot2
                </div>
                <div class="post-category listing-category" onclick="window.quartoListingCategory('tidyverse'); return false;">
                    tidyverse
                </div>
                <div class="post-category listing-category" onclick="window.quartoListingCategory('R'); return false;">
                    R
                </div>
            </div>
            <p class="description listing-description"><!-- desc(5A0113B34292)[max=175]:blog/2022/05/02/index.html --></p>
        </div>
        <div class="thumbnail">
            <img src="https://guoruizhong.github.io/blog/2022/05/02/truncated.png" alt="How to plot scatter plot with truncated axis" title="How to plot scatter plot with truncated axis">
        </div>
    </div>
    <div class="blog-entry" data-index="6" data-categories="ggsignif,ggh4x,ggplot2,tidyverse,R" data-listing-date-sort="1643644800000" data-listing-file-modified-sort="1671163936929" data-listing-reading-time-sort="3.495">
        <div class="metadata">          
            <p class="date listing-date">February 1, 2022</p>
        </div>
        <div class="body">
            <p class="title listing-title"><a href="../blog/2022/02/01/index.html">Add errorbar and p-value on barplot with ggsignif</a></p>
            <div class="post-categories listing-categories">
                <div class="post-category listing-category" onclick="window.quartoListingCategory('ggsignif'); return false;">
                    ggsignif
                </div>
                <div class="post-category listing-category" onclick="window.quartoListingCategory('ggh4x'); return false;">
                    ggh4x
                </div>
                <div class="post-category listing-category" onclick="window.quartoListingCategory('ggplot2'); return false;">
                    ggplot2
                </div>
                <div class="post-category listing-category" onclick="window.quartoListingCategory('tidyverse'); return false;">
                    tidyverse
                </div>
                <div class="post-category listing-category" onclick="window.quartoListingCategory('R'); return false;">
                    R
                </div>
            </div>
            <p class="description listing-description"><!-- desc(5A0113B34292)[max=175]:blog/2022/02/01/index.html --></p>
        </div>
        <div class="thumbnail">
            <img src="https://guoruizhong.github.io/blog/2022/02/01/barplot.png" alt="Add errorbar and p-value on barplot with ggsignif" title="Add errorbar and p-value on barplot with ggsignif">
        </div>
    </div>
    <div class="blog-entry" data-index="7" data-categories="r,tidyverse,ggplot2,color" data-listing-date-sort="1642780800000" data-listing-file-modified-sort="1671163433066" data-listing-reading-time-sort="0.675">
        <div class="metadata">          
            <p class="date listing-date">January 22, 2022</p>
        </div>
        <div class="body">
            <p class="title listing-title"><a href="../blog/2022/01/22/index.html">Use colorblind-friendly palette for visualization</a></p>
            <div class="post-categories listing-categories">
                <div class="post-category listing-category" onclick="window.quartoListingCategory('r'); return false;">
                    r
                </div>
                <div class="post-category listing-category" onclick="window.quartoListingCategory('tidyverse'); return false;">
                    tidyverse
                </div>
                <div class="post-category listing-category" onclick="window.quartoListingCategory('ggplot2'); return false;">
                    ggplot2
                </div>
                <div class="post-category listing-category" onclick="window.quartoListingCategory('color'); return false;">
                    color
                </div>
            </div>
            <p class="description listing-description">Use friendly colors in a graph with ggplot2</p>
        </div>
        <div class="thumbnail">
            <img src="https://guoruizhong.github.io/blog/2022/01/22/colorblind_palette.jpg" alt="Use colorblind-friendly palette for visualization" title="Use colorblind-friendly palette for visualization">
        </div>
    </div>
</div>
<div class="listing-no-matching d-none">
No matching items
</div>
</div>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1">2021</h2>
<div id="listing-posts_2021" class="quarto-listing quarto-listing-container-custom">
<div class="list blog">
    <div class="blog-entry" data-index="0" data-categories="Inkscape,Greek letters" data-listing-date-sort="1622476800000" data-listing-file-modified-sort="1671113017983" data-listing-reading-time-sort="0.11">
        <div class="metadata">          
            <p class="date listing-date">June 1, 2021</p>
        </div>
        <div class="body">
            <p class="title listing-title"><a href="../blog/2021/06/01/index.html">Using greek unicode in Inkscape</a></p>
            <div class="post-categories listing-categories">
                <div class="post-category listing-category" onclick="window.quartoListingCategory('Inkscape'); return false;">
                    Inkscape
                </div>
                <div class="post-category listing-category" onclick="window.quartoListingCategory('Greek letters'); return false;">
                    Greek letters
                </div>
            </div>
            <p class="description listing-description"><!-- desc(5A0113B34292)[max=175]:blog/2021/06/01/index.html --></p>
        </div>
        <div class="thumbnail">
            <img src="https://guoruizhong.github.io/blog/2021/06/01/greekscape.jpg" alt="Using greek unicode in Inkscape" title="Using greek unicode in Inkscape">
        </div>
    </div>
    <div class="blog-entry" data-index="1" data-categories="Fiji,ImageJ" data-listing-date-sort="1615824000000" data-listing-file-modified-sort="1671160259572" data-listing-reading-time-sort="1.05">
        <div class="metadata">          
            <p class="date listing-date">March 16, 2021</p>
        </div>
        <div class="body">
            <p class="title listing-title"><a href="../blog/2021/03/16/index.html">Crop image and add scale bar with ImageJ/Fiji</a></p>
            <div class="post-categories listing-categories">
                <div class="post-category listing-category" onclick="window.quartoListingCategory('Fiji'); return false;">
                    Fiji
                </div>
                <div class="post-category listing-category" onclick="window.quartoListingCategory('ImageJ'); return false;">
                    ImageJ
                </div>
            </div>
            <p class="description listing-description"><!-- desc(5A0113B34292)[max=175]:blog/2021/03/16/index.html --></p>
        </div>
        <div class="thumbnail">
            <img src="https://guoruizhong.github.io/blog/2021/03/16/f4.png" alt="Crop image and add scale bar with ImageJ/Fiji" title="Crop image and add scale bar with ImageJ/Fiji">
        </div>
    </div>
    <div class="blog-entry" data-index="2" data-categories="Punctuation" data-listing-date-sort="1612108800000" data-listing-file-modified-sort="1671112262695" data-listing-reading-time-sort="0.205">
        <div class="metadata">          
            <p class="date listing-date">February 1, 2021</p>
        </div>
        <div class="body">
            <p class="title listing-title"><a href="../blog/2021/02/01/index.html">Punctuation marks words</a></p>
            <div class="post-categories listing-categories">
                <div class="post-category listing-category" onclick="window.quartoListingCategory('Punctuation'); return false;">
                    Punctuation
                </div>
            </div>
            <p class="description listing-description">I don't know why i can not remember this English punctuation marks</p>
        </div>
        <div class="thumbnail">
            <img src="https://guoruizhong.github.io/blog/2021/02/01/punctuation.jpg" alt="Punctuation marks words" title="Punctuation marks words">
        </div>
    </div>
    <div class="blog-entry" data-index="3" data-categories="greek letters,Markdown" data-listing-date-sort="1609516800000" data-listing-file-modified-sort="1671160034280" data-listing-reading-time-sort="0.08">
        <div class="metadata">          
            <p class="date listing-date">January 2, 2021</p>
        </div>
        <div class="body">
            <p class="title listing-title"><a href="../blog/2021/01/02/index.html">Markdown input greek letters</a></p>
            <div class="post-categories listing-categories">
                <div class="post-category listing-category" onclick="window.quartoListingCategory('greek letters'); return false;">
                    greek letters
                </div>
                <div class="post-category listing-category" onclick="window.quartoListingCategory('Markdown'); return false;">
                    Markdown
                </div>
            </div>
            <p class="description listing-description">Commonly used greek letters when using markdown</p>
        </div>
        <div class="thumbnail">
            <img src="https://guoruizhong.github.io/blog/2021/01/02/greek_letters.png" alt="Markdown input greek letters" title="Markdown input greek letters">
        </div>
    </div>
</div>
<div class="listing-no-matching d-none">
No matching items
</div>
</div>



</section>

 ]]></description>
  <guid>https://guoruizhong.github.io/blog/index.html</guid>
  <pubDate>Fri, 16 Dec 2022 12:00:27 GMT</pubDate>
</item>
</channel>
</rss>
