{
  "hash": "b45898117bbc00b50b62f4b9f90e8c15",
  "result": {
    "markdown": "---\ntitle: \"General workflow for Bulk RNAseq data analysis with R\"\ndate: 2023-09-11\ndate-modified: last-modified\ncategories:\n  - RNA-seq\nimage: workflow.png\n# draft: true\ndescription: Use lightweight and open-source software with  R programming language and the Bioconductor suite of packages to perfrm RNA-seq data analysis.\n\nexecute: \n  # freeze: true\n  # echo: false\n  warning: false\n  # eval: false\n---\n\n\n\n![](workflow.png)\n\n## Step1: Check the quality of raw reads\n\n```bash\n### go to row reads folder\ncd ~/onedrive/analysis/230907_DIY_Transcriptomics/data/fastq\n### activate env\nconda active rnaseq\n### use fastqc to check the quality of fastq files\nfastqc *.gz -t 4\n```\n\n## Step2: Mapping reads with Kallisto pseudoaligment\n\n- Download reference transciptome files from [here](https://asia.ensembl.org/info/data/ftp/index.html)\n\n- Build an index from reference fasta file\n\n```bash\nkallisto index -i Homo_sapiens.GRCh38.cdna.all.index Homo_sapiens.GRCh38.cdna.all.fa.gz\n```\n- Map reads to the indexed reference host transcriptome\n\n![](map_single_end.png)\n\n![](map_paired_end.png)\n\n- Summarize output with Multiqc  in a single summary html\n\n```bash\nmultiqc -d .\n```\n\n```bash\n### first the healthy subjects (HS)\nkallisto quant -i Homo_sapiens.GRCh38.cdna.all.index -o HS01 -t 4 --single -l 250 -s 30 SRR8668755.fastq.gz &> HS01.log\nkallisto quant -i Homo_sapiens.GRCh38.cdna.all.index -o HS02 -t 4 --single -l 250 -s 30 SRR8668756.fastq.gz &> HS02.log\nkallisto quant -i Homo_sapiens.GRCh38.cdna.all.index -o HS03 -t 4 --single -l 250 -s 30 SRR8668757.fastq.gz &> HS03.log\nkallisto quant -i Homo_sapiens.GRCh38.cdna.all.index -o HS04 -t 4 --single -l 250 -s 30 SRR8668758.fastq.gz &> HS04.log\nkallisto quant -i Homo_sapiens.GRCh38.cdna.all.index -o HS05 -t 4 --single -l 250 -s 30 SRR8668759.fastq.gz &> HS05.log\n\n### then the cutaneous leishmaniasis (CL) patients\nkallisto quant -i Homo_sapiens.GRCh38.cdna.all.index -o CL08 -t 4 --single -l 250 -s 30 SRR8668769.fastq.gz &> CL08.log\nkallisto quant -i Homo_sapiens.GRCh38.cdna.all.index -o CL10 -t 4 --single -l 250 -s 30 SRR8668771.fastq.gz &> CL10.log\nkallisto quant -i Homo_sapiens.GRCh38.cdna.all.index -o CL11 -t 4 --single -l 250 -s 30 SRR8668772.fastq.gz &> CL11.log\nkallisto quant -i Homo_sapiens.GRCh38.cdna.all.index -o CL12 -t 4 --single -l 250 -s 30 SRR8668773.fastq.gz &> CL12.log\nkallisto quant -i Homo_sapiens.GRCh38.cdna.all.index -o CL13 -t 4 --single -l 250 -s 30 SRR8668774.fastq.gz &> CL13.log\n\n### Summarize outputs\nmultiqc -d .\n```\n\n\n## Step3: Import data into R\n\n### Load packages\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n### load packages\nlibrary(rhdf5) # provides functions for handling hdf5 file formats (kallisto outputs bootstraps in this format)\nlibrary(tidyverse) # Hadley Wickham's collection of R packages for data science, which we will use throughout the course\nlibrary(tximport) # package for getting Kallisto results into R\nlibrary(ensembldb) # helps deal with ensembl\nlibrary(EnsDb.Hsapiens.v86) # replace with your organism-specific database package\nlibrary(here) # file path\nlibrary(datapasta) # paste data into R from clipboard\nlibrary(edgeR) # well known package for differential expression analysis, but we only use for the DGEList object and for normalization methods\nlibrary(matrixStats) # easily calculate stats on rows or columns of a data matrix\nlibrary(cowplot) # allows you to combine multiple plots in one figure\nlibrary(DT) # for making interactive tables\nlibrary(plotly) # for making interactive plots\nlibrary(gt) # A layered 'grammar of tables' - think ggplot, but for tables\nlibrary(limma) # venerable package for differential gene expression using linear modeling\nlibrary(edgeR)\nlibrary(RColorBrewer) # need colors to make heatmaps\n# library(gameofthrones) #because...why not.  Install using 'devtools::install_github(\"aljrico/gameofthrones\")'\nlibrary(heatmaply) #for making interactive heatmaps using plotly\nlibrary(gplots)\n# library(d3heatmap) # for making interactive heatmaps using D3\nlibrary(GSEABase) # functions and methods for Gene Set Enrichment Analysis\nlibrary(Biobase) # base functions for bioconductor; required by GSEABase\nlibrary(GSVA) # Gene Set Variation Analysis, a non-parametric and unsupervised method for estimating variation of gene set enrichment across samples.\nlibrary(gprofiler2) # tools for accessing the GO enrichment results using g:Profiler web resources\nlibrary(clusterProfiler) # provides a suite of tools for functional enrichment analysis\nlibrary(msigdbr) # access to msigdb collections directly within R\nlibrary(enrichplot) # great for making the standard GSEA enrichment plots\n```\n:::\n\n### Import study design files\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n### load study design\ntargets <- read_tsv(\n    here(\"data\", \"230907_DIY_Transcriptomics\", \"studydesign.txt\")\n)\ntargets\n## # A tibble: 10 × 3\n##    sample sra_accession group  \n##    <chr>  <chr>         <chr>  \n##  1 HS01   SRR8668755    healthy\n##  2 HS02   SRR8668756    healthy\n##  3 HS03   SRR8668757    healthy\n##  4 HS04   SRR8668758    healthy\n##  5 HS05   SRR8668759    healthy\n##  6 CL08   SRR8668769    disease\n##  7 CL10   SRR8668771    disease\n##  8 CL11   SRR8668772    disease\n##  9 CL12   SRR8668773    disease\n## 10 CL13   SRR8668774    disease\n\n### create file paths for the abundance files\npath <- file.path(\n    \"data\", \"230907_DIY_Transcriptomics\", targets$sample, \"abundance.tsv\"\n)\npath\n##  [1] \"data/230907_DIY_Transcriptomics/HS01/abundance.tsv\"\n##  [2] \"data/230907_DIY_Transcriptomics/HS02/abundance.tsv\"\n##  [3] \"data/230907_DIY_Transcriptomics/HS03/abundance.tsv\"\n##  [4] \"data/230907_DIY_Transcriptomics/HS04/abundance.tsv\"\n##  [5] \"data/230907_DIY_Transcriptomics/HS05/abundance.tsv\"\n##  [6] \"data/230907_DIY_Transcriptomics/CL08/abundance.tsv\"\n##  [7] \"data/230907_DIY_Transcriptomics/CL10/abundance.tsv\"\n##  [8] \"data/230907_DIY_Transcriptomics/CL11/abundance.tsv\"\n##  [9] \"data/230907_DIY_Transcriptomics/CL12/abundance.tsv\"\n## [10] \"data/230907_DIY_Transcriptomics/CL13/abundance.tsv\"\n\n### make sure path is correct\nall(file.exists(path))\n## [1] TRUE\n```\n:::\n\n### Get organsim specific annotations\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntx <- transcripts(\n    EnsDb.Hsapiens.v86, columns = c(\"tx_id\", \"gene_name\")\n) |>\n    as_tibble() |> \n    ### need to change first column name to 'target_id'\n    rename(target_id = tx_id)\ntx\n## # A tibble: 216,741 × 7\n##    seqnames start   end width strand target_id       gene_name\n##    <fct>    <int> <int> <int> <fct>  <chr>           <chr>    \n##  1 1        11869 14409  2541 +      ENST00000456328 DDX11L1  \n##  2 1        12010 13670  1661 +      ENST00000450305 DDX11L1  \n##  3 1        14404 29570 15167 -      ENST00000488147 WASH7P   \n##  4 1        17369 17436    68 -      ENST00000619216 MIR6859-1\n##  5 1        29554 31097  1544 +      ENST00000473358 MIR1302-2\n##  6 1        30267 31109   843 +      ENST00000469289 MIR1302-2\n##  7 1        30366 30503   138 +      ENST00000607096 MIR1302-2\n##  8 1        34554 36081  1528 -      ENST00000417324 FAM138A  \n##  9 1        35245 36073   829 -      ENST00000461467 FAM138A  \n## 10 1        52473 53312   840 +      ENST00000606857 OR4G4P   \n## # ℹ 216,731 more rows\n\n### move transcrip ID the first column in the dataframe\ntx <- select(tx, \"target_id\", \"gene_name\")\n```\n:::\n\n\n### Load transcript counts\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntxi_gene <- tximport(\n    path,\n    type = \"kallisto\",\n    tx2gene = tx,\n    txOut = FALSE, # How does the result change if this =FALSE vs =TRUE?\n    countsFromAbundance = \"lengthScaledTPM\",\n    ignoreTxVersion = TRUE\n)\n\n### take a look at the type of object\nclass(txi_gene)\n## [1] \"list\"\nnames(txi_gene)\n## [1] \"abundance\"           \"counts\"              \"length\"             \n## [4] \"countsFromAbundance\"\n```\n:::\n\n\n## Step4: Wrangling gene expression\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n### examine the data\ntpm <- txi_gene$abundance\ncounts <- txi_gene$counts\n\n### generate summary stats\ntpm_stats <- transform(\n    tpm,\n    SD = rowSds(tpm),\n    AVG = rowMeans(tpm),\n    MED = rowMedians(tpm)\n)\n\n### look at the summary data\nhead(tpm_stats)\n##                  X1          X2         X3           X4         X5          X6\n## 5S_rRNA   0.0000000   0.0000000   0.000000   0.00000000   0.000000   0.0000000\n## A1BG      6.3823340   6.7399420   3.842043   6.70710000   8.591181  14.6144150\n## A1CF      0.0757872   0.0616752   0.214226   0.00859446   0.000000   0.0265036\n## A2M     162.5622990 341.8312630 295.814803 261.47230600 169.453100 345.6983730\n## A2ML1   109.6624900  80.6018680  90.356840  64.11152700  67.035650  52.5762220\n## A2MP1     0.2237170   0.3143760   0.390022   0.15622800   0.122260   0.2700100\n##                 X7          X8           X9         X10           SD\n## 5S_rRNA   0.000000   0.0000000   0.00000000   0.0000000   0.00000000\n## A1BG     18.182700  12.8662800  12.05296100   9.8268802   4.41172300\n## A1CF      0.072777   0.1359934   0.03722713   0.0581254   0.06414927\n## A2M     643.554440 341.8972850 324.80208900 415.9663840 135.78415021\n## A2ML1     4.401309   5.1981760   1.75721000  15.1189910  39.78108982\n## A2MP1     1.087410   0.7737610   0.68834900   0.6378640   0.31619850\n##                  AVG         MED\n## 5S_rRNA   0.00000000   0.0000000\n## A1BG      9.98058361   9.2090306\n## A1CF      0.06909094   0.0599003\n## A2M     330.30523424 333.3166760\n## A2ML1    49.08202830  58.3438745\n## A2MP1     0.46639970   0.3521990\n\n### visualize it using scatter plot\nggplot(tpm_stats, aes(x = SD, y = MED)) +\n    geom_point(shape = 18, size = 2) +\n    geom_smooth(method = lm) +\n    geom_hex(show.legend = FALSE) +\n    labs(\n        y = \"Median\", x = \"Standard deviation\",\n        title = \"Transcripts per million (TPM)\",\n        subtitle = \"unfiltered, non-normalized data\",\n        caption = \"DIYtranscriptomics - Spring 2020\"\n    ) +\n    theme_classic() +\n    theme_dark() +\n    theme_bw()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=100%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n### capture sample labels from study design\nsampleLabels <- targets$sample\n\n### make DGElist from the counts\nDGEList <- DGEList(txi_gene$counts)\nDGEList\n## An object of class \"DGEList\"\n## $counts\n##             Sample1     Sample2     Sample3     Sample4  Sample5     Sample6\n## 5S_rRNA     0.00000     0.00000     0.00000    0.000000   0.0000     0.00000\n## A1BG      184.19070   245.13169   101.73418   79.204797  13.3335   682.72256\n## A1CF       22.94477    23.53171    59.50815    1.064719   0.0000    12.98875\n## A2M     11901.13136 31538.08430 19870.31859 7832.900974 667.1460 40967.58721\n## A2ML1   15162.86062 14045.04908 11463.06052 3627.335147 498.4618 11767.57706\n##            Sample7     Sample8     Sample9    Sample10\n## 5S_rRNA     0.0000     0.00000     0.00000     0.00000\n## A1BG      391.5812   326.10430   397.97768   499.96534\n## A1CF       16.4421    36.15938    12.89508    31.02343\n## A2M     35158.3894 21982.61779 27205.95758 53686.20520\n## A2ML1     454.1300   631.23251   277.98636  3685.37686\n## 35366 more rows ...\n## \n## $samples\n##          group lib.size norm.factors\n## Sample1      1 42300696            1\n## Sample2      1 51775632            1\n## Sample3      1 40485664            1\n## Sample4      1 16661634            1\n## Sample5      1  2191577            1\n## Sample6      1 55389922            1\n## Sample7      1 28800520            1\n## Sample8      1 31632164            1\n## Sample9      1 39464569            1\n## Sample10     1 67827185            1\n\n### get counts per million\ncpm <- cpm(DGEList)\ncolSums(cpm)\n##  Sample1  Sample2  Sample3  Sample4  Sample5  Sample6  Sample7  Sample8 \n##    1e+06    1e+06    1e+06    1e+06    1e+06    1e+06    1e+06    1e+06 \n##  Sample9 Sample10 \n##    1e+06    1e+06\n\nlog2_cpm <- cpm(DGEList, log=TRUE)\n### connvert data matrix to dataframe\nlog2_cpm_df <- as_tibble(log2_cpm, rownames = \"geneID\")\n### add sample names\ncolnames(log2_cpm_df) <- c(\"geneID\", sampleLabels)\n\n### pivot from wide to long \nlog2_cpm_df_pivot <- pivot_longer(\n  log2_cpm_df, \n  cols = HS01:CL13, \n  names_to = \"samples\", \n  values_to = \"expression\" \n) \n\np1 <- ggplot(\n    log2_cpm_df_pivot,\n    aes(x = samples, y = expression, fill = samples)\n) +\n    geom_violin(trim = FALSE, show.legend = FALSE) +\n    stat_summary(fun = \"median\",\n        geom = \"point\",\n        shape = 95,\n        size = 10,\n        color = \"black\",\n        show.legend = FALSE\n    ) +\n    labs(\n        y = \"log2 expression\", x = \"sample\",\n        title = \"Log2 Counts per Million (CPM)\",\n        subtitle = \"unfiltered, non-normalized\",\n        caption = paste0(\"produced on \", Sys.time())\n    ) +\n    theme_bw()\np1\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=100%}\n:::\n:::\n\n- How many genes or transcripts have no read counts at all?\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n### filter data\ntable(rowSums(DGEList$counts==0)==10)\n## \n## FALSE  TRUE \n## 29373  5998\n\n### how many genes had more than 1 CPM (TRUE) in at least 3 samples\n\n### set cutoff\nkeepers <- rowSums(cpm>1) >= 5 # user defined\nDGEList_filtered <- DGEList[keepers, ]\n\nlog2_cpm_filtered <- cpm(DGEList_filtered, log=TRUE)\nlog2_cpm_filtered_df <- as_tibble(log2_cpm_filtered, rownames = \"geneID\")\ncolnames(log2_cpm_filtered_df) <- c(\"geneID\", sampleLabels)\nlog2_cpm_filtered_df_pivot <- pivot_longer(\n    log2_cpm_filtered_df,\n    cols = HS01:CL13,\n    names_to = \"samples\",\n    values_to = \"expression\"\n)\n\np2 <- ggplot(\n    log2_cpm_filtered_df_pivot,\n    aes(x = samples, y = expression, fill = samples)\n) +\n    geom_violin(trim = FALSE, show.legend = FALSE) +\n    stat_summary(\n        fun = \"median\",\n        geom = \"point\",\n        shape = 95,\n        size = 10,\n        color = \"black\",\n        show.legend = FALSE\n    ) +\n    labs(y = \"log2 expression\", x = \"sample\",\n        title = \"Log2 Counts per Million (CPM)\",\n        subtitle = \"filtered, non-normalized\",\n        caption = paste0(\"produced on \", Sys.time())) +\n    theme_bw()\n\np2\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=100%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n### normalize data\nDGEList_filtered_norm <- calcNormFactors(\n    DGEList_filtered, method = \"TMM\"\n)\nlog2_cpm_filtered_norm <- cpm(\n    DGEList_filtered_norm, log = TRUE\n)\nlog2_cpm_filtered_norm_df <- as_tibble(\n    log2_cpm_filtered_norm, rownames = \"geneID\"\n)\ncolnames(log2_cpm_filtered_norm_df) <- c(\"geneID\", sampleLabels)\n\nlog2_cpm_filtered_norm_df_pivot <- pivot_longer(\n    log2_cpm_filtered_norm_df,\n    cols = HS01:CL13,\n    names_to = \"samples\",\n    values_to = \"expression\"\n)\n\np3 <- ggplot(\n    log2_cpm_filtered_norm_df_pivot,\n    aes(x = samples, y = expression, fill = samples)\n) +\n    geom_violin(trim = FALSE, show.legend = FALSE) +\n    stat_summary(\n        fun = \"median\",\n        geom = \"point\",\n        shape = 95,\n        size = 10,\n        color = \"black\",\n        show.legend = FALSE\n    ) +\n    labs(\n        y = \"log2 expression\", x = \"sample\",\n        title = \"Log2 Counts per Million (CPM)\",\n        subtitle = \"filtered, TMM normalized\",\n        caption = paste0(\"produced on \", Sys.time())\n    ) +\n    theme_bw()\n\n### combine plots\nplot_grid(\n  p1, p2, p3, \n  labels = c('A', 'B', 'C'), \n  label_size = 12\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){fig-align='center' width=100%}\n:::\n:::\n\n## Step5: Data exploration with multivariate analysis\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n### Identify variables of interest in study design file\ngroup <- targets$group\ngroup <- factor(group)\ngroup\n##  [1] healthy healthy healthy healthy healthy disease disease disease disease\n## [10] disease\n## Levels: disease healthy\n```\n:::\n\n\n### Hierarchical clustering\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n### calculate distance  methods (e.g. switch from 'maximum' to 'euclidean')\ndistance <- dist(\n    t(log2_cpm_filtered_norm), method = \"maximum\"\n)\n### other distance methods are \"euclidean\", maximum\", \"manhattan\", \"canberra\", \"binary\" or \"minkowski\"\n\nclusters <- hclust(distance, method = \"average\") \n### other agglomeration methods are \"ward.D\", \"ward.D2\", \"single\", \"complete\", \"average\", \"mcquitty\", \"median\", or \"centroid\"\nplot(clusters, labels=sampleLabels)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n### Principal compoent analysis\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npca_res <- prcomp(\n    t(log2_cpm_filtered_norm),\n    scale. = FALSE, retx = TRUE\n)\n\n\n### prints variance summary for all principal components.\nsummary(pca_res)\n## Importance of components:\n##                             PC1     PC2      PC3      PC4      PC5      PC6\n## Standard deviation     113.9821 49.8074 33.42376 27.08082 26.40296 22.23750\n## Proportion of Variance   0.6656  0.1271  0.05723  0.03757  0.03571  0.02533\n## Cumulative Proportion    0.6656  0.7927  0.84993  0.88750  0.92322  0.94855\n##                             PC7      PC8      PC9      PC10\n## Standard deviation     20.50645 17.71945 16.42366 1.816e-13\n## Proportion of Variance  0.02154  0.01609  0.01382 0.000e+00\n## Cumulative Proportion   0.97010  0.98618  1.00000 1.000e+00\n\n### look at the PCA result (pca.res)\nls(pca_res)\n## [1] \"center\"   \"rotation\" \"scale\"    \"sdev\"     \"x\"\n\n### $rotation shows you how much each gene influenced each PC (called 'scores')\nhead(pca_res$rotation) \n##                 PC1          PC2           PC3          PC4           PC5\n## A1BG    0.006058601 -0.005265865  0.0030322868  0.008759217  0.0021903806\n## A2M     0.004897345  0.002459393 -0.0029437295  0.010128989  0.0010754828\n## A2ML1  -0.015426376  0.002131922  0.0236833694  0.012776801  0.0151330784\n## A2MP1   0.008361769  0.005416383 -0.0080073403 -0.004989098  0.0019137300\n## A4GALT -0.004861196 -0.010071400 -0.0040747825  0.004365382 -0.0073287027\n## AAAS    0.002247684 -0.005546829 -0.0003891962  0.005401109 -0.0008667994\n##                 PC6           PC7         PC8          PC9        PC10\n## A1BG    0.002600255  1.165903e-02 0.002109927  0.006017461 -0.62642253\n## A2M    -0.003082754 -2.988929e-03 0.007583352 -0.002958490 -0.07649096\n## A2ML1  -0.013272183 -1.389944e-02 0.008501332  0.020687796  0.29435235\n## A2MP1  -0.002415560  1.626299e-03 0.011281299 -0.005577339 -0.50451276\n## A4GALT -0.009698589  6.199904e-05 0.012467687  0.004110126 -0.31572438\n## AAAS    0.006991981  3.783003e-03 0.004628266  0.003568768 -0.14061416\n\n### 'x' shows you how much each sample influenced each PC (called 'loadings')\npca_res$x \n##                 PC1          PC2        PC3        PC4         PC5        PC6\n## Sample1  -116.29139   38.2334807  21.154790 -31.204512  24.3342557  -5.032445\n## Sample2   -98.08443   28.5182187   6.488451  20.455248 -24.7150117  -5.625522\n## Sample3   -98.57599   46.3377421 -21.880766 -22.638077  26.9619112   8.312240\n## Sample4  -102.83232   27.1997919 -10.521681  36.884584 -34.6489813  11.837625\n## Sample5  -119.48548 -130.0448432  -8.771308  -8.078419   0.7747427  -2.609032\n## Sample6    76.83934  -13.0282654  65.541177  34.668976  32.4966464   9.756467\n## Sample7   114.80802    0.9427947 -66.411954  27.226075  30.8708143  -6.756527\n## Sample8   122.14072   -0.8992447  -2.600281 -31.000051 -26.0328136  19.278692\n## Sample9   129.23356   -4.8764679   3.983424 -16.285254 -13.4446636  25.667565\n## Sample10   92.24799    7.6167930  13.018146 -10.028570 -16.5969001 -54.829063\n##                 PC7         PC8         PC9          PC10\n## Sample1   37.289161  -8.2755495   9.2338103  6.432316e-13\n## Sample2    9.263960  37.6085903 -14.4523481  7.064106e-14\n## Sample3  -40.584484   0.6580365  -8.3486393  3.455381e-13\n## Sample4   -3.089166 -28.1333136  11.4331050 -5.619926e-14\n## Sample5   -2.014396  -0.2124505  -0.6860841 -1.205842e-13\n## Sample6  -10.563273   2.1965073   5.3204553 -6.485607e-14\n## Sample7   15.193876   4.0838551   4.1812220 -2.588419e-13\n## Sample8   -5.936520  15.6564254  28.6671255 -1.908206e-13\n## Sample9   11.836127 -13.5624080 -32.5109827 -3.271781e-13\n## Sample10 -11.395285 -10.0196929  -2.8376640  1.788202e-13\n\n### A screeplot is a standard way to view eigenvalues for each PCA\nscreeplot(pca_res) \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){fig-align='center' width=100%}\n:::\n\n```{.r .cell-code}\n\n### sdev^2 captures these eigenvalues from the PCA result\npc_var <- pca_res$sdev^2 \n\n### use these eigenvalues to calculate the percentage variance explained by each PC\npc_per <- round(pc_var/sum(pc_var)*100, 1) \npc_per\n##  [1] 66.6 12.7  5.7  3.8  3.6  2.5  2.2  1.6  1.4  0.0\n```\n:::\n\n- Can we figure out the identify of outlier?\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n### visualize PCA result \npca_res_df <- as_tibble(pca_res$x) |> \n  bind_cols(targets) |> \n  mutate(group = factor(group))\npca_plot1 <- pca_res_df |>\n    ggplot(\n        aes(x = PC1, y = PC2, label = sample, color = group)\n    ) +\n    geom_point(size = 4) +\n    stat_ellipse() +\n    xlab(paste0(\"PC1 (\", pc_per[1], \"%\", \")\")) +\n    ylab(paste0(\"PC2 (\", pc_per[2], \"%\", \")\")) +\n    labs(title = \"PCA plot\",\n        caption = paste0(\"produced on \", Sys.time())) +\n    coord_fixed() +\n    theme_bw()\n\npca_plot1\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-1.png){fig-align='center' width=100%}\n:::\n:::\n\n- Another way to view PCA laodings to understand impact of each sample on each pricipal component\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npca_res_df <- pca_res$x[, 1:4] |>\n    as_tibble() |>\n    add_column(\n        sample = sampleLabels,\n        group = group\n    )\n### dataframe to be pivoted  \npca_pivot <- pivot_longer(\n  pca_res_df, \n  cols = PC1:PC4, \n  names_to = \"PC\", \n  values_to = \"loadings\"\n) \n### plot\npca_plot2 <- ggplot(pca_pivot) +\n    aes(x = sample, y = loadings, fill = group) +\n    geom_bar(stat = \"identity\") +\n    facet_wrap(~PC) +\n    labs(\n        title = \"PCA 'small multiples' plot\",\n        caption = paste0(\"produced on \", Sys.time())\n    ) +\n    theme_bw() +\n    coord_flip()\npca_plot2\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-1.png){fig-align='center' width=100%}\n:::\n\n```{.r .cell-code}\n### combine plot\n# plot_grid(pca_plot1, pca_plot2)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# make columns comparing each of the averages above that you're interested in\nmydata_df <- mutate(\n  log2_cpm_filtered_norm_df,\n  healthy.AVG = (HS01 + HS02 + HS03 + HS04 + HS05)/5, \n  disease.AVG = (CL08 + CL10 + CL11 + CL12 + CL13)/5,\n  LogFC = (disease.AVG - healthy.AVG)\n  ) |> \n  mutate_if(is.numeric, round, 2)\n\n### sort data\nmydata_sort <- mydata_df |>\n  arrange(desc(LogFC)) |> \n  select(geneID, LogFC)\nmydata_sort\n## # A tibble: 15,765 × 2\n##    geneID    LogFC\n##    <chr>     <dbl>\n##  1 IGLC3     10.6 \n##  2 MMP1      10.4 \n##  3 IGKV1-5   10.2 \n##  4 IGLV3-1    9.96\n##  5 IGLV3-19   9.9 \n##  6 IGLC1      9.88\n##  7 IGKV1D-39  9.87\n##  8 IGLL5      9.85\n##  9 IGKV1D-33  9.83\n## 10 IGLV2-8    9.65\n## # ℹ 15,755 more rows\n\n### filter data\nmydata_filter <- mydata_df |>\n    filter(\n        geneID == \"MMP1\" | geneID == \"GZMB\" | geneID == \"IL1B\" | geneID == \"GNLY\" | geneID == \"IFNG\"\n        | geneID == \"CCL4\" | geneID == \"PRF1\" | geneID == \"APOBEC3A\" | geneID == \"UNC13A\"\n    ) |>\n    select(geneID, healthy.AVG, disease.AVG, LogFC) |>\n    arrange(desc(LogFC))\nmydata_filter\n## # A tibble: 9 × 4\n##   geneID   healthy.AVG disease.AVG LogFC\n##   <chr>          <dbl>       <dbl> <dbl>\n## 1 MMP1            1.44       11.9  10.4 \n## 2 IFNG           -3.65        4.42  8.07\n## 3 CCL4           -1.75        6.14  7.89\n## 4 GZMB           -0.58        6.47  7.05\n## 5 GNLY            0.98        7.17  6.19\n## 6 IL1B            0.63        6.48  5.85\n## 7 PRF1            1.03        6.64  5.61\n## 8 APOBEC3A        0.27        5.6   5.33\n## 9 UNC13A         -0.78        1.95  2.73\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n### Produce publication-quality tables using `gt` package\nmydata_filter |>\n    gt() |>\n    fmt_number(columns = 2:4, decimals = 1) |>\n    tab_header(\n        title = md(\"**Regulators of skin pathogenesis**\"),\n        subtitle = md(\"*during cutaneous leishmaniasis*\")\n    ) |>\n    tab_footnote(\n        footnote = \"Deletion or blockaid ameliorates disease in mice\",\n        locations = cells_body(columns = geneID, rows = c(6, 7))\n    ) |>\n    tab_footnote(\n        footnote = \"Associated with treatment failure in multiple studies\",\n        locations = cells_body(columns = geneID, rows = c(2:9))\n    ) |>\n    tab_footnote(\n        footnote = \"Implicated in parasite control\",\n        locations = cells_body(columns = geneID, rows = c(2))\n    ) |>\n    tab_source_note(\n        source_note = md(\"Reference: Amorim *et al*., (2019). DOI: 10.1126/scitranslmed.aar3619\")\n    )\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"tnkgqhfvwx\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#tnkgqhfvwx table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#tnkgqhfvwx thead, #tnkgqhfvwx tbody, #tnkgqhfvwx tfoot, #tnkgqhfvwx tr, #tnkgqhfvwx td, #tnkgqhfvwx th {\n  border-style: none;\n}\n\n#tnkgqhfvwx p {\n  margin: 0;\n  padding: 0;\n}\n\n#tnkgqhfvwx .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#tnkgqhfvwx .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#tnkgqhfvwx .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#tnkgqhfvwx .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#tnkgqhfvwx .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#tnkgqhfvwx .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tnkgqhfvwx .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#tnkgqhfvwx .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#tnkgqhfvwx .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#tnkgqhfvwx .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#tnkgqhfvwx .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#tnkgqhfvwx .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#tnkgqhfvwx .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#tnkgqhfvwx .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#tnkgqhfvwx .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#tnkgqhfvwx .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#tnkgqhfvwx .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#tnkgqhfvwx .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#tnkgqhfvwx .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tnkgqhfvwx .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#tnkgqhfvwx .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#tnkgqhfvwx .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#tnkgqhfvwx .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tnkgqhfvwx .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#tnkgqhfvwx .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#tnkgqhfvwx .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tnkgqhfvwx .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tnkgqhfvwx .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#tnkgqhfvwx .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tnkgqhfvwx .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#tnkgqhfvwx .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#tnkgqhfvwx .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#tnkgqhfvwx .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tnkgqhfvwx .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#tnkgqhfvwx .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#tnkgqhfvwx .gt_left {\n  text-align: left;\n}\n\n#tnkgqhfvwx .gt_center {\n  text-align: center;\n}\n\n#tnkgqhfvwx .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#tnkgqhfvwx .gt_font_normal {\n  font-weight: normal;\n}\n\n#tnkgqhfvwx .gt_font_bold {\n  font-weight: bold;\n}\n\n#tnkgqhfvwx .gt_font_italic {\n  font-style: italic;\n}\n\n#tnkgqhfvwx .gt_super {\n  font-size: 65%;\n}\n\n#tnkgqhfvwx .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#tnkgqhfvwx .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#tnkgqhfvwx .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#tnkgqhfvwx .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#tnkgqhfvwx .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#tnkgqhfvwx .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#tnkgqhfvwx .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"4\" class=\"gt_heading gt_title gt_font_normal\" style><strong>Regulators of skin pathogenesis</strong></td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"4\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style><em>during cutaneous leishmaniasis</em></td>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"geneID\">geneID</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"healthy.AVG\">healthy.AVG</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"disease.AVG\">disease.AVG</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"LogFC\">LogFC</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"geneID\" class=\"gt_row gt_left\">MMP1</td>\n<td headers=\"healthy.AVG\" class=\"gt_row gt_right\">1.4</td>\n<td headers=\"disease.AVG\" class=\"gt_row gt_right\">11.9</td>\n<td headers=\"LogFC\" class=\"gt_row gt_right\">10.4</td></tr>\n    <tr><td headers=\"geneID\" class=\"gt_row gt_left\">IFNG<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1,2</sup></span></td>\n<td headers=\"healthy.AVG\" class=\"gt_row gt_right\">−3.6</td>\n<td headers=\"disease.AVG\" class=\"gt_row gt_right\">4.4</td>\n<td headers=\"LogFC\" class=\"gt_row gt_right\">8.1</td></tr>\n    <tr><td headers=\"geneID\" class=\"gt_row gt_left\">CCL4<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></td>\n<td headers=\"healthy.AVG\" class=\"gt_row gt_right\">−1.8</td>\n<td headers=\"disease.AVG\" class=\"gt_row gt_right\">6.1</td>\n<td headers=\"LogFC\" class=\"gt_row gt_right\">7.9</td></tr>\n    <tr><td headers=\"geneID\" class=\"gt_row gt_left\">GZMB<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></td>\n<td headers=\"healthy.AVG\" class=\"gt_row gt_right\">−0.6</td>\n<td headers=\"disease.AVG\" class=\"gt_row gt_right\">6.5</td>\n<td headers=\"LogFC\" class=\"gt_row gt_right\">7.0</td></tr>\n    <tr><td headers=\"geneID\" class=\"gt_row gt_left\">GNLY<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></td>\n<td headers=\"healthy.AVG\" class=\"gt_row gt_right\">1.0</td>\n<td headers=\"disease.AVG\" class=\"gt_row gt_right\">7.2</td>\n<td headers=\"LogFC\" class=\"gt_row gt_right\">6.2</td></tr>\n    <tr><td headers=\"geneID\" class=\"gt_row gt_left\">IL1B<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>3,1</sup></span></td>\n<td headers=\"healthy.AVG\" class=\"gt_row gt_right\">0.6</td>\n<td headers=\"disease.AVG\" class=\"gt_row gt_right\">6.5</td>\n<td headers=\"LogFC\" class=\"gt_row gt_right\">5.8</td></tr>\n    <tr><td headers=\"geneID\" class=\"gt_row gt_left\">PRF1<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>3,1</sup></span></td>\n<td headers=\"healthy.AVG\" class=\"gt_row gt_right\">1.0</td>\n<td headers=\"disease.AVG\" class=\"gt_row gt_right\">6.6</td>\n<td headers=\"LogFC\" class=\"gt_row gt_right\">5.6</td></tr>\n    <tr><td headers=\"geneID\" class=\"gt_row gt_left\">APOBEC3A<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></td>\n<td headers=\"healthy.AVG\" class=\"gt_row gt_right\">0.3</td>\n<td headers=\"disease.AVG\" class=\"gt_row gt_right\">5.6</td>\n<td headers=\"LogFC\" class=\"gt_row gt_right\">5.3</td></tr>\n    <tr><td headers=\"geneID\" class=\"gt_row gt_left\">UNC13A<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></td>\n<td headers=\"healthy.AVG\" class=\"gt_row gt_right\">−0.8</td>\n<td headers=\"disease.AVG\" class=\"gt_row gt_right\">1.9</td>\n<td headers=\"LogFC\" class=\"gt_row gt_right\">2.7</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"4\">Reference: Amorim <em>et al</em>., (2019). DOI: 10.1126/scitranslmed.aar3619</td>\n    </tr>\n  </tfoot>\n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"4\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span> Associated with treatment failure in multiple studies</td>\n    </tr>\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"4\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>2</sup></span> Implicated in parasite control</td>\n    </tr>\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"4\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>3</sup></span> Deletion or blockaid ameliorates disease in mice</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n:::\n:::\n\n\n- Make an interactive table using the `DT` package\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# datatable(\n#     mydata_df[, c(1, 12:14)],\n#     extensions = c('KeyTable', \"FixedHeader\"),\n#     filter = 'top',\n#     options = list(keys = TRUE,\n#         searchHighlight = TRUE,\n#         pageLength = 10,\n#         # dom = \"Blfrtip\",\n#         # buttons = c(\"copy\", \"csv\", \"excel\"),\n#         lengthMenu = c(\"10\", \"25\", \"50\", \"100\"))\n# )\n```\n:::\n\n\n- Make an interactive scatter plot with `plotly`\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmyplot <- ggplot(mydata_df) +\n  aes(x=healthy.AVG, y=disease.AVG, \n      text = paste(\"Symbol:\", geneID)) +\n  geom_point(shape=16, size=1) +\n  ggtitle(\"disease vs. healthy\") +\n  theme_bw()\n\nmyplot\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-17-1.png){fig-align='center' width=100%}\n:::\n\n```{.r .cell-code}\n# ggplotly(myplot)\n```\n:::\n\n\n## Step6: Differential gene expression\n\n### Set up design matrix\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ngroup <- factor(targets$group)\ndesign <- model.matrix(~0 + group)\ncolnames(design) <- levels(group)\n\n# NOTE: if you need a paired analysis (a.k.a.'blocking' design) or have a batch effect, the following design is useful\n# design <- model.matrix(~block + treatment)\n# this is just an example. 'block' and 'treatment' would need to be objects in your environment\n```\n:::\n\n\n### Model mean-variance trend and fit linear model to data\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n### Use VOOM function from Limma package to model the mean-variance relationship\nhead(DGEList_filtered_norm)\n## An object of class \"DGEList\"\n## $counts\n##            Sample1     Sample2     Sample3    Sample4     Sample5     Sample6\n## A1BG     184.19070   245.13169   101.73418   79.20480  13.3334957   682.72256\n## A2M    11901.13136 31538.08430 19870.31859 7832.90097 667.1460374 40967.58721\n## A2ML1  15162.86062 14045.04908 11463.06052 3627.33515 498.4617540 11767.57706\n## A2MP1     29.31478    51.91491    46.89141    8.37674   0.8615391    57.27197\n## A4GALT   128.32345   355.39448   131.42493   75.43359  30.6454026   112.79123\n## AAAS     269.07806   457.62142   257.49394  147.56154  27.9749726   636.62246\n##            Sample7     Sample8    Sample9   Sample10\n## A1BG     391.58119   326.10430   397.9777   499.9653\n## A2M    35158.38935 21982.61779 27205.9576 53686.2052\n## A2ML1    454.12997   631.23251   277.9864  3685.3769\n## A2MP1    106.33010    89.04506   103.1984   147.3506\n## A4GALT    87.64872    88.03357    62.6173   230.0622\n## AAAS     382.02897   412.70476   446.8081   509.4904\n## \n## $samples\n##          group lib.size norm.factors\n## Sample1      1 42300696    0.9838341\n## Sample2      1 51775632    1.0056785\n## Sample3      1 40485664    1.1055948\n## Sample4      1 16661634    1.0332639\n## Sample5      1  2191577    1.0154852\n## Sample6      1 55389922    0.8810033\n## Sample7      1 28800520    1.0117840\n## Sample8      1 31632164    1.0093077\n## Sample9      1 39464569    0.9639270\n## Sample10     1 67827185    1.0046274\nv_DEGList_filtered_norm <- voom(DGEList_filtered_norm, design, plot = TRUE)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-19-1.png){fig-align='center' width=100%}\n:::\n\n```{.r .cell-code}\n\n# fit a linear model to your data\nfit <- lmFit(v_DEGList_filtered_norm, design)\n\n### contrast matrix\ncontrast_matrix <- makeContrasts(infection = disease - healthy,\n                                 levels=design)\n### extract the linear model fit\nfits <- contrasts.fit(fit, contrast_matrix)\n\n### get bayesian stats for the linear model fit\nebFit <- eBayes(fits)\n\n#write.fit(ebFit, file=\"lmfit_results.txt\")\n\n### top table to view DEGs\nTopHits <- topTable(ebFit, adjust =\"BH\", coef=1, number=40000, sort.by=\"logFC\")\n\n### convert to a tibble\nTopHits_df <- TopHits |>\n  as_tibble(rownames = \"geneID\")\n\nTopHits_df\n## # A tibble: 15,765 × 7\n##    geneID    logFC AveExpr     t      P.Value  adj.P.Val     B\n##    <chr>     <dbl>   <dbl> <dbl>        <dbl>      <dbl> <dbl>\n##  1 MMP1      10.8    6.65  13.4  0.0000000182 0.00000123 10.0 \n##  2 IGLC3     10.3    3.49   7.50 0.00000815   0.0000778   4.06\n##  3 IGKV1D-33 10.2    1.12   9.29 0.000000913  0.0000160   6.11\n##  4 IGKV2D-28 10.1    0.898  9.50 0.000000723  0.0000137   6.32\n##  5 IGLV3-25  10.0    0.242  6.89 0.0000186    0.000147    3.27\n##  6 IGLV3-1   10.0    1.75  11.8  0.0000000715 0.00000281  8.36\n##  7 IGKV1-5    9.93   3.36  13.8  0.0000000124 0.00000101 10.0 \n##  8 IGHV1-3    9.89   0.447  6.24 0.0000468    0.000302    2.37\n##  9 IGLV3-19   9.84   2.18   6.93 0.0000175    0.000140    3.33\n## 10 IGHV3-21   9.80   1.42   9.00 0.00000128   0.0000200   5.80\n## # ℹ 15,755 more rows\n```\n:::\n\n\n::: {.callout-note}\n## Limma outputs\n- TopTable (from Limma) outputs a few different stats:\n- logFC, AveExpr, and P.Value should be self-explanatory\n- adj.P.Val is your adjusted P value, also known as an FDR (if BH method was used for multiple testing correction)\n- B statistic is the log-odds that that gene is differentially expressed. If B = 1.5, then log odds is e^1.5, where e is euler's constant (approx. 2.718).  So, the odds of differential expression os about 4.8 to 1\n- t statistic is ratio of the logFC to the standard error (where the error has been moderated across all genes...because of Bayesian approach)\n:::\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n### volcano plot\nvplot <- TopHits_df |>\n    ggplot(\n        aes(y = -log10(adj.P.Val), x = logFC, text = paste(\"Symbol:\", geneID))\n    ) +\n    geom_point(size = 2) +\n    geom_hline(yintercept = -log10(0.01), linetype = \"longdash\", colour = \"grey\", linewidth = 1) +\n    geom_vline(xintercept = 1, linetype = \"longdash\", colour = \"#BE684D\", linewidth = 1) +\n    geom_vline(xintercept = -1, linetype = \"longdash\", colour = \"#2C467A\", linewidth = 1) +\n    # annotate(\"rect\", xmin = 1, xmax = 12, ymin = -log10(0.01), ymax = 7.5, alpha=.2, fill=\"#BE684D\") +\n    # annotate(\"rect\", xmin = -1, xmax = -12, ymin = -log10(0.01), ymax = 7.5, alpha=.2, fill=\"#2C467A\") +\n    labs(title = \"Volcano plot\",\n        subtitle = \"Cutaneous leishmaniasis\",\n        caption = paste0(\"produced on \", Sys.time())) +\n    theme_bw()\n\nvplot\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-20-1.png){fig-align='center' width=100%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n### pull out DEGs and make venn diagram\nresults <- decideTests(\n    ebFit, method = \"global\", adjust.method = \"BH\", p.value = 0.01, lfc = 2\n)\nhead(results)\n## TestResults matrix\n##         Contrasts\n##          infection\n##   A1BG           0\n##   A2M            0\n##   A2ML1         -1\n##   A2MP1          0\n##   A4GALT         0\n##   AAAS           0\nsummary(results)\n##        infection\n## Down        1012\n## NotSig     13446\n## Up          1307\nvennDiagram(results, include=\"up\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-21-1.png){fig-align='center' width=100%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n### retrieve expression data for DEGs\nhead(v_DEGList_filtered_norm$E)\n##           Sample1     Sample2    Sample3    Sample4    Sample5   Sample6\n## A1BG    2.1498709 2.237982296 1.19157184  2.2109278  2.6359548 3.8074408\n## A2M     8.1597752 9.242459704 8.79420169  8.8297563  8.2288005 9.7134419\n## A2ML1   8.5092054 8.075454826 8.00060559  7.7192264  7.8086463 7.9138199\n## A2MP1  -0.4811408 0.009534871 0.08239155 -0.9556369 -0.7089007 0.2435267\n## A4GALT  1.6301549 2.772935178 1.55941146  2.1409994  3.8068082 1.2151214\n## AAAS    2.6954627 3.137215647 2.52703139  3.1043863  3.6774835 3.7066558\n##          Sample7  Sample8   Sample9 Sample10\n## A1BG    3.750084 3.354713 3.3888732 2.876674\n## A2M    10.236678 9.427422 9.4821796 9.621825\n## A2ML1   3.963625 4.306483 2.8719810 5.757340\n## A2MP1   1.874250 1.487855 1.4467684 1.117544\n## A4GALT  1.596943 1.471466 0.7304817 1.758560\n## AAAS    3.714501 3.694027 3.5556433 2.903874\ncolnames(v_DEGList_filtered_norm$E) <- sampleLabels\n\ndiffGenes <- v_DEGList_filtered_norm$E[results[,1] !=0,]\nhead(diffGenes)\n##             HS01     HS02     HS03     HS04     HS05     CL08       CL10\n## A2ML1   8.509205 8.075455 8.000606 7.719226 7.808646 7.913820  3.9636246\n## AADAC   3.783598 3.145125 3.421001 3.846583 4.124090 2.241617 -3.5057299\n## AADACL2 6.884775 7.025967 6.096531 6.700546 6.104662 5.215819 -5.8649243\n## AARD    2.817882 1.719728 2.562007 2.090062 2.784928 1.028134  0.2785801\n## ABCA10  4.429922 4.330043 6.261231 3.871370 2.785400 2.261820  2.9336235\n## ABCA12  8.609129 7.810834 7.884251 7.603805 7.963791 7.338358  3.3247149\n##              CL11       CL12       CL13\n## A2ML1   4.3064835  2.8719810  5.7573398\n## AADAC   0.1777154 -0.9997370 -0.5843452\n## AADACL2 2.9288016  2.0251967  3.5424241\n## AARD    0.2142361 -0.4255113  0.1288021\n## ABCA10  2.4838643  2.4430992  0.6882190\n## ABCA12  5.2844659  4.7055495  6.6999992\ndim(diffGenes)\n## [1] 2319   10\n\n#convert DEGs to a dataframe using as_tibble\ndiffGenes_df <- as_tibble(diffGenes, rownames = \"geneID\")\n\n### create interactive tables to display DEGs\n# datatable(diffGenes_df,\n#           extensions = c('KeyTable', \"FixedHeader\"),\n#           caption = 'Table 1: DEGs in cutaneous leishmaniasis',\n#           options = list(keys = TRUE, searchHighlight = TRUE, pageLength = 10, lengthMenu = c(\"10\", \"25\", \"50\", \"100\"))) |>\n#   formatRound(columns=c(2:11), digits=2)\n\n### write DEGs to a file\n# write_tsv(diffGenes_df, \"DiffGenes.txt\") \n#NOTE: this .txt file can be directly used for input into other clustering or network analysis tools (e.g., String, Clust (https://github.com/BaselAbujamous/clust, etc.)\n```\n:::\n\n\n## Step7: Module identification\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nheatcolors <- rev(brewer.pal(name=\"RdBu\", n=11))\n\n#cluster rows by pearson correlation\nclustRows <- hclust(\n  as.dist(1-cor(t(diffGenes), method=\"pearson\")), \n  method=\"complete\"\n)\n#cluster columns by pearson correlation\nclustColumns <- hclust(\n  as.dist(1-cor(diffGenes, method=\"spearman\")), \n  method=\"complete\"\n  )\n\nmodule_assign <- cutree(clustRows, k=2)\n\nmodule_color <- rainbow(length(unique(module_assign)), start=0.1, end=0.9) \n\nmodule_color <- module_color[as.vector(module_assign)] \n\nheatmap.2(\n    diffGenes,\n    Rowv = as.dendrogram(clustRows),\n    Colv = as.dendrogram(clustColumns),\n    RowSideColors = module_color,\n    col = heatcolors, scale = 'row', labRow = NA,\n    density.info = \"none\", trace = \"none\",\n    cexRow = 1, cexCol = 1, margins = c(8, 20)\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-23-1.png){fig-align='center' width=100%}\n:::\n\n```{.r .cell-code}\n\nmodulePick <- 2 \nModule_up <- diffGenes[names(module_assign[module_assign %in% modulePick]),] \nhrsub_up <- hclust(\n    as.dist(1 - cor(t(Module_up), method = \"pearson\")),\n    method = \"complete\"\n)\n\nheatmap.2(\n    Module_up, \n    Rowv=as.dendrogram(hrsub_up), \n    Colv=NA, \n    labRow = NA,\n    col=heatcolors, scale=\"row\", \n    density.info=\"none\", trace=\"none\", \n    RowSideColors=module_color[module_assign%in%modulePick], margins=c(8,20)\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-23-2.png){fig-align='center' width=100%}\n:::\n\n```{.r .cell-code}\n\nmodulePick <- 1 \nModule_down <- diffGenes[names(module_assign[module_assign %in% modulePick]),] \nhrsub_down <- hclust(\n    as.dist(1 - cor(t(Module_down), method = \"pearson\")),\n    method = \"complete\"\n)\n\nheatmap.2(Module_down, \n          Rowv=as.dendrogram(hrsub_down), \n          Colv=NA, \n          labRow = NA,\n          col=heatcolors, scale=\"row\", \n          density.info=\"none\", trace=\"none\", \n          RowSideColors=module_color[module_assign%in%modulePick], margins=c(8,20))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-23-3.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Step8: Functional enrichment analysis\n\n### Go enrichment analysis\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n### carry out GO enrichment using gProfiler2\n#### use topTable result to pick the top genes for carrying out a Gene Ontology (GO) enrichment analysis\nmyTopHits <- topTable(\n    ebFit,\n    adjust = \"BH\",\n    coef = 1,\n    number = 50,\n    sort.by = \"logFC\"\n)\n\n### use the 'gost' function from the gprofiler2 package to run GO enrichment analysis\ngost_res <- gost(\n    rownames(myTopHits),\n    organism = \"hsapiens\",\n    correction_method = \"fdr\"\n)\n\n### produce an interactive manhattan plot of enriched GO terms\ngostplot(gost_res, interactive = TRUE, capped = T) \n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"plotly html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-187586c3ca490039ef84\" style=\"width:100%;height:480px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-187586c3ca490039ef84\">{\"x\":{\"data\":[{\"x\":[155.31927977489644,151.91524195481168,155.3171388706071],\"y\":[2.6262762222965401,2.6262762222965401,2.4046201641637848],\"text\":[\"CORUM:6821 (2) <br> TTR-RBP complex <br> 2.364e-03\",\"CORUM:1703 (1) <br> IGHM-VPREB1-IGLL1 complex <br> 2.364e-03\",\"CORUM:6820 (5) <br> APOL1 complex B (APOL1, APOA1, HPR, FN1, IGHM) <br> 3.939e-03\"],\"key\":[\"CORUM:6821\",\"CORUM:1703\",\"CORUM:6820\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(102,170,0,1)\",\"opacity\":0.80000000000000004,\"size\":[8.9679083027707129,3.7795275590551185,11.685516855496353],\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(102,170,0,1)\"}},\"hoveron\":\"points\",\"set\":\"SharedData623faa89\",\"name\":\"CORUM\",\"legendgroup\":\"CORUM\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"_isNestedKey\":false,\"frame\":null},{\"x\":[40.705042417465691,44.625976580097401,40.970433157731165,68.973436751548391,68.892107331144473,52.495668128130561],\"y\":[17,17,17,11.718899065595979,2.5354130387224485,1.599332363568277],\"text\":[\"GO:0002250 (718) <br> adaptive immune response <br> 2.046e-43\",\"GO:0006955 (1951) <br> immune response <br> 1.928e-33\",\"GO:0002376 (2730) <br> immune system process <br> 8.766e-30\",\"GO:0050896 (8955) <br> response to stimulus <br> 1.910e-12\",\"GO:0050853 (70) <br> B cell receptor signaling pathway <br> 2.915e-03\",\"GO:0019730 (127) <br> antimicrobial humoral response <br> 2.516e-02\"],\"key\":[\"GO:0002250\",\"GO:0006955\",\"GO:0002376\",\"GO:0050896\",\"GO:0050853\",\"GO:0019730\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(255,153,0,1)\",\"opacity\":0.80000000000000004,\"size\":[19.760953100387198,20.932598402907679,21.308796689486559,22.578712678924681,16.624603506234173,17.495593428699955],\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(255,153,0,1)\"}},\"hoveron\":\"points\",\"set\":\"SharedData623faa89\",\"name\":\"GO:BP\",\"legendgroup\":\"GO:BP\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"_isNestedKey\":false,\"frame\":null},{\"x\":[29.936074977920477,28.608841973088278,34.221753164491531,34.176798498198835,29.092639810333562,28.68162571851456,29.589281837948192,35.024515062575531,29.604266726712428,29.730567932010974,33.371895901719952,33.329081933822138,32.222340863663682,31.059941635238062,36.075597974466831,34.129703133511242,34.091170562403207,34.136125228695917,34.131843831906124,32.027537309728629,34.112577546352114,30.820183415010312,34.138265927090799,34.097592657587882,34.106155451167439,34.118999641536789,34.125421736721449,34.11471824474701,34.121140339931671],\"y\":[17,17,17,17,17,17,17,13.524418818442603,12.108036873239982,10.096786498495034,7.4580961601000864,7.4580961601000864,7.4580961601000864,7.4580961601000864,7.4580961601000864,6.8159446966590576,6.4449386478270601,4.2945557783861537,4.2945557783861537,3.6407037117615433,3.6407037117615433,3.4525663106858997,2.1618761887207678,2.1618761887207678,1.8789978799541966,1.5958466894761949,1.5467838723111729,1.5467838723111729,1.5467838723111729],\"text\":[\"GO:0019814 (149) <br> immunoglobulin complex <br> 1.009e-70\",\"GO:0005576 (4206) <br> extracellular region <br> 6.987e-31\",\"GO:0072562 (136) <br> blood microparticle <br> 1.710e-21\",\"GO:0071944 (6202) <br> cell periphery <br> 6.350e-20\",\"GO:0005886 (5717) <br> plasma membrane <br> 2.115e-18\",\"GO:0005615 (3284) <br> extracellular space <br> 8.161e-18\",\"GO:0009897 (427) <br> external side of plasma membrane <br> 2.701e-17\",\"GO:0098552 (656) <br> side of membrane <br> 2.989e-14\",\"GO:0009986 (955) <br> cell surface <br> 7.798e-13\",\"GO:0016020 (9853) <br> membrane <br> 8.002e-11\",\"GO:0070062 (2109) <br> extracellular exosome <br> 3.483e-08\",\"GO:0065010 (2134) <br> extracellular membrane-bounded organelle <br> 3.483e-08\",\"GO:0043230 (2134) <br> extracellular organelle <br> 3.483e-08\",\"GO:0032991 (8527) <br> protein-containing complex <br> 3.483e-08\",\"GO:1903561 (2133) <br> extracellular vesicle <br> 3.483e-08\",\"GO:0071753 (4) <br> IgM immunoglobulin complex <br> 1.528e-07\",\"GO:0071735 (5) <br> IgG immunoglobulin complex <br> 3.590e-07\",\"GO:0071756 (3) <br> pentameric IgM immunoglobulin complex <br> 5.075e-05\",\"GO:0071754 (3) <br> IgM immunoglobulin complex, circulating <br> 5.075e-05\",\"GO:0042571 (6) <br> immunoglobulin complex, circulating <br> 2.287e-04\",\"GO:0071745 (6) <br> IgA immunoglobulin complex <br> 2.287e-04\",\"GO:0031982 (3976) <br> vesicle <br> 3.527e-04\",\"GO:0071757 (1) <br> hexameric IgM immunoglobulin complex <br> 6.888e-03\",\"GO:0071738 (1) <br> IgD immunoglobulin complex <br> 6.888e-03\",\"GO:0071742 (2) <br> IgE immunoglobulin complex <br> 1.321e-02\",\"GO:0071748 (4) <br> monomeric IgA immunoglobulin complex <br> 2.536e-02\",\"GO:0071751 (5) <br> secretory IgA immunoglobulin complex <br> 2.839e-02\",\"GO:0071746 (5) <br> IgA immunoglobulin complex, circulating <br> 2.839e-02\",\"GO:0071749 (5) <br> polymeric IgA immunoglobulin complex <br> 2.839e-02\"],\"key\":[\"GO:0019814\",\"GO:0005576\",\"GO:0072562\",\"GO:0071944\",\"GO:0005886\",\"GO:0005615\",\"GO:0009897\",\"GO:0098552\",\"GO:0009986\",\"GO:0016020\",\"GO:0070062\",\"GO:0065010\",\"GO:0043230\",\"GO:0032991\",\"GO:1903561\",\"GO:0071753\",\"GO:0071735\",\"GO:0071756\",\"GO:0071754\",\"GO:0042571\",\"GO:0071745\",\"GO:0031982\",\"GO:0071757\",\"GO:0071738\",\"GO:0071742\",\"GO:0071748\",\"GO:0071751\",\"GO:0071746\",\"GO:0071749\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(16,150,24,1)\",\"opacity\":0.80000000000000004,\"size\":[17.719933765215238,21.781214866745234,17.59218484123225,22.195368953169552,22.109308347681086,21.512285374899808,19.116518170560521,19.650844469559107,20.103856236279107,22.677165354330711,21.020527996395611,21.033795239590564,21.033795239590564,22.528057466073552,21.033267735673274,11.117005973573116,11.685516855496353,10.311454741100846,10.311454741100846,12.121311987659505,12.121311987659505,21.720451562965863,3.7795275590551185,3.7795275590551185,8.9679083027707129,11.117005973573116,11.685516855496353,11.685516855496353,11.685516855496353],\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(16,150,24,1)\"}},\"hoveron\":\"points\",\"set\":\"SharedData623faa89\",\"name\":\"GO:CC\",\"legendgroup\":\"GO:CC\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"_isNestedKey\":false,\"frame\":null},{\"x\":[2.7833720675371505,17.650318464020884,13.320368484163904,15.099008342424485,5.253348477203466],\"y\":[17,3.0124337423067518,2.4506641412764192,2.1341913567288198,1.3409707333403511],\"text\":[\"GO:0003823 (115) <br> antigen binding <br> 1.567e-44\",\"GO:0048248 (5) <br> CXCR3 chemokine receptor binding <br> 9.718e-04\",\"GO:0034987 (11) <br> immunoglobulin receptor binding <br> 3.543e-03\",\"GO:0045236 (18) <br> CXCR chemokine receptor binding <br> 7.342e-03\",\"GO:0008009 (50) <br> chemokine activity <br> 4.561e-02\"],\"key\":[\"GO:0003823\",\"GO:0048248\",\"GO:0034987\",\"GO:0045236\",\"GO:0008009\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(220,57,18,1)\",\"opacity\":0.80000000000000004,\"size\":[17.354348527787963,11.685516855496353,13.429680893642971,14.374405574627291,16.105460718562572],\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(220,57,18,1)\"}},\"hoveron\":\"points\",\"set\":\"SharedData623faa89\",\"name\":\"GO:MF\",\"legendgroup\":\"GO:MF\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"_isNestedKey\":false,\"frame\":null},{\"x\":[100.73341931506239,100.9070815720401,100.88564178722804,100.73556329354361,100.73770727202481,101.15578307586],\"y\":[2.3683916268072629,2.2613324725606234,2.2613324725606234,2.2613324725606234,1.8222592992503441,1.7342700263050239],\"text\":[\"KEGG:04060 (293) <br> Cytokine-cytokine receptor interaction <br> 4.282e-03\",\"KEGG:04657 (91) <br> IL-17 signaling pathway <br> 5.479e-03\",\"KEGG:04620 (102) <br> Toll-like receptor signaling pathway <br> 5.479e-03\",\"KEGG:04061 (98) <br> Viral protein interaction with cytokine and cytokine receptor <br> 5.479e-03\",\"KEGG:04062 (190) <br> Chemokine signaling pathway <br> 1.506e-02\",\"KEGG:05171 (231) <br> Coronavirus disease - COVID-19 <br> 1.844e-02\"],\"key\":[\"KEGG:04060\",\"KEGG:04657\",\"KEGG:04620\",\"KEGG:04061\",\"KEGG:04062\",\"KEGG:05171\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(221,68,119,1)\",\"opacity\":0.80000000000000004,\"size\":[18.632038292976183,17.015283753483406,17.181653674821646,17.123564576575358,18.054511771768507,18.317875012744647],\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(221,68,119,1)\"}},\"hoveron\":\"points\",\"set\":\"SharedData623faa89\",\"name\":\"KEGG\",\"legendgroup\":\"KEGG\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"_isNestedKey\":false,\"frame\":null},{\"x\":[104.31755628925704,105.37734357291312,104.39463172806838,104.09489391046867,106.0046520054611,107.83519367723072,105.37948455732456,107.58683948550525,103.8615266096232,107.99362652367628,107.83305269281931,104.347530071017,105.38162554173599,106.24016029071799,107.04731141382578,107.66819689313945,105.37306160409028,105.37092061967886,103.85724464080033,106.23801930630657,105.46726491819305,104.00711354960019,107.18861638497994,104.22977592838855,108.29550532568742,105.37520258850171,107.04945239823721,106.23587832189516,105.94256345752973,105.46512393378161,107.84161663046501,105.83123226813555,105.96825527046683,108.95706950881819,103.79087412404611,108.95278753999533,106.0132159431068,105.075464770902,105.94042247311829,107.80307891105932,104.2661726633828],\"y\":[17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,2.2207478758153774,1.6034774000123493],\"text\":[\"REAC:R-HSA-173623 (61) <br> Classical antibody-mediated complement activation <br> 2.077e-53\",\"REAC:R-HSA-2029481 (67) <br> FCGR activation <br> 2.297e-52\",\"REAC:R-HSA-166786 (68) <br> Creation of C4 and C2 activators <br> 2.477e-52\",\"REAC:R-HSA-5690714 (60) <br> CD22 mediated BCR regulation <br> 2.982e-51\",\"REAC:R-HSA-166663 (76) <br> Initial triggering of complement <br> 5.195e-51\",\"REAC:R-HSA-2029485 (81) <br> Role of phospholipids in phagocytosis <br> 3.178e-50\",\"REAC:R-HSA-9664323 (93) <br> FCGR3A-mediated IL10 synthesis <br> 1.878e-48\",\"REAC:R-HSA-977606 (101) <br> Regulation of Complement cascade <br> 1.959e-47\",\"REAC:R-HSA-983695 (84) <br> Antigen activates B Cell Receptor (BCR) leading to generation of second messengers <br> 3.866e-47\",\"REAC:R-HSA-2168880 (69) <br> Scavenging of heme from plasma <br> 5.721e-47\",\"REAC:R-HSA-2730905 (69) <br> Role of LAT2/NTAL/LAB on calcium mobilization <br> 5.721e-47\",\"REAC:R-HSA-166658 (111) <br> Complement cascade <br> 2.137e-46\",\"REAC:R-HSA-9664422 (113) <br> FCGR3A-mediated phagocytosis <br> 2.889e-46\",\"REAC:R-HSA-9664417 (113) <br> Leishmania phagocytosis <br> 2.889e-46\",\"REAC:R-HSA-9664407 (113) <br> Parasite infection <br> 2.889e-46\",\"REAC:R-HSA-2029482 (116) <br> Regulation of actin dynamics for phagocytic cup formation <br> 5.832e-46\",\"REAC:R-HSA-2871796 (83) <br> FCERI mediated MAPK activation <br> 6.875e-45\",\"REAC:R-HSA-2871809 (83) <br> FCERI mediated Ca+2 mobilization <br> 6.875e-45\",\"REAC:R-HSA-9662851 (132) <br> Anti-inflammatory response favouring Leishmania parasite infection <br> 1.973e-44\",\"REAC:R-HSA-9664433 (132) <br> Leishmania parasite growth and survival <br> 1.973e-44\",\"REAC:R-HSA-2029480 (140) <br> Fcgamma receptor (FCGR) dependent phagocytosis <br> 1.014e-43\",\"REAC:R-HSA-2173782 (97) <br> Binding and Uptake of Ligands by Scavenger Receptors <br> 4.207e-43\",\"REAC:R-HSA-9679191 (150) <br> Potential therapeutics for SARS <br> 1.832e-40\",\"REAC:R-HSA-202733 (190) <br> Cell surface interactions at the vascular wall <br> 4.785e-40\",\"REAC:R-HSA-983705 (163) <br> Signaling by the B Cell Receptor (BCR) <br> 1.594e-39\",\"REAC:R-HSA-2871837 (136) <br> FCERI mediated NF-kB activation <br> 2.971e-39\",\"REAC:R-HSA-9824443 (215) <br> Parasitic Infection Pathways <br> 1.248e-38\",\"REAC:R-HSA-9658195 (215) <br> Leishmania infection <br> 1.248e-38\",\"REAC:R-HSA-198933 (181) <br> Immunoregulatory interactions between a Lymphoid and a non-Lymphoid cell <br> 4.296e-36\",\"REAC:R-HSA-2454202 (182) <br> Fc epsilon receptor (FCERI) signaling <br> 4.780e-36\",\"REAC:R-HSA-9679506 (459) <br> SARS-CoV Infections <br> 6.450e-28\",\"REAC:R-HSA-109582 (672) <br> Hemostasis <br> 1.775e-25\",\"REAC:R-HSA-5663205 (999) <br> Infectious disease <br> 1.245e-22\",\"REAC:R-HSA-9824446 (809) <br> Viral Infection Pathways <br> 8.361e-22\",\"REAC:R-HSA-1280218 (809) <br> Adaptive Immune System <br> 8.361e-22\",\"REAC:R-HSA-5653656 (718) <br> Vesicle-mediated transport <br> 1.707e-21\",\"REAC:R-HSA-168249 (1100) <br> Innate Immune System <br> 5.114e-20\",\"REAC:R-HSA-1643685 (1768) <br> Disease <br> 1.594e-17\",\"REAC:R-HSA-168256 (2051) <br> Immune System <br> 3.458e-17\",\"REAC:R-HSA-6809583 (1) <br> Retinoid metabolism disease events <br> 6.015e-03\",\"REAC:R-HSA-380108 (57) <br> Chemokine receptors bind chemokines <br> 2.492e-02\"],\"key\":[\"REAC:R-HSA-173623\",\"REAC:R-HSA-2029481\",\"REAC:R-HSA-166786\",\"REAC:R-HSA-5690714\",\"REAC:R-HSA-166663\",\"REAC:R-HSA-2029485\",\"REAC:R-HSA-9664323\",\"REAC:R-HSA-977606\",\"REAC:R-HSA-983695\",\"REAC:R-HSA-2168880\",\"REAC:R-HSA-2730905\",\"REAC:R-HSA-166658\",\"REAC:R-HSA-9664422\",\"REAC:R-HSA-9664417\",\"REAC:R-HSA-9664407\",\"REAC:R-HSA-2029482\",\"REAC:R-HSA-2871796\",\"REAC:R-HSA-2871809\",\"REAC:R-HSA-9662851\",\"REAC:R-HSA-9664433\",\"REAC:R-HSA-2029480\",\"REAC:R-HSA-2173782\",\"REAC:R-HSA-9679191\",\"REAC:R-HSA-202733\",\"REAC:R-HSA-983705\",\"REAC:R-HSA-2871837\",\"REAC:R-HSA-9824443\",\"REAC:R-HSA-9658195\",\"REAC:R-HSA-198933\",\"REAC:R-HSA-2454202\",\"REAC:R-HSA-9679506\",\"REAC:R-HSA-109582\",\"REAC:R-HSA-5663205\",\"REAC:R-HSA-9824446\",\"REAC:R-HSA-1280218\",\"REAC:R-HSA-5653656\",\"REAC:R-HSA-168249\",\"REAC:R-HSA-1643685\",\"REAC:R-HSA-168256\",\"REAC:R-HSA-6809583\",\"REAC:R-HSA-380108\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(51,102,204,1)\",\"opacity\":0.80000000000000004,\"size\":[16.414845775301554,16.558214613980976,16.580707444250166,16.389417683497474,16.748328670165268,16.843381923146577,17.047140132513317,17.167371200103453,16.897327557022052,16.602833306375246,16.602833306375246,17.30361286285148,17.32922894620004,17.32922894620004,17.32922894620004,17.366727849814772,16.879587308642606,16.879587308642606,17.550152874418341,17.550152874418341,17.632876281676548,17.108631019856755,17.729248020920775,18.054511771768507,17.844469050608055,17.59218484123225,18.221684151271067,18.221684151271067,17.98834742391934,17.995875078024451,19.207743110577862,19.680299899162929,20.157348803880588,19.905291932643788,19.905291932643788,19.760953100387198,20.271143076507045,20.820734342661488,20.98909146093353,3.7795275590551185,16.310181392258002],\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(51,102,204,1)\"}},\"hoveron\":\"points\",\"set\":\"SharedData623faa89\",\"name\":\"REAC\",\"legendgroup\":\"REAC\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"_isNestedKey\":false,\"frame\":null},{\"x\":[198.55152814351155,198.9393579468462,199.12148796498681,198.95649959561237,199.48146258907641,199.17719832347686,199.35718563552166,198.99935371752781,198.65652074220438,198.24512117181624,199.07863384307134,198.87079135178152,199.99142663987004,198.82793722986608,198.49796049111728,198.73794357384369,199.04220783944325,199.44503658544832,199.24362221244579,199.13005878936985,198.8343653481534,199.45146470373558,199.89500486556034,198.63509368124664,199.62288119139734,199.75144355714363,199.80072579734636,199.86072156802797,198.56866979227775,198.27083364496551],\"y\":[2.8078885861687253,2.5200441180456949,2.5200441180456949,2.1399595865885841,1.8953620494176195,1.8953620494176195,1.8953620494176195,1.6511579661900624,1.5147783179892784,1.5147783179892784,1.4465097057229968,1.4465097057229968,1.4465097057229968,1.4465097057229968,1.4459489421984575,1.4347264106025992,1.4347264106025992,1.4347264106025992,1.4347264106025992,1.4347264106025992,1.3772381076819589,1.3696142275167016,1.3503035023717875,1.3298331939424508,1.3298331939424508,1.3298331939424508,1.3298331939424508,1.3298331939424508,1.3298331939424508,1.3298331939424508],\"text\":[\"WP:WP5095 (127) <br> Overview of proinflammatory and profibrotic mediators <br> 1.556e-03\",\"WP:WP619 (37) <br> Type II interferon signaling <br> 3.020e-03\",\"WP:WP5088 (33) <br> Prostaglandin signaling <br> 3.020e-03\",\"WP:WP5039 (66) <br> SARS-CoV-2 innate immunity evasion and cell-specific immune response <br> 7.245e-03\",\"WP:WP2431 (116) <br> Spinal cord injury <br> 1.272e-02\",\"WP:WP75 (103) <br> Toll-like receptor signaling pathway <br> 1.272e-02\",\"WP:WP5322 (116) <br> CKAP4 signaling pathway map <br> 1.272e-02\",\"WP:WP3929 (165) <br> Chemokine signaling pathway <br> 2.233e-02\",\"WP:WP3934 (10) <br> Leptin and adiponectin <br> 3.056e-02\",\"WP:WP5115 (217) <br> Network map of SARS-CoV-2 signaling pathway <br> 3.056e-02\",\"WP:WP2435 (16) <br> Quercetin and Nf-kB / AP-1 induced apoptosis <br> 3.577e-02\",\"WP:WP5400 (14) <br> 6q16 copy number variation <br> 3.577e-02\",\"WP:WP4891 (15) <br> COVID-19 adverse outcome pathway <br> 3.577e-02\",\"WP:WP3935 (17) <br> Leptin-insulin signaling overlap <br> 3.577e-02\",\"WP:WP5413 (290) <br> IL-24 Signaling pathway <br> 3.581e-02\",\"WP:WP4483 (25) <br> Relationship between inflammation, COX-2 and EGFR <br> 3.675e-02\",\"WP:WP3599 (22) <br> Transcription factor regulation in adipogenesis <br> 3.675e-02\",\"WP:WP5284 (25) <br> Cell interactions of the pancreatic cancer microenvironment <br> 3.675e-02\",\"WP:WP2895 (25) <br> Differentiation of white and brown adipocyte <br> 3.675e-02\",\"WP:WP4537 (22) <br> Hippo-YAP signaling <br> 3.675e-02\",\"WP:WP129 (30) <br> Matrix metalloproteinases <br> 4.195e-02\",\"WP:WP5113 (32) <br> Antiviral and anti-inflammatory effects of Nrf2 on SARS-CoV-2 pathway <br> 4.270e-02\",\"WP:WP3617 (35) <br> Photodynamic therapy-induced NF-kB survival signaling <br> 4.464e-02\",\"WP:WP5283 (46) <br> Chronic hyperglycemia impairment of neuron function <br> 4.679e-02\",\"WP:WP5347 (45) <br> IL-26 signaling pathways <br> 4.679e-02\",\"WP:WP4559 (48) <br> Interactions between immune cells and microRNAs in tumor microenvironment <br> 4.679e-02\",\"WP:WP716 (42) <br> Vitamin A and carotenoid metabolism <br> 4.679e-02\",\"WP:WP4136 (43) <br> Fibrin complement receptor 3 signaling pathway <br> 4.679e-02\",\"WP:WP2828 (40) <br> Bladder cancer <br> 4.679e-02\",\"WP:WP1971 (48) <br> Integrated cancer pathway <br> 4.679e-02\"],\"key\":[\"WP:WP5095\",\"WP:WP619\",\"WP:WP5088\",\"WP:WP5039\",\"WP:WP2431\",\"WP:WP75\",\"WP:WP5322\",\"WP:WP3929\",\"WP:WP3934\",\"WP:WP5115\",\"WP:WP2435\",\"WP:WP5400\",\"WP:WP4891\",\"WP:WP3935\",\"WP:WP5413\",\"WP:WP4483\",\"WP:WP3599\",\"WP:WP5284\",\"WP:WP2895\",\"WP:WP4537\",\"WP:WP129\",\"WP:WP5113\",\"WP:WP3617\",\"WP:WP5283\",\"WP:WP5347\",\"WP:WP4559\",\"WP:WP716\",\"WP:WP4136\",\"WP:WP2828\",\"WP:WP1971\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,153,198,1)\",\"opacity\":0.80000000000000004,\"size\":[17.495593428699955,15.621605526743602,15.432489933172905,16.5353429714215,17.366727849814772,17.195781823273968,17.366727849814772,17.861295873015131,13.235951909580116,18.234128393371993,14.156289046486304,13.903326714182342,14.034806173846196,14.269123212349129,18.6185768464894,14.960284846058837,14.736021255617715,14.960284846058837,14.960284846058837,14.736021255617715,15.2725704202277,15.381099595154099,15.530131005135631,15.973394555191513,15.938343791671642,16.040981456476214,15.827655299285238,15.865520289428702,15.748761075898194,16.040981456476214],\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,153,198,1)\"}},\"hoveron\":\"points\",\"set\":\"SharedData623faa89\",\"name\":\"WP\",\"legendgroup\":\"WP\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"_isNestedKey\":false,\"frame\":null},{\"x\":[2,26.046954040382204],\"y\":[-1,-1],\"text\":\"\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":11.338582677165356,\"color\":\"rgba(220,57,18,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[28.187124389294823,36.863374983786585],\"y\":[-1,-1],\"text\":\"\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":11.338582677165356,\"color\":\"rgba(16,150,24,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[39.003545332699204,98.063686281291879],\"y\":[-1,-1],\"text\":\"\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":11.338582677165356,\"color\":\"rgba(255,153,0,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[100.2038566302045,101.4087725366423],\"y\":[-1,-1],\"text\":\"\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":11.338582677165356,\"color\":\"rgba(221,68,119,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[103.54894288555494,109.17759090319512],\"y\":[-1,-1],\"text\":\"\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":11.338582677165356,\"color\":\"rgba(51,102,204,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[111.31776125210774,136.24432530589303],\"y\":[-1,-1],\"text\":\"\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":11.338582677165356,\"color\":\"rgba(85,116,166,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[138.38449565480565,144.07734878291322],\"y\":[-1,-1],\"text\":\"\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":11.338582677165356,\"color\":\"rgba(34,170,153,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[146.21751913182584,148.05592546154176],\"y\":[-1,-1],\"text\":\"\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":11.338582677165356,\"color\":\"rgba(102,51,204,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[150.19609581045438,156.43897271823249],\"y\":[-1,-1],\"text\":\"\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":11.338582677165356,\"color\":\"rgba(102,170,0,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[158.57914306714511,196.05352587660511],\"y\":[-1,-1],\"text\":\"\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":11.338582677165356,\"color\":\"rgba(153,0,153,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[198.19369622551773,200.00214017034889],\"y\":[-1,-1],\"text\":\"\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":11.338582677165356,\"color\":\"rgba(0,153,198,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[180],\"y\":[16.199999999999999],\"text\":\"values above this threshold are capped\",\"hovertext\":\"\",\"textfont\":{\"size\":7.559055118110237,\"color\":\"rgba(190,190,190,1)\"},\"type\":\"scatter\",\"mode\":\"text\",\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[0,210],\"y\":[16,16],\"text\":\"\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":0.75590551181102372,\"color\":\"rgba(190,190,190,1)\",\"dash\":\"dash\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":29.283520132835207,\"r\":6.6417600664176026,\"b\":55.878166138820198,\"l\":61.037775010377771},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0,210],\"tickmode\":\"array\",\"ticktext\":[\"GO:MF\",\"GO:CC\",\"GO:BP\",\"KEGG\",\"REAC\",\"TF\",\"MIRNA\",\"HPA\",\"CORUM\",\"HP\",\"WP\"],\"tickvals\":[14.023477020191102,32.525249686540704,68.533615806995542,100.8063145834234,106.36326689437503,123.78104327900039,141.23092221885943,147.13672229668379,153.31753426434344,177.31633447187511,199.09791819793332],\"categoryorder\":\"array\",\"categoryarray\":[\"GO:MF\",\"GO:CC\",\"GO:BP\",\"KEGG\",\"REAC\",\"TF\",\"MIRNA\",\"HPA\",\"CORUM\",\"HP\",\"WP\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":10.62681610626816},\"tickangle\":-45,\"showline\":true,\"linecolor\":\"rgba(190,190,190,1)\",\"linewidth\":0.13283520132835203,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":\"\",\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-1,18.5],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"2\",\"4\",\"6\",\"8\",\"10\",\"12\",\"14\",\">16\"],\"tickvals\":[0,2,4,6,8,10,12,14,16],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"2\",\"4\",\"6\",\"8\",\"10\",\"12\",\"14\",\">16\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(190,190,190,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(190,190,190,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":\"\",\"hoverformat\":\".2f\"},\"annotations\":[{\"text\":\"-log10(p-adj)\",\"x\":0,\"y\":0.5,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":13.283520132835205},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-90,\"xanchor\":\"right\",\"yanchor\":\"center\",\"annotationType\":\"axis\",\"xshift\":-37.393109173931101},{\"text\":\"query_1\",\"x\":0.5,\"y\":1,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(169,169,169,1)\",\"family\":\"\",\"size\":13.283520132835205},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"bottom\"}],\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":24.973017849730184,\"yanchor\":1,\"ysizemode\":\"pixel\"}],\"showlegend\":false,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498}},\"hovermode\":\"closest\",\"barmode\":\"relative\",\"dragmode\":\"zoom\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"1658440d9d83e\":{\"x\":{},\"y\":{},\"text\":{},\"colour\":{},\"size\":{},\"alpha\":{},\"type\":\"scatter\"},\"165841e03efb5\":{\"x\":{},\"xend\":{},\"y\":{},\"yend\":{}},\"16584146e6378\":{\"x\":{},\"xend\":{},\"y\":{},\"yend\":{}},\"165845b4465c2\":{\"x\":{},\"xend\":{},\"y\":{},\"yend\":{}},\"165846774d25d\":{\"x\":{},\"xend\":{},\"y\":{},\"yend\":{}},\"16584269f0cbb\":{\"x\":{},\"xend\":{},\"y\":{},\"yend\":{}},\"1658413fcdccc\":{\"x\":{},\"xend\":{},\"y\":{},\"yend\":{}},\"165843e03df54\":{\"x\":{},\"xend\":{},\"y\":{},\"yend\":{}},\"16584703b239a\":{\"x\":{},\"xend\":{},\"y\":{},\"yend\":{}},\"165843a9e8d06\":{\"x\":{},\"xend\":{},\"y\":{},\"yend\":{}},\"165847f3ca2fa\":{\"x\":{},\"xend\":{},\"y\":{},\"yend\":{}},\"1658465f00c58\":{\"x\":{},\"xend\":{},\"y\":{},\"yend\":{}},\"1658472ba99b0\":{\"x\":{},\"y\":{}},\"1658438c02ca8\":{\"yintercept\":{}}},\"cur_data\":\"1658440d9d83e\",\"visdat\":{\"1658440d9d83e\":[\"function (y) \",\"x\"],\"165841e03efb5\":[\"function (y) \",\"x\"],\"16584146e6378\":[\"function (y) \",\"x\"],\"165845b4465c2\":[\"function (y) \",\"x\"],\"165846774d25d\":[\"function (y) \",\"x\"],\"16584269f0cbb\":[\"function (y) \",\"x\"],\"1658413fcdccc\":[\"function (y) \",\"x\"],\"165843e03df54\":[\"function (y) \",\"x\"],\"16584703b239a\":[\"function (y) \",\"x\"],\"165843a9e8d06\":[\"function (y) \",\"x\"],\"165847f3ca2fa\":[\"function (y) \",\"x\"],\"1658465f00c58\":[\"function (y) \",\"x\"],\"1658472ba99b0\":[\"function (y) \",\"x\"],\"1658438c02ca8\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"off\":\"plotly_doubleclick\",\"persistent\":false,\"dynamic\":false,\"color\":null,\"selectize\":false,\"defaultValues\":null,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0,\"ctGroups\":[\"SharedData623faa89\"]},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n\n```{.r .cell-code}\n\n### produce a publication quality static manhattan plot with specific GO terms highlighted\nmygostplot <- gostplot(\n  gost_res, \n  interactive = FALSE, \n  capped = TRUE #set interactive=FALSE to get plot for publications\n) \n\n### rerun the above gostplot function with 'interactive=F' and save to an object 'mygostplot'\npublish_gostplot(\n  mygostplot, #your static gostplot from above\n  highlight_terms = c(\"GO:0034987\"),\n  filename = NULL,\n  width = NA,\n  height = NA)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-24-2.png){fig-align='center' width=100%}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-24-3.png){fig-align='center' width=100%}\n:::\n\n```{.r .cell-code}\n\n### generate a table of  gost results\npublish_gosttable(\n  gost_res,\n  highlight_terms = NULL,\n  use_colors = TRUE,\n  show_columns = c(\"source\", \"term_name\", \"term_size\", \"intersection_size\"),\n  filename = NULL,\n  ggplot=TRUE)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-24-4.png){fig-align='center' width=100%}\n:::\n\n```{.r .cell-code}\n# now repeat the above steps using only genes from a single module from the step 6 script, by using `rownames(myModule)`\n# what is value in breaking up DEGs into modules for functional enrichment analysis?\n```\n:::\n\n### Perform GSEA using clusterProfiler\n\nThere are a few ways to get msigDB collections into R:\n\n- Option1: download directly from msigdb and load from your computer. can use the 'read.gmt' function from clusterProfiler package to create a dataframe. alternatively, you can read in using 'getGmt' function from GSEABase package if you need a GeneSetCollection object\n\n```R\nc2cp <- read.gmt(\"/Users/.../MSigDB/c2.cp.v7.1.symbols.gmt\")\n```\n- Option2: use the msigdb package to access up-to-date collections. this option has the additional advantage of providing access to species-specific collections are also retrieved as tibbles\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmsigdbr_species()\n## # A tibble: 20 × 2\n##    species_name                    species_common_name                          \n##    <chr>                           <chr>                                        \n##  1 Anolis carolinensis             Carolina anole, green anole                  \n##  2 Bos taurus                      bovine, cattle, cow, dairy cow, domestic cat…\n##  3 Caenorhabditis elegans          <NA>                                         \n##  4 Canis lupus familiaris          dog, dogs                                    \n##  5 Danio rerio                     leopard danio, zebra danio, zebra fish, zebr…\n##  6 Drosophila melanogaster         fruit fly                                    \n##  7 Equus caballus                  domestic horse, equine, horse                \n##  8 Felis catus                     cat, cats, domestic cat                      \n##  9 Gallus gallus                   bantam, chicken, chickens, Gallus domesticus \n## 10 Homo sapiens                    human                                        \n## 11 Macaca mulatta                  rhesus macaque, rhesus macaques, Rhesus monk…\n## 12 Monodelphis domestica           gray short-tailed opossum                    \n## 13 Mus musculus                    house mouse, mouse                           \n## 14 Ornithorhynchus anatinus        duck-billed platypus, duckbill platypus, pla…\n## 15 Pan troglodytes                 chimpanzee                                   \n## 16 Rattus norvegicus               brown rat, Norway rat, rat, rats             \n## 17 Saccharomyces cerevisiae        baker's yeast, brewer's yeast, S. cerevisiae \n## 18 Schizosaccharomyces pombe 972h- <NA>                                         \n## 19 Sus scrofa                      pig, pigs, swine, wild boar                  \n## 20 Xenopus tropicalis              tropical clawed frog, western clawed frog\n### Gets all collections/signatures with human gene IDs\nhs_gsea <- msigdbr(species = \"Homo sapiens\") \n\n### Take a look at the categories and subcategories of signatures available to you\nhs_gsea |> \n  distinct(gs_cat, gs_subcat) |> \n  arrange(gs_cat, gs_subcat)\n## # A tibble: 23 × 2\n##    gs_cat gs_subcat        \n##    <chr>  <chr>            \n##  1 C1     \"\"               \n##  2 C2     \"CGP\"            \n##  3 C2     \"CP\"             \n##  4 C2     \"CP:BIOCARTA\"    \n##  5 C2     \"CP:KEGG\"        \n##  6 C2     \"CP:PID\"         \n##  7 C2     \"CP:REACTOME\"    \n##  8 C2     \"CP:WIKIPATHWAYS\"\n##  9 C3     \"MIR:MIRDB\"      \n## 10 C3     \"MIR:MIR_Legacy\" \n## # ℹ 13 more rows\n\n### Choose a specific msigdb collection/subcollection\nhs_gsea_c2 <- msigdbr(\n  ### change depending on species your data came from\n  species = \"Homo sapiens\", \n  category = \"C2\"\n  ) |> \n  ###just get the columns corresponding to signature name and gene symbols of genes in each signature \n  select(gs_name, gene_symbol) \n\n### Pull out just the columns corresponding to gene symbols and LogFC for at least one pairwise comparison for the enrichment analysis\nmydata_df_sub <- select(mydata_df, geneID, LogFC)\n\n### Construct a named vector\nmydata_gsea <- mydata_df_sub$LogFC\nnames(mydata_gsea) <- as.character(mydata_df_sub$geneID)\nmydata_gsea <- sort(mydata_gsea, decreasing = TRUE)\n\n### Run GSEA using the 'GSEA' function from clusterProfiler\nmyGSEA_res <- GSEA(mydata_gsea, TERM2GENE=hs_gsea_c2, verbose=FALSE)\nmyGSEA_df <- as_tibble(myGSEA_res@result)\n\n### View results as an interactive table\n# datatable(\n#     myGSEA_df,\n#     extensions = c('KeyTable', \"FixedHeader\"),\n#     caption = 'Signatures enriched in leishmaniasis',\n#     options = list(\n#         keys = TRUE,\n#         searchHighlight = TRUE,\n#         pageLength = 10,\n#         lengthMenu = c(\"10\", \"25\", \"50\", \"100\")\n#     )\n# ) |>\n#     formatRound(columns = c(2:10), digits = 2)\n\n### Create enrichment plots using the enrichplot package\ngseaplot2(\n    myGSEA_res,\n    ### can choose multiple signatures to overlay in this plot\n    geneSetID = c(6, 47, 262), \n    ### can set this to FALSE for a cleaner plot\n    pvalue_table = FALSE, \n    ### can also turn off this title\n    title = myGSEA_res$Description[47]\n) \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-25-1.png){fig-align='center' width=100%}\n:::\n\n```{.r .cell-code}\n\n### Add a variable to this result that matches enrichment direction with phenotype\nmyGSEA_df <- myGSEA_df |>\n    mutate(\n        phenotype = case_when(\n            NES > 0 ~ \"disease\",\n            NES < 0 ~ \"healthy\"\n        )\n    )\n\n### Create 'bubble plot' to summarize y signatures across x phenotypes\nggplot(myGSEA_df[1:20,], aes(x=phenotype, y=ID)) + \n  geom_point(aes(size=setSize, color = NES, alpha=-log10(p.adjust))) +\n  scale_color_gradient(low=\"blue\", high=\"red\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-25-2.png){fig-align='center' width=100%}\n:::\n:::\n\n\n### Competitive GSEA using CAMERA\n\nFor competitive tests the null hypothesis is that genes in the set are, at most, as often differentially expressed as genes outside the set.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n### Create a few signatures to test in our enrichment analysis\n### if your own data is from mice, wrap this in 'toupper()' to make gene symbols all caps\nmySig <- rownames(myTopHits) \n\nmySig2 <- sample(\n  (rownames(v_DEGList_filtered_norm$E)), \n  size = 50, replace = FALSE\n  )\n\ncollection <- list(real = mySig, fake = mySig2)\n\n###Test for enrichment using CAMERA\ncamera_res <- camera(v_DEGList_filtered_norm$E, collection, design, contrast_matrix[,1]) \ncamera_df <- as_tibble(camera_res, rownames = \"setName\")\ncamera_df\n## # A tibble: 2 × 5\n##   setName NGenes Direction   PValue      FDR\n##   <chr>    <dbl> <chr>        <dbl>    <dbl>\n## 1 real        50 Up        5.85e-20 1.17e-19\n## 2 fake        50 Up        9.60e- 1 9.60e- 1\n```\n:::\n\n### Self-contained GSEA using ROAST\n\nFor self-contained the null hypothesis is that no genes in the set are differentially expressed.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmroast(\n  v_DEGList_filtered_norm$E, \n  collection, design, \n  #mroast adjusts for multiple testing\n  contrast=1\n  ) \n##      NGenes PropDown PropUp Direction PValue   FDR PValue.Mixed FDR.Mixed\n## fake     50     0.02   0.98        Up  5e-04 5e-04        5e-04     5e-04\n## real     50     0.06   0.94        Up  5e-04 5e-04        5e-04     5e-04\n\n### Repeat with an actual gene set collection\n### camera requires collections to be presented as a list, rather than a tibble, so we must read in our signatures using the 'getGmt' function\nbroadSet_C2_ALL <- getGmt(\n    \"data/230907_DIY_Transcriptomics/c2.all.v7.2.symbols.gmt\",\n    geneIdType = SymbolIdentifier()\n)\n\n### Extract as a list\nbroadSet_C2_ALL <- geneIds(broadSet_C2_ALL)\ncamera_res <- camera(\n    v_DEGList_filtered_norm$E,\n    broadSet_C2_ALL, design,\n    contrast_matrix[, 1]\n)\ncamera_df <- as_tibble(camera_res, rownames = \"setName\")\ncamera_df\n## # A tibble: 6,229 × 5\n##    setName                                    NGenes Direction   PValue      FDR\n##    <chr>                                       <dbl> <chr>        <dbl>    <dbl>\n##  1 MCLACHLAN_DENTAL_CARIES_UP                    245 Up        2.80e-33 1.74e-29\n##  2 POOLA_INVASIVE_BREAST_CANCER_UP               275 Up        2.59e-32 8.06e-29\n##  3 WIELAND_UP_BY_HBV_INFECTION                    99 Up        2.10e-31 4.36e-28\n##  4 REACTOME_IMMUNOREGULATORY_INTERACTIONS_BE…    158 Up        9.85e-31 1.53e-27\n##  5 REACTOME_FCGR_ACTIVATION                       62 Up        1.88e-29 2.34e-26\n##  6 REACTOME_CD22_MEDIATED_BCR_REGULATION          53 Up        2.62e-27 2.72e-24\n##  7 REACTOME_CREATION_OF_C4_AND_C2_ACTIVATORS      58 Up        1.70e-26 1.52e-23\n##  8 REACTOME_INITIAL_TRIGGERING_OF_COMPLEMENT      66 Up        2.81e-26 2.19e-23\n##  9 WALLACE_PROSTATE_CANCER_RACE_UP               277 Up        6.49e-26 4.49e-23\n## 10 FLECHNER_BIOPSY_KIDNEY_TRANSPLANT_REJECTE…     86 Up        4.32e-25 2.69e-22\n## # ℹ 6,219 more rows\n\n### Filter based on FDR and display as interactive table\ncamera_df <- filter(camera_df, FDR<=0.01)\n\n# datatable(\n#     camera_df,\n#     extensions = c('KeyTable', \"FixedHeader\"),\n#     caption = 'Signatures enriched in leishmaniasis',\n#     options = list(\n#         keys = TRUE,\n#         searchHighlight = TRUE,\n#         pageLength = 10,\n#         lengthMenu = c(\"10\", \"25\", \"50\", \"100\")\n#     )\n# ) |>\n#     formatRound(columns = c(2, 4, 5), digits = 2)\n\n### Add a variable that maps up/down regulated pathways with phenotype\ncamera_df <- camera_df |>\n    mutate(\n        phenotype = case_when(\n            Direction == \"Up\" ~ \"disease\",\n            Direction == \"Down\" ~ \"healthy\"\n        )\n    )\n\n### Filtering to return anything that has 'CD8' or 'CYTOTOX' in the name of the signature\ncamera_df_sub <- camera_df |>\n  filter(str_detect(setName, \"CD8|CYTOTOX\"))\n\n### Graph camera results as bubble chart \nggplot(camera_df[1:25,], aes(x=phenotype, y=setName)) + \n  geom_point(aes(size=NGenes, color = Direction, alpha=-log10(FDR))) +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-27-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n### Single sample GSEA using the GSVA package\n\nThe GSVA package offers a different way of approaching functional enrichment analysis.  \n\n- In contrast to most GSE methods, GSVA performs a change in coordinate systems,transforming the data from a gene by sample matrix to a gene set (signature) by sample matrix. This allows for the evaluation of pathway enrichment for each sample.\n- The method is both non-parametric and unsupervised bypasses the conventional approach of explicitly modeling phenotypes within enrichment scoring algorithms. \n- Focus is therefore placed on the RELATIVE enrichment of pathways across the sample space rather than the absolute enrichment with respect to a phenotype. However, with data with a moderate to small sample size (< 30), other GSE methods that explicitly include the phenotype in their model are more likely to provide greater statistical power to detect functional enrichment.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Be aware that if you choose a large MsigDB file here, this step may take a while\nGSVA_res_C2CP <- gsva(\n    v_DEGList_filtered_norm$E,\n    ### signatures\n    broadSet_C2_ALL,\n    ### criteria for filtering gene sets\n    min.sz = 5, max.sz = 500,\n    mx.diff = FALSE,\n    ### options for method are \"gsva\", ssgsea', \"zscore\" or \"plage\"\n    method = \"gsva\"\n)\n## Estimating GSVA scores for 5919 gene sets.\n## Estimating ECDFs with Gaussian kernels\n## \n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |                                                                      |   1%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |==                                                                    |   4%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |===                                                                   |   5%\n  |                                                                            \n  |====                                                                  |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |=====                                                                 |   8%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |=======                                                               |  11%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |=========                                                             |  14%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |==========                                                            |  15%\n  |                                                                            \n  |===========                                                           |  15%\n  |                                                                            \n  |===========                                                           |  16%\n  |                                                                            \n  |============                                                          |  16%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |============                                                          |  18%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |=============                                                         |  19%\n  |                                                                            \n  |==============                                                        |  19%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |==============                                                        |  21%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |================                                                      |  24%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |=================                                                     |  25%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |===================                                                   |  26%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |===================                                                   |  28%\n  |                                                                            \n  |====================                                                  |  28%\n  |                                                                            \n  |====================                                                  |  29%\n  |                                                                            \n  |=====================                                                 |  29%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |=====================                                                 |  31%\n  |                                                                            \n  |======================                                                |  31%\n  |                                                                            \n  |======================                                                |  32%\n  |                                                                            \n  |=======================                                               |  32%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |=======================                                               |  34%\n  |                                                                            \n  |========================                                              |  34%\n  |                                                                            \n  |========================                                              |  35%\n  |                                                                            \n  |=========================                                             |  35%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |==========================                                            |  36%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |==========================                                            |  38%\n  |                                                                            \n  |===========================                                           |  38%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |============================                                          |  39%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |============================                                          |  41%\n  |                                                                            \n  |=============================                                         |  41%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |==============================                                        |  42%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |==============================                                        |  44%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |===============================                                       |  45%\n  |                                                                            \n  |================================                                      |  45%\n  |                                                                            \n  |================================                                      |  46%\n  |                                                                            \n  |=================================                                     |  46%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |=================================                                     |  48%\n  |                                                                            \n  |==================================                                    |  48%\n  |                                                                            \n  |==================================                                    |  49%\n  |                                                                            \n  |===================================                                   |  49%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |===================================                                   |  51%\n  |                                                                            \n  |====================================                                  |  51%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |=====================================                                 |  52%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |=====================================                                 |  54%\n  |                                                                            \n  |======================================                                |  54%\n  |                                                                            \n  |======================================                                |  55%\n  |                                                                            \n  |=======================================                               |  55%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |========================================                              |  58%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |=========================================                             |  59%\n  |                                                                            \n  |==========================================                            |  59%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |==========================================                            |  61%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |===========================================                           |  62%\n  |                                                                            \n  |============================================                          |  62%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |============================================                          |  64%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |=============================================                         |  65%\n  |                                                                            \n  |==============================================                        |  65%\n  |                                                                            \n  |==============================================                        |  66%\n  |                                                                            \n  |===============================================                       |  66%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |===============================================                       |  68%\n  |                                                                            \n  |================================================                      |  68%\n  |                                                                            \n  |================================================                      |  69%\n  |                                                                            \n  |=================================================                     |  69%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |=================================================                     |  71%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |==================================================                    |  72%\n  |                                                                            \n  |===================================================                   |  72%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |===================================================                   |  74%\n  |                                                                            \n  |====================================================                  |  74%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |=====================================================                 |  75%\n  |                                                                            \n  |=====================================================                 |  76%\n  |                                                                            \n  |======================================================                |  76%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |======================================================                |  78%\n  |                                                                            \n  |=======================================================               |  78%\n  |                                                                            \n  |=======================================================               |  79%\n  |                                                                            \n  |========================================================              |  79%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |========================================================              |  81%\n  |                                                                            \n  |=========================================================             |  81%\n  |                                                                            \n  |=========================================================             |  82%\n  |                                                                            \n  |==========================================================            |  82%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |==========================================================            |  84%\n  |                                                                            \n  |===========================================================           |  84%\n  |                                                                            \n  |===========================================================           |  85%\n  |                                                                            \n  |============================================================          |  85%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |=============================================================         |  86%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |=============================================================         |  88%\n  |                                                                            \n  |==============================================================        |  88%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |===============================================================       |  89%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |===============================================================       |  91%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |=================================================================     |  92%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |=================================================================     |  94%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |==================================================================    |  95%\n  |                                                                            \n  |===================================================================   |  95%\n  |                                                                            \n  |===================================================================   |  96%\n  |                                                                            \n  |====================================================================  |  96%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |====================================================================  |  98%\n  |                                                                            \n  |===================================================================== |  98%\n  |                                                                            \n  |===================================================================== |  99%\n  |                                                                            \n  |======================================================================|  99%\n  |                                                                            \n  |======================================================================| 100%\n```\n:::\n\n\n- Apply linear model to GSVA result. Now using Limma to find significantly enriched gene sets in the same way you did to find diffGenes. This means you'll be using topTable, decideTests, etc. \n- note that you need to reference your design and contrast matrix here.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfit_C2CP <- lmFit(GSVA_res_C2CP, design)\nebfit_C2CP <- eBayes(fit_C2CP)\n\n### Use topTable and decideTests functions to identify the differentially enriched gene sets\ntopPaths_C2CP <- topTable(ebfit_C2CP, adjust =\"BH\", coef=1, number=50, sort.by=\"logFC\")\nres_C2CP <- decideTests(ebfit_C2CP, method=\"global\", adjust.method=\"BH\", p.value=0.05, lfc=0.58)\n\n### The summary of the decideTests result shows how many sets were enriched in induced and repressed genes in all sample types\nsummary(res_C2CP)\n##        disease healthy\n## Down        12      42\n## NotSig    5851    5864\n## Up          56      13\n\n# Pull out the gene sets that are differentially enriched between groups\ndiffSets_C2CP <- GSVA_res_C2CP[res_C2CP[,1] !=0,]\nhead(diffSets_C2CP)\n##                                                  HS01       HS02       HS03\n## ST_IL_13_PATHWAY                           -0.7173858 -0.7147717 -0.7164712\n## WATANABE_ULCERATIVE_COLITIS_WITH_CANCER_DN -0.6188325 -0.5710992 -0.4131349\n## FARMER_BREAST_CANCER_CLUSTER_1             -0.6886216 -0.5784651 -0.5593251\n## BOWIE_RESPONSE_TO_EXTRACELLULAR_MATRIX     -0.6707584 -0.5317945 -0.5360570\n## BOWIE_RESPONSE_TO_TAMOXIFEN                -0.6717424 -0.5377614 -0.5172726\n## KAUFFMANN_MELANOMA_RELAPSE_DN               0.5698331  0.7398284  0.6624807\n##                                                  HS04       HS05       CL08\n## ST_IL_13_PATHWAY                           -0.5968289 -0.4130711  0.8128353\n## WATANABE_ULCERATIVE_COLITIS_WITH_CANCER_DN -0.6270975 -0.5185058  0.2930852\n## FARMER_BREAST_CANCER_CLUSTER_1             -0.6325020 -0.4714246  0.5083211\n## BOWIE_RESPONSE_TO_EXTRACELLULAR_MATRIX     -0.6457163 -0.5252770  0.5529664\n## BOWIE_RESPONSE_TO_TAMOXIFEN                -0.6692727 -0.5128578  0.5408430\n## KAUFFMANN_MELANOMA_RELAPSE_DN               0.4426951  0.6730961 -0.6256108\n##                                                  CL10       CL11       CL12\n## ST_IL_13_PATHWAY                            0.6256980  0.5670608  0.6341371\n## WATANABE_ULCERATIVE_COLITIS_WITH_CANCER_DN  0.5838839  0.6787619  0.7118710\n## FARMER_BREAST_CANCER_CLUSTER_1              0.5593513  0.6517882  0.7463300\n## BOWIE_RESPONSE_TO_EXTRACELLULAR_MATRIX      0.4914990  0.7723819  0.6409015\n## BOWIE_RESPONSE_TO_TAMOXIFEN                 0.5064169  0.7568069  0.6405129\n## KAUFFMANN_MELANOMA_RELAPSE_DN              -0.6277048 -0.6895166 -0.8205882\n##                                                  CL13\n## ST_IL_13_PATHWAY                            0.6455147\n## WATANABE_ULCERATIVE_COLITIS_WITH_CANCER_DN  0.6389032\n## FARMER_BREAST_CANCER_CLUSTER_1              0.5802493\n## BOWIE_RESPONSE_TO_EXTRACELLULAR_MATRIX      0.6434423\n## BOWIE_RESPONSE_TO_TAMOXIFEN                 0.6232986\n## KAUFFMANN_MELANOMA_RELAPSE_DN              -0.3907835\ndim(diffSets_C2CP)\n## [1] 68 10\n\n### Make a heatmap of differentially enriched gene sets \nhr_C2CP <- hclust(\n    as.dist(1 - cor(t(diffSets_C2CP), method = \"pearson\")),\n    ### cluster rows by pearson correlation\n    method = \"complete\"\n)\n\nhc_C2CP <- hclust(\n    as.dist(1 - cor(diffSets_C2CP, method = \"spearman\")),\n    ### cluster columns by spearman correlation\n    method = \"complete\"\n)\n\n### Cut the resulting tree and create color vector for clusters.  Vary the cut height to give more or fewer clusters, or you the 'k' argument to force n number of clusters\nmycl_C2CP <- cutree(hr_C2CP, k=2)\nmycolhc_C2CP <- rainbow(\n    length(unique(mycl_C2CP)),\n    start = 0.1, end = 0.9\n)\n\nmycolhc_C2CP <- mycolhc_C2CP[as.vector(mycl_C2CP)] \n\n### assign your favorite heatmap color scheme. Some useful examples: colorpanel(40, \"darkblue\", \"yellow\", \"white\"); heat.colors(75); cm.colors(75); rainbow(75); redgreen(75); library(RColorBrewer); rev(brewer.pal(9,\"Blues\")[-1]). Type demo.col(20) to see more color schemes.\nmyheatcol <- colorRampPalette(colors=c(\"yellow\",\"white\",\"blue\"))(100)\n\n### Plot the hclust results as a heatmap\nheatmap.2(\n    diffSets_C2CP,\n    Rowv = as.dendrogram(hr_C2CP),\n    Colv = as.dendrogram(hc_C2CP),\n    col = myheatcol, scale = \"row\",\n    density.info = \"none\", trace = \"none\",\n    ### Creates heatmap for entire data set where the obtained clusters are indicated in the color bar.\n    cexRow = 0.9, cexCol = 1, margins = c(10, 14)\n) \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-29-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\n## Reference\n\n- [DIY Transcriptomics](https://diytranscriptomics.com/)\n- [protocols](https://protocols.hostmicrobe.org/)\n\n## SessionInfo\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsessionInfo()\n## R version 4.3.1 (2023-06-16)\n## Platform: aarch64-apple-darwin20 (64-bit)\n## Running under: macOS Sonoma 14.0\n## \n## Matrix products: default\n## BLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib \n## LAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0\n## \n## locale:\n## [1] en_US.UTF-8/UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n## \n## time zone: Asia/Singapore\n## tzcode source: internal\n## \n## attached base packages:\n## [1] stats4    stats     graphics  grDevices utils     datasets  methods  \n## [8] base     \n## \n## other attached packages:\n##  [1] enrichplot_1.20.0         msigdbr_7.5.1            \n##  [3] clusterProfiler_4.8.2     gprofiler2_0.2.2         \n##  [5] GSVA_1.48.3               GSEABase_1.62.0          \n##  [7] graph_1.78.0              annotate_1.78.0          \n##  [9] XML_3.99-0.14             gplots_3.1.3             \n## [11] heatmaply_1.4.2           viridis_0.6.4            \n## [13] viridisLite_0.4.2         RColorBrewer_1.1-3       \n## [15] gt_0.9.0                  plotly_4.10.2            \n## [17] DT_0.29                   cowplot_1.1.1            \n## [19] matrixStats_1.0.0         edgeR_3.42.4             \n## [21] limma_3.56.2              datapasta_3.1.0          \n## [23] here_1.0.1                EnsDb.Hsapiens.v86_2.99.0\n## [25] ensembldb_2.24.0          AnnotationFilter_1.24.0  \n## [27] GenomicFeatures_1.52.2    AnnotationDbi_1.62.2     \n## [29] Biobase_2.60.0            GenomicRanges_1.52.0     \n## [31] GenomeInfoDb_1.36.2       IRanges_2.34.1           \n## [33] S4Vectors_0.38.1          BiocGenerics_0.46.0      \n## [35] tximport_1.28.0           lubridate_1.9.2          \n## [37] forcats_1.0.0             stringr_1.5.0            \n## [39] dplyr_1.1.3               purrr_1.0.2              \n## [41] readr_2.1.4               tidyr_1.3.0              \n## [43] tibble_3.2.1              ggplot2_3.4.3            \n## [45] tidyverse_2.0.0           rhdf5_2.44.0             \n## \n## loaded via a namespace (and not attached):\n##   [1] ProtGenerics_1.32.0         bitops_1.0-7               \n##   [3] HDO.db_0.99.1               httr_1.4.7                 \n##   [5] webshot_0.5.5               tools_4.3.1                \n##   [7] utf8_1.2.3                  R6_2.5.1                   \n##   [9] HDF5Array_1.28.1            mgcv_1.9-0                 \n##  [11] lazyeval_0.2.2              rhdf5filters_1.12.1        \n##  [13] withr_2.5.0                 prettyunits_1.1.1          \n##  [15] gridExtra_2.3               cli_3.6.1                  \n##  [17] TSP_1.2-4                   scatterpie_0.2.1           \n##  [19] sass_0.4.7                  labeling_0.4.3             \n##  [21] commonmark_1.9.0            Rsamtools_2.16.0           \n##  [23] yulab.utils_0.0.9           gson_0.1.0                 \n##  [25] DOSE_3.26.1                 rstudioapi_0.15.0          \n##  [27] RSQLite_2.3.1               generics_0.1.3             \n##  [29] gridGraphics_0.5-1          BiocIO_1.10.0              \n##  [31] crosstalk_1.2.0             gtools_3.9.4               \n##  [33] vroom_1.6.3                 dendextend_1.17.1          \n##  [35] GO.db_3.17.0                Matrix_1.6-1               \n##  [37] fansi_1.0.4                 abind_1.4-5                \n##  [39] lifecycle_1.0.3             yaml_2.3.7                 \n##  [41] SummarizedExperiment_1.30.2 qvalue_2.32.0              \n##  [43] BiocFileCache_2.8.0         grid_4.3.1                 \n##  [45] blob_1.2.4                  promises_1.2.1             \n##  [47] crayon_1.5.2                lattice_0.21-8             \n##  [49] beachmat_2.16.0             KEGGREST_1.40.0            \n##  [51] pillar_1.9.0                knitr_1.44                 \n##  [53] fgsea_1.26.0                rjson_0.2.21               \n##  [55] codetools_0.2-19            fastmatch_1.1-4            \n##  [57] glue_1.6.2                  downloader_0.4             \n##  [59] ggfun_0.1.2                 data.table_1.14.8          \n##  [61] vctrs_0.6.3                 png_0.1-8                  \n##  [63] treeio_1.24.3               gtable_0.3.4               \n##  [65] assertthat_0.2.1            cachem_1.0.8               \n##  [67] xfun_0.40                   mime_0.12                  \n##  [69] S4Arrays_1.0.5              tidygraph_1.2.3            \n##  [71] SingleCellExperiment_1.22.0 seriation_1.4.2            \n##  [73] iterators_1.0.14            ellipsis_0.3.2             \n##  [75] nlme_3.1-163                ggtree_3.8.2               \n##  [77] bit64_4.0.5                 progress_1.2.2             \n##  [79] filelock_1.0.2              rprojroot_2.0.3            \n##  [81] irlba_2.3.5.1               KernSmooth_2.23-22         \n##  [83] colorspace_2.1-0            DBI_1.1.3                  \n##  [85] tidyselect_1.2.0            bit_4.0.5                  \n##  [87] compiler_4.3.1              curl_5.0.2                 \n##  [89] xml2_1.3.5                  DelayedArray_0.26.7        \n##  [91] shadowtext_0.1.2            rtracklayer_1.60.1         \n##  [93] scales_1.2.1                caTools_1.18.2             \n##  [95] hexbin_1.28.3               rappdirs_0.3.3             \n##  [97] digest_0.6.33               rmarkdown_2.24             \n##  [99] ca_0.71.1                   XVector_0.40.0             \n## [101] htmltools_0.5.6             pkgconfig_2.0.3            \n## [103] sparseMatrixStats_1.12.2    MatrixGenerics_1.12.3      \n## [105] dbplyr_2.3.3                fastmap_1.1.1              \n## [107] rlang_1.1.1                 htmlwidgets_1.6.2          \n## [109] shiny_1.7.5                 DelayedMatrixStats_1.22.6  \n## [111] farver_2.1.1                jsonlite_1.8.7             \n## [113] BiocParallel_1.34.2         GOSemSim_2.26.1            \n## [115] BiocSingular_1.16.0         RCurl_1.98-1.12            \n## [117] magrittr_2.0.3              GenomeInfoDbData_1.2.10    \n## [119] ggplotify_0.1.2             patchwork_1.1.3            \n## [121] Rhdf5lib_1.22.0             munsell_0.5.0              \n## [123] Rcpp_1.0.11                 ape_5.7-1                  \n## [125] babelgene_22.9              stringi_1.7.12             \n## [127] ggraph_2.1.0                zlibbioc_1.46.0            \n## [129] MASS_7.3-60                 plyr_1.8.8                 \n## [131] parallel_4.3.1              ggrepel_0.9.3              \n## [133] Biostrings_2.68.1           graphlayouts_1.0.0         \n## [135] splines_4.3.1               hms_1.1.3                  \n## [137] locfit_1.5-9.8              igraph_1.5.1               \n## [139] markdown_1.8                reshape2_1.4.4             \n## [141] biomaRt_2.56.1              ScaledMatrix_1.8.1         \n## [143] evaluate_0.21               httpuv_1.6.11              \n## [145] tzdb_0.4.0                  foreach_1.5.2              \n## [147] tweenr_2.0.2                polyclip_1.10-4            \n## [149] ggforce_0.4.1               rsvd_1.0.5                 \n## [151] xtable_1.8-4                restfulr_0.0.15            \n## [153] tidytree_0.4.5              later_1.3.1                \n## [155] aplot_0.2.0                 memoise_2.0.1              \n## [157] registry_0.5-1              GenomicAlignments_1.36.0   \n## [159] timechange_0.2.0\n```\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js\"></script>\n<script src=\"../../../../site_libs/plotly-binding-4.10.2/plotly.js\"></script>\n<script src=\"../../../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../../../../site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"../../../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\n<link href=\"../../../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../../../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}