{
  "hash": "871271458d622c81fc6b3e4755af5478",
  "result": {
    "markdown": "---\ntitle: \"Perform Principal Component Analysis using prcomp and princomp\"\ndate: 2023-05-13\n# date-modified: 2023-04-05\ncategories:\n  - PCA\nimage: pca.png\n---\n\n\n\n\n## Load Demon data\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n### Load packages\nlibrary(pacman)\np_load(\n    tidyverse,  # tidy data\n    FactoMineR, # compute principal component methods\n    factoextra  # extract, visualize and interpretate the results\n)\n\n### Demo data from factoextra\ndata(decathlon2)\ndecathlon2\n##             X100m Long.jump Shot.put High.jump X400m X110m.hurdle Discus\n## SEBRLE      11.04      7.58    14.83      2.07 49.81        14.69  43.75\n## CLAY        10.76      7.40    14.26      1.86 49.37        14.05  50.72\n## BERNARD     11.02      7.23    14.25      1.92 48.93        14.99  40.87\n## YURKOV      11.34      7.09    15.19      2.10 50.42        15.31  46.26\n## ZSIVOCZKY   11.13      7.30    13.48      2.01 48.62        14.17  45.67\n## McMULLEN    10.83      7.31    13.76      2.13 49.91        14.38  44.41\n## MARTINEAU   11.64      6.81    14.57      1.95 50.14        14.93  47.60\n## HERNU       11.37      7.56    14.41      1.86 51.10        15.06  44.99\n## BARRAS      11.33      6.97    14.09      1.95 49.48        14.48  42.10\n## NOOL        11.33      7.27    12.68      1.98 49.20        15.29  37.92\n## BOURGUIGNON 11.36      6.80    13.46      1.86 51.16        15.67  40.49\n## Sebrle      10.85      7.84    16.36      2.12 48.36        14.05  48.72\n## Clay        10.44      7.96    15.23      2.06 49.19        14.13  50.11\n## Karpov      10.50      7.81    15.93      2.09 46.81        13.97  51.65\n## Macey       10.89      7.47    15.73      2.15 48.97        14.56  48.34\n## Warners     10.62      7.74    14.48      1.97 47.97        14.01  43.73\n## Zsivoczky   10.91      7.14    15.31      2.12 49.40        14.95  45.62\n## Hernu       10.97      7.19    14.65      2.03 48.73        14.25  44.72\n## Bernard     10.69      7.48    14.80      2.12 49.13        14.17  44.75\n## Schwarzl    10.98      7.49    14.01      1.94 49.76        14.25  42.43\n## Pogorelov   10.95      7.31    15.10      2.06 50.79        14.21  44.60\n## Schoenbeck  10.90      7.30    14.77      1.88 50.30        14.34  44.41\n## Barras      11.14      6.99    14.91      1.94 49.41        14.37  44.83\n## KARPOV      11.02      7.30    14.77      2.04 48.37        14.09  48.95\n## WARNERS     11.11      7.60    14.31      1.98 48.68        14.23  41.10\n## Nool        10.80      7.53    14.26      1.88 48.81        14.80  42.05\n## Drews       10.87      7.38    13.07      1.88 48.51        14.01  40.11\n##             Pole.vault Javeline X1500m Rank Points Competition\n## SEBRLE            5.02    63.19 291.70    1   8217    Decastar\n## CLAY              4.92    60.15 301.50    2   8122    Decastar\n## BERNARD           5.32    62.77 280.10    4   8067    Decastar\n## YURKOV            4.72    63.44 276.40    5   8036    Decastar\n## ZSIVOCZKY         4.42    55.37 268.00    7   8004    Decastar\n## McMULLEN          4.42    56.37 285.10    8   7995    Decastar\n## MARTINEAU         4.92    52.33 262.10    9   7802    Decastar\n## HERNU             4.82    57.19 285.10   10   7733    Decastar\n## BARRAS            4.72    55.40 282.00   11   7708    Decastar\n## NOOL              4.62    57.44 266.60   12   7651    Decastar\n## BOURGUIGNON       5.02    54.68 291.70   13   7313    Decastar\n## Sebrle            5.00    70.52 280.01    1   8893    OlympicG\n## Clay              4.90    69.71 282.00    2   8820    OlympicG\n## Karpov            4.60    55.54 278.11    3   8725    OlympicG\n## Macey             4.40    58.46 265.42    4   8414    OlympicG\n## Warners           4.90    55.39 278.05    5   8343    OlympicG\n## Zsivoczky         4.70    63.45 269.54    6   8287    OlympicG\n## Hernu             4.80    57.76 264.35    7   8237    OlympicG\n## Bernard           4.40    55.27 276.31    9   8225    OlympicG\n## Schwarzl          5.10    56.32 273.56   10   8102    OlympicG\n## Pogorelov         5.00    53.45 287.63   11   8084    OlympicG\n## Schoenbeck        5.00    60.89 278.82   12   8077    OlympicG\n## Barras            4.60    64.55 267.09   13   8067    OlympicG\n## KARPOV            4.92    50.31 300.20    3   8099    Decastar\n## WARNERS           4.92    51.77 278.10    6   8030    Decastar\n## Nool              5.40    61.33 276.33    8   8235    OlympicG\n## Drews             5.00    51.53 274.21   19   7926    OlympicG\n\n### extract only active individuals and variables\ndecathlon2_active <- decathlon2[1:23, 1:10]\ndecathlon2_active\n##             X100m Long.jump Shot.put High.jump X400m X110m.hurdle Discus\n## SEBRLE      11.04      7.58    14.83      2.07 49.81        14.69  43.75\n## CLAY        10.76      7.40    14.26      1.86 49.37        14.05  50.72\n## BERNARD     11.02      7.23    14.25      1.92 48.93        14.99  40.87\n## YURKOV      11.34      7.09    15.19      2.10 50.42        15.31  46.26\n## ZSIVOCZKY   11.13      7.30    13.48      2.01 48.62        14.17  45.67\n## McMULLEN    10.83      7.31    13.76      2.13 49.91        14.38  44.41\n## MARTINEAU   11.64      6.81    14.57      1.95 50.14        14.93  47.60\n## HERNU       11.37      7.56    14.41      1.86 51.10        15.06  44.99\n## BARRAS      11.33      6.97    14.09      1.95 49.48        14.48  42.10\n## NOOL        11.33      7.27    12.68      1.98 49.20        15.29  37.92\n## BOURGUIGNON 11.36      6.80    13.46      1.86 51.16        15.67  40.49\n## Sebrle      10.85      7.84    16.36      2.12 48.36        14.05  48.72\n## Clay        10.44      7.96    15.23      2.06 49.19        14.13  50.11\n## Karpov      10.50      7.81    15.93      2.09 46.81        13.97  51.65\n## Macey       10.89      7.47    15.73      2.15 48.97        14.56  48.34\n## Warners     10.62      7.74    14.48      1.97 47.97        14.01  43.73\n## Zsivoczky   10.91      7.14    15.31      2.12 49.40        14.95  45.62\n## Hernu       10.97      7.19    14.65      2.03 48.73        14.25  44.72\n## Bernard     10.69      7.48    14.80      2.12 49.13        14.17  44.75\n## Schwarzl    10.98      7.49    14.01      1.94 49.76        14.25  42.43\n## Pogorelov   10.95      7.31    15.10      2.06 50.79        14.21  44.60\n## Schoenbeck  10.90      7.30    14.77      1.88 50.30        14.34  44.41\n## Barras      11.14      6.99    14.91      1.94 49.41        14.37  44.83\n##             Pole.vault Javeline X1500m\n## SEBRLE            5.02    63.19 291.70\n## CLAY              4.92    60.15 301.50\n## BERNARD           5.32    62.77 280.10\n## YURKOV            4.72    63.44 276.40\n## ZSIVOCZKY         4.42    55.37 268.00\n## McMULLEN          4.42    56.37 285.10\n## MARTINEAU         4.92    52.33 262.10\n## HERNU             4.82    57.19 285.10\n## BARRAS            4.72    55.40 282.00\n## NOOL              4.62    57.44 266.60\n## BOURGUIGNON       5.02    54.68 291.70\n## Sebrle            5.00    70.52 280.01\n## Clay              4.90    69.71 282.00\n## Karpov            4.60    55.54 278.11\n## Macey             4.40    58.46 265.42\n## Warners           4.90    55.39 278.05\n## Zsivoczky         4.70    63.45 269.54\n## Hernu             4.80    57.76 264.35\n## Bernard           4.40    55.27 276.31\n## Schwarzl          5.10    56.32 273.56\n## Pogorelov         5.00    53.45 287.63\n## Schoenbeck        5.00    60.89 278.82\n## Barras            4.60    64.55 267.09\n```\n:::\n\n![](pca-decathlon-300dpi.png)\n\n## Compute PCA and Visualize\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nres_pca <- prcomp(decathlon2_active, scale = TRUE) # use the singular value decomposition\nres_pca\n## Standard deviations (1, .., p=10):\n##  [1] 2.0308159 1.3559244 1.1131668 0.9052294 0.8375875 0.6502944 0.5500742\n##  [8] 0.5238988 0.3939758 0.3492435\n## \n## Rotation (n x k) = (10 x 10):\n##                       PC1         PC2         PC3         PC4        PC5\n## X100m        -0.418859080 -0.13230683 -0.27089959  0.03708806 -0.2321476\n## Long.jump     0.391064807  0.20713320  0.17117519 -0.12746997  0.2783669\n## Shot.put      0.361388111  0.06298590 -0.46497777  0.14191803 -0.2970589\n## High.jump     0.300413236 -0.34309742 -0.29652805  0.15968342  0.4807859\n## X400m        -0.345478567  0.21400770 -0.25470839  0.47592968  0.1240569\n## X110m.hurdle -0.376265119 -0.01824645 -0.40325254 -0.01866477  0.2676975\n## Discus        0.365965721  0.03662510 -0.15857927  0.43636361 -0.4873988\n## Pole.vault   -0.106985591  0.59549862 -0.08449563 -0.37447391 -0.2646712\n## Javeline      0.210864329  0.28475723 -0.54270782 -0.36646463  0.2361698\n## X1500m        0.002106782  0.57855748  0.19715884  0.49491281  0.3142987\n##                       PC6         PC7         PC8         PC9        PC10\n## X100m        -0.054398099 -0.16604375 -0.19988005 -0.76924639  0.12718339\n## Long.jump     0.051865558 -0.28056361 -0.75850657 -0.13094589  0.08509665\n## Shot.put      0.368739186 -0.01797323  0.04649571  0.12129309  0.62263702\n## High.jump     0.437716883  0.05118848  0.16111045 -0.28463225 -0.38244596\n## X400m         0.075796432  0.52012255 -0.44579641  0.20854176 -0.09784197\n## X110m.hurdle -0.004048005 -0.67276768 -0.01592804  0.41058421 -0.04475363\n## Discus       -0.305315353 -0.25946615 -0.07550934  0.03391600 -0.49418361\n## Pole.vault    0.503563524 -0.01889413  0.06282691 -0.06540692 -0.39288155\n## Javeline     -0.556821016  0.24281145  0.10086127 -0.10268134 -0.01103627\n## X1500m       -0.064663250 -0.20245828  0.37119711 -0.25950868  0.17991689\n\n### visualize the eigenvalues\nfviz_eig(res_pca)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){fig-align='center' width=672}\n:::\n\n```{.r .cell-code}\n\n### Individuals with a similar profile are grouped together\nfviz_pca_ind(\n    res_pca, \n    col.ind = \"cos2\", # color by the quality of representation\n    gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n    repel = TRUE # avoid text overlapping\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-2.png){fig-align='center' width=672}\n:::\n\n```{.r .cell-code}\n\n### graph of variables. positive correlated variables point to the same side of the plot\n### negative correlated variables point to opposite of the graph\nfviz_pca_var(\n    res_pca, \n    col.var = \"contrib\", # color by contributions to the PC\n    gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n    repel = TRUE # avoid text overlapping\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-3.png){fig-align='center' width=672}\n:::\n\n```{.r .cell-code}\n\n### biplot of individuals and variables\nfviz_pca_biplot(\n    res_pca, \n    repel = TRUE,\n    col.var = \"#2E9FDF\", # Variables color\n    col.ind = \"#696969\"  # Individuals color\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-4.png){fig-align='center' width=672}\n:::\n:::\n\n\n## Access to the PCA results\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n### eigenvalues\neig_val <- get_eigenvalue(res_pca)\neig_val\n##        eigenvalue variance.percent cumulative.variance.percent\n## Dim.1   4.1242133        41.242133                    41.24213\n## Dim.2   1.8385309        18.385309                    59.62744\n## Dim.3   1.2391403        12.391403                    72.01885\n## Dim.4   0.8194402         8.194402                    80.21325\n## Dim.5   0.7015528         7.015528                    87.22878\n## Dim.6   0.4228828         4.228828                    91.45760\n## Dim.7   0.3025817         3.025817                    94.48342\n## Dim.8   0.2744700         2.744700                    97.22812\n## Dim.9   0.1552169         1.552169                    98.78029\n## Dim.10  0.1219710         1.219710                   100.00000\n\n# Results for Variables\nres_var <- get_pca_var(res_pca)\nres_var$coord          # Coordinates\n##                     Dim.1       Dim.2       Dim.3       Dim.4      Dim.5\n## X100m        -0.850625692 -0.17939806 -0.30155643  0.03357320 -0.1944440\n## Long.jump     0.794180641  0.28085695  0.19054653 -0.11538956  0.2331567\n## Shot.put      0.733912733  0.08540412 -0.51759781  0.12846837 -0.2488129\n## High.jump     0.610083985 -0.46521415 -0.33008517  0.14455012  0.4027002\n## X400m        -0.701603377  0.29017826 -0.28353292  0.43082552  0.1039085\n## X110m.hurdle -0.764125197 -0.02474081 -0.44888733 -0.01689589  0.2242200\n## Discus        0.743209016  0.04966086 -0.17652518  0.39500915 -0.4082391\n## Pole.vault   -0.217268042  0.80745110 -0.09405773 -0.33898477 -0.2216853\n## Javeline      0.428226639  0.38610928 -0.60412432 -0.33173454  0.1978128\n## X1500m        0.004278487  0.78448019  0.21947068  0.44800961  0.2632527\n##                     Dim.6        Dim.7        Dim.8       Dim.9       Dim.10\n## X100m        -0.035374780 -0.091336386 -0.104716925 -0.30306448  0.044417974\n## Long.jump     0.033727883 -0.154330810 -0.397380703 -0.05158951  0.029719453\n## Shot.put      0.239789034 -0.009886612  0.024359049  0.04778655  0.217451948\n## High.jump     0.284644846  0.028157465  0.084405578 -0.11213822 -0.133566774\n## X400m         0.049289996  0.286106008 -0.233552216  0.08216041 -0.034170673\n## X110m.hurdle -0.002632395 -0.370072158 -0.008344682  0.16176025 -0.015629914\n## Discus       -0.198544870 -0.142725641 -0.039559255  0.01336209 -0.172590426\n## Pole.vault    0.327464549 -0.010393176  0.032914942 -0.02576874 -0.137211339\n## Javeline     -0.362097598  0.133564318  0.052841099 -0.04045397 -0.003854347\n## X1500m       -0.042050151 -0.111367083  0.194469730 -0.10224014  0.062834809\nres_var$contrib        # Contributions to the PCs\n##                     Dim.1      Dim.2      Dim.3       Dim.4     Dim.5\n## X100m        1.754429e+01  1.7505098  7.3386590  0.13755240  5.389252\n## Long.jump    1.529317e+01  4.2904162  2.9300944  1.62485936  7.748815\n## Shot.put     1.306014e+01  0.3967224 21.6204325  2.01407269  8.824401\n## High.jump    9.024811e+00 11.7715838  8.7928883  2.54987951 23.115504\n## X400m        1.193554e+01  4.5799296  6.4876363 22.65090599  1.539012\n## X110m.hurdle 1.415754e+01  0.0332933 16.2612611  0.03483735  7.166193\n## Discus       1.339309e+01  0.1341398  2.5147385 19.04132022 23.755756\n## Pole.vault   1.144592e+00 35.4618611  0.7139512 14.02307063  7.005084\n## Javeline     4.446377e+00  8.1086683 29.4531777 13.42963254  5.577615\n## X1500m       4.438531e-04 33.4728757  3.8871610 24.49386930  9.878367\n##                     Dim.6       Dim.7       Dim.8      Dim.9      Dim.10\n## X100m         0.295915322  2.75705260  3.99520353 59.1740009  1.61756139\n## Long.jump     0.269003613  7.87159392 57.53322220  1.7146826  0.72414393\n## Shot.put     13.596858744  0.03230371  0.21618512  1.4712015 38.76768578\n## High.jump    19.159607001  0.26202607  2.59565787  8.1015517 14.62649091\n## X400m         0.574509906 27.05274658 19.87344405  4.3489667  0.95730504\n## X110m.hurdle  0.001638634 45.26163460  0.02537025 16.8579392  0.20028870\n## Discus        9.321746508  6.73226823  0.57016606  0.1150295 24.42174410\n## Pole.vault   25.357622290  0.03569883  0.39472201  0.4278065 15.43559151\n## Javeline     31.004964393  5.89573984  1.01729950  1.0543458  0.01217993\n## X1500m        0.418133591  4.09893563 13.77872941  6.7344755  3.23700871\nres_var$cos2           # Quality of representation \n##                     Dim.1        Dim.2       Dim.3        Dim.4      Dim.5\n## X100m        7.235641e-01 0.0321836641 0.090936280 0.0011271597 0.03780845\n## Long.jump    6.307229e-01 0.0788806285 0.036307981 0.0133147506 0.05436203\n## Shot.put     5.386279e-01 0.0072938636 0.267907488 0.0165041211 0.06190783\n## High.jump    3.722025e-01 0.2164242070 0.108956221 0.0208947375 0.16216747\n## X400m        4.922473e-01 0.0842034209 0.080390914 0.1856106269 0.01079698\n## X110m.hurdle 5.838873e-01 0.0006121077 0.201499837 0.0002854712 0.05027463\n## Discus       5.523596e-01 0.0024662013 0.031161138 0.1560322304 0.16665918\n## Pole.vault   4.720540e-02 0.6519772763 0.008846856 0.1149106765 0.04914437\n## Javeline     1.833781e-01 0.1490803723 0.364966189 0.1100478063 0.03912992\n## X1500m       1.830545e-05 0.6154091638 0.048167378 0.2007126089 0.06930197\n##                     Dim.6        Dim.7        Dim.8        Dim.9       Dim.10\n## X100m        1.251375e-03 0.0083423353 1.096563e-02 0.0918480768 1.972956e-03\n## Long.jump    1.137570e-03 0.0238179990 1.579114e-01 0.0026614779 8.832459e-04\n## Shot.put     5.749878e-02 0.0000977451 5.933633e-04 0.0022835540 4.728535e-02\n## High.jump    8.102269e-02 0.0007928428 7.124302e-03 0.0125749811 1.784008e-02\n## X400m        2.429504e-03 0.0818566479 5.454664e-02 0.0067503333 1.167635e-03\n## X110m.hurdle 6.929502e-06 0.1369534023 6.963371e-05 0.0261663784 2.442942e-04\n## Discus       3.942007e-02 0.0203706085 1.564935e-03 0.0001785453 2.978746e-02\n## Pole.vault   1.072330e-01 0.0001080181 1.083393e-03 0.0006640282 1.882695e-02\n## Javeline     1.311147e-01 0.0178394271 2.792182e-03 0.0016365234 1.485599e-05\n## X1500m       1.768215e-03 0.0124026272 3.781848e-02 0.0104530472 3.948213e-03\n\n# Results for individuals\nres_ind <- get_pca_ind(res_pca)\nres_ind$coord          # Coordinates\n##                  Dim.1      Dim.2       Dim.3       Dim.4         Dim.5\n## SEBRLE       0.1912074  1.5541282 -0.62836882  0.08205241  1.1426139415\n## CLAY         0.7901217  2.4204156  1.35688701  1.26984296 -0.8068483724\n## BERNARD     -1.3292592  1.6118687 -0.19614996 -1.92092203  0.0823428202\n## YURKOV      -0.8694134 -0.4328779 -2.47398223  0.69723814  0.3988584116\n## ZSIVOCZKY   -0.1057450 -2.0233632  1.30493117 -0.09929630 -0.1970241089\n## McMULLEN     0.1185550 -0.9916237  0.84355824  1.31215266  1.5858708644\n## MARTINEAU   -2.3923532 -1.2849234 -0.89816842  0.37309771 -2.2433515889\n## HERNU       -1.8910497  1.1784614 -0.15641037  0.89130068 -0.1267412520\n## BARRAS      -1.7744575 -0.4125321  0.65817750  0.22872866 -0.2338366980\n## NOOL        -2.7770058 -1.5726757  0.60724821 -1.55548081  1.4241839810\n## BOURGUIGNON -4.4137335  1.2635770 -0.01003734  0.66675478  0.4191518468\n## Sebrle       3.4514485  1.2169193 -1.67816711 -0.80870696 -0.0250530746\n## Clay         3.3162243  1.6232908 -0.61840443 -0.31679906  0.5691645854\n## Karpov       4.0703560 -0.7983510  1.01501662  0.31336354 -0.7974259553\n## Macey        1.8484623 -2.0638828 -0.97928455  0.58469073 -0.0002157834\n## Warners      1.3873514  0.2819083  1.99969621 -1.01959817 -0.0405401497\n## Zsivoczky    0.4715533 -0.9267436 -1.72815525 -0.18483138  0.4073029909\n## Hernu        0.2763118 -1.1657260  0.17056375 -0.84869401 -0.6894795441\n## Bernard      1.3672590 -1.4780354  0.83137913  0.74531557  0.8598016482\n## Schwarzl    -0.7102777  0.6584251  1.04075176 -0.92717510 -0.2887568007\n## Pogorelov   -0.2143524  0.8610557  0.29761010  1.35560294 -0.0150531057\n## Schoenbeck  -0.4953166  1.3000530  0.10300360 -0.24927712 -0.6452257128\n## Barras      -0.3158867 -0.8193681 -0.86169481 -0.58935985 -0.7797389436\n##                   Dim.6       Dim.7        Dim.8        Dim.9      Dim.10\n## SEBRLE       0.46389755 -0.20796012  0.043460568 -0.659344137  0.03273238\n## CLAY        -1.30420016 -0.21291866  0.617240611 -0.060125359 -0.31716015\n## BERNARD      0.40062867 -0.40643754  0.703856040  0.170083313 -0.09908142\n## YURKOV      -0.10286344 -0.32487448  0.114996135 -0.109524039 -0.11969720\n## ZSIVOCZKY   -0.89554111  0.08825624 -0.202341299 -0.523103099 -0.34842265\n## McMULLEN    -0.18657283  0.47828432  0.293089967 -0.105623196 -0.39317797\n## MARTINEAU    0.45666350 -0.29975522 -0.291628488 -0.223417655 -0.61640509\n## HERNU       -0.43623496 -0.56609980 -1.529404317  0.006184409  0.55368016\n## BARRAS      -0.09026010  0.21594095  0.682583078 -0.669282042  0.53085420\n## NOOL        -0.49716399 -0.53205687 -0.433385655 -0.115777808 -0.09622142\n## BOURGUIGNON  0.08200220 -0.59833739  0.563619921  0.525814030  0.05855882\n## Sebrle       0.08279306  0.01016177 -0.030585843 -0.847210682  0.21970353\n## Clay        -0.77715960  0.25750851 -0.580638301  0.409776590 -0.61601933\n## Karpov       0.32958134 -1.36365568  0.345306381  0.193055107  0.21721852\n## Macey        0.19728082 -0.26927772 -0.363219506  0.368260269  0.21249474\n## Warners      0.55673300 -0.26739400 -0.109470797  0.180283071  0.24208420\n## Zsivoczky    0.11383190  0.03991159  0.538039776  0.585966156 -0.14271715\n## Hernu        0.33168404  0.44308686  0.247293566  0.066908586 -0.20868256\n## Bernard      0.32806564  0.36357920  0.006165316  0.279488675  0.32067773\n## Schwarzl     0.68891640  0.56568604 -0.687053339 -0.008358849 -0.30211546\n## Pogorelov    1.59379599  0.78370119 -0.037623661 -0.130531397 -0.03697576\n## Schoenbeck  -0.16172381  0.85752368 -0.255850722  0.564222295  0.29680481\n## Barras      -1.17415412  0.94512710  0.365550568  0.102255763  0.61186706\nres_ind$contrib        # Contributions to the PCs\n##                   Dim.1      Dim.2        Dim.3       Dim.4        Dim.5\n## SEBRLE       0.03854254  5.7118249 1.385418e+00  0.03572215 8.091161e+00\n## CLAY         0.65814114 13.8541889 6.460097e+00  8.55568792 4.034555e+00\n## BERNARD      1.86273218  6.1441319 1.349983e-01 19.57827284 4.202070e-02\n## YURKOV       0.79686310  0.4431309 2.147558e+01  2.57939100 9.859373e-01\n## ZSIVOCZKY    0.01178829  9.6816398 5.974848e+00  0.05231437 2.405750e-01\n## McMULLEN     0.01481737  2.3253860 2.496789e+00  9.13531719 1.558646e+01\n## MARTINEAU    6.03367104  3.9044125 2.830527e+00  0.73858431 3.118936e+01\n## HERNU        3.76996156  3.2842176 8.583863e-02  4.21505626 9.955149e-02\n## BARRAS       3.31942012  0.4024544 1.519980e+00  0.27758505 3.388731e-01\n## NOOL         8.12988880  5.8489726 1.293851e+00 12.83761115 1.257025e+01\n## BOURGUIGNON 20.53729577  3.7757623 3.534995e-04  2.35877858 1.088816e+00\n## Sebrle      12.55838616  3.5020697 9.881482e+00  3.47006223 3.889859e-03\n## Clay        11.59361384  6.2315181 1.341828e+00  0.53250375 2.007648e+00\n## Karpov      17.46609555  1.5072627 3.614914e+00  0.52101693 3.940874e+00\n## Macey        3.60207087 10.0732890 3.364879e+00  1.81387486 2.885677e-07\n## Warners      2.02910262  0.1879390 1.403071e+01  5.51585696 1.018550e-02\n## Zsivoczky    0.23441891  2.0310492 1.047894e+01  0.18126182 1.028128e+00\n## Hernu        0.08048777  3.2136178 1.020764e-01  3.82170515 2.946148e+00\n## Bernard      1.97075488  5.1661961 2.425213e+00  2.94737426 4.581507e+00\n## Schwarzl     0.53184785  1.0252129 3.800546e+00  4.56119277 5.167449e-01\n## Pogorelov    0.04843819  1.7533304 3.107757e-01  9.75034337 1.404313e-03\n## Schoenbeck   0.25864068  3.9969003 3.722687e-02  0.32970059 2.580092e+00\n## Barras       0.10519467  1.5876667 2.605305e+00  1.84296038 3.767994e+00\n##                   Dim.6        Dim.7        Dim.8        Dim.9      Dim.10\n## SEBRLE       2.21256620  0.621426384 2.992045e-02 12.177477305  0.03819185\n## CLAY        17.48801877  0.651413899 6.035125e+00  0.101262442  3.58568943\n## BERNARD      1.65019840  2.373652810 7.847747e+00  0.810319793  0.34994507\n## YURKOV       0.10878629  1.516564073 2.094806e-01  0.336009790  0.51072064\n## ZSIVOCZKY    8.24561722  0.111923276 6.485544e-01  7.664919832  4.32741147\n## McMULLEN     0.35788945  3.287016354 1.360753e+00  0.312501167  5.51053518\n## MARTINEAU    2.14409841  1.291109482 1.347216e+00  1.398195851 13.54402896\n## HERNU        1.95655942  4.604850849 3.705288e+01  0.001071345 10.92781554\n## BARRAS       0.08376135  0.670038259 7.380544e+00 12.547331617 10.04537028\n## NOOL         2.54127369  4.067669683 2.975270e+00  0.375477289  0.33003418\n## BOURGUIGNON  0.06913582  5.144247534 5.032108e+00  7.744571086  0.12223626\n## Sebrle       0.07047579  0.001483775 1.481898e-02 20.105546253  1.72063803\n## Clay         6.20972751  0.952824148 5.340583e+00  4.703566841 13.52708188\n## Karpov       1.11680500 26.720158115 1.888802e+00  1.043988269  1.68193477\n## Macey        0.40014909  1.041910483 2.089853e+00  3.798767930  1.60957713\n## Warners      3.18673563  1.027384225 1.898339e-01  0.910422384  2.08904756\n## Zsivoczky    0.13322327  0.022889042 4.585705e+00  9.617852173  0.72605208\n## Hernu        1.13110069  2.821027418 9.687304e-01  0.125399768  1.55234328\n## Bernard      1.10655655  1.899449022 6.021268e-04  2.188071254  3.66566729\n## Schwarzl     4.87961053  4.598122119 7.477531e+00  0.001957159  3.25357879\n## Pogorelov   26.11665608  8.825322559 2.242329e-02  0.477268755  0.04873597\n## Schoenbeck   0.26890572 10.566272800 1.036933e+00  8.917302863  3.14020004\n## Barras      14.17432302 12.835417603 2.116763e+00  0.292892746 13.34533825\nres_ind$cos2           # Quality of representation\n##                   Dim.1      Dim.2        Dim.3       Dim.4        Dim.5\n## SEBRLE      0.007530179 0.49747323 8.132523e-02 0.001386688 2.689027e-01\n## CLAY        0.048701249 0.45701660 1.436281e-01 0.125791741 5.078506e-02\n## BERNARD     0.197199804 0.28996555 4.294015e-03 0.411819183 7.567259e-04\n## YURKOV      0.096109800 0.02382571 7.782303e-01 0.061812637 2.022798e-02\n## ZSIVOCZKY   0.001574385 0.57641944 2.397542e-01 0.001388216 5.465497e-03\n## McMULLEN    0.002175437 0.15219499 1.101379e-01 0.266486530 3.892621e-01\n## MARTINEAU   0.404013915 0.11654676 5.694575e-02 0.009826320 3.552552e-01\n## HERNU       0.399282749 0.15506199 2.731529e-03 0.088699901 1.793538e-03\n## BARRAS      0.616241975 0.03330700 8.478249e-02 0.010239088 1.070152e-02\n## NOOL        0.489872515 0.15711146 2.342405e-02 0.153694675 1.288433e-01\n## BOURGUIGNON 0.859698130 0.07045912 4.446015e-06 0.019618511 7.753120e-03\n## Sebrle      0.675380606 0.08395940 1.596674e-01 0.037079012 3.558507e-05\n## Clay        0.687592867 0.16475409 2.391051e-02 0.006274965 2.025440e-02\n## Karpov      0.783666922 0.03014772 4.873187e-02 0.004644764 3.007790e-02\n## Macey       0.363436037 0.45308203 1.020057e-01 0.036362957 4.952707e-09\n## Warners     0.255651956 0.01055582 5.311341e-01 0.138081100 2.182965e-04\n## Zsivoczky   0.045053176 0.17401353 6.051030e-01 0.006921739 3.361236e-02\n## Hernu       0.024824321 0.44184663 9.459148e-03 0.234196727 1.545686e-01\n## Bernard     0.289347476 0.33813318 1.069834e-01 0.085980212 1.144234e-01\n## Schwarzl    0.116721435 0.10030142 2.506043e-01 0.198892209 1.929118e-02\n## Pogorelov   0.007803472 0.12591966 1.504272e-02 0.312101619 3.848427e-05\n## Schoenbeck  0.067070098 0.46204603 2.900467e-03 0.016987442 1.138116e-01\n## Barras      0.018972684 0.12765099 1.411800e-01 0.066043061 1.156018e-01\n##                    Dim.6        Dim.7        Dim.8        Dim.9       Dim.10\n## SEBRLE      0.0443241299 8.907507e-03 3.890334e-04 8.954067e-02 0.0002206741\n## CLAY        0.1326907339 3.536548e-03 2.972084e-02 2.820119e-04 0.0078471026\n## BERNARD     0.0179131165 1.843634e-02 5.529104e-02 3.228572e-03 0.0010956493\n## YURKOV      0.0013453555 1.341980e-02 1.681440e-03 1.525225e-03 0.0018217256\n## ZSIVOCZKY   0.1129176906 1.096685e-03 5.764478e-03 3.852703e-02 0.0170924251\n## McMULLEN    0.0053876990 3.540616e-02 1.329562e-02 1.726733e-03 0.0239268142\n## MARTINEAU   0.0147210347 6.342774e-03 6.003515e-03 3.523552e-03 0.0268211980\n## HERNU       0.0212478795 3.578167e-02 2.611676e-01 4.270425e-06 0.0342288717\n## BARRAS      0.0015944528 9.126203e-03 9.118662e-02 8.766746e-02 0.0551531863\n## NOOL        0.0157010551 1.798232e-02 1.193105e-02 8.514912e-04 0.0005881295\n## BOURGUIGNON 0.0002967459 1.579887e-02 1.401866e-02 1.220108e-02 0.0001513277\n## Sebrle      0.0003886276 5.854423e-06 5.303795e-05 4.069384e-02 0.0027366539\n## Clay        0.0377627839 4.145976e-03 2.107924e-02 1.049876e-02 0.0237264222\n## Karpov      0.0051379747 8.795817e-02 5.639959e-03 1.762907e-03 0.0022318265\n## Macey       0.0041397727 7.712721e-03 1.403282e-02 1.442502e-02 0.0048028954\n## Warners     0.0411689767 9.496848e-03 1.591742e-03 4.317040e-03 0.0077841113\n## Zsivoczky   0.0026253777 3.227467e-04 5.865332e-02 6.956790e-02 0.0041268259\n## Hernu       0.0357707217 6.383462e-02 1.988402e-02 1.455601e-03 0.0141595965\n## Bernard     0.0166586433 2.046050e-02 5.883405e-06 1.209056e-02 0.0159167991\n## Schwarzl    0.1098063093 7.403638e-02 1.092132e-01 1.616543e-05 0.0211173850\n## Pogorelov   0.4314162233 1.043115e-01 2.404103e-04 2.893750e-03 0.0002322016\n## Schoenbeck  0.0071500829 2.010275e-01 1.789520e-02 8.702893e-02 0.0240826922\n## Barras      0.2621297474 1.698426e-01 2.540745e-02 1.988116e-03 0.0711836486\n```\n:::\n\n\n## Predict using PCA\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n### Data for the supplementary individuals\nind_sup <- decathlon2[24:27, 1:10]\nind_sup\n##         X100m Long.jump Shot.put High.jump X400m X110m.hurdle Discus Pole.vault\n## KARPOV  11.02      7.30    14.77      2.04 48.37        14.09  48.95       4.92\n## WARNERS 11.11      7.60    14.31      1.98 48.68        14.23  41.10       4.92\n## Nool    10.80      7.53    14.26      1.88 48.81        14.80  42.05       5.40\n## Drews   10.87      7.38    13.07      1.88 48.51        14.01  40.11       5.00\n##         Javeline X1500m\n## KARPOV     50.31 300.20\n## WARNERS    51.77 278.10\n## Nool       61.33 276.33\n## Drews      51.53 274.21\n\n### Predict the coordinates of new individuals data\nind_sup_coord <- predict(res_pca, newdata = ind_sup)\nind_sup_coord\n##                PC1         PC2       PC3        PC4         PC5       PC6\n## KARPOV   0.7772521  0.76237804 1.5971253  1.6863286 -0.73420295 0.8764709\n## WARNERS -0.3779697 -0.11891968 1.7005146 -0.6908084 -0.03159013 1.1580162\n## Nool    -0.5468405  1.93402211 0.4724184 -2.2283706 -0.24901831 0.5459418\n## Drews   -1.0848227  0.01703198 2.9818031 -1.5006207 -0.31924693 0.4645028\n##                PC7         PC8         PC9       PC10\n## KARPOV  -1.0746432  1.24674643 -1.09172761 -0.2155002\n## WARNERS -0.3181706 -0.41754716 -0.69099653  0.5251023\n## Nool    -0.4656852 -0.05883861  0.65860586 -0.2815011\n## Drews    0.3406706  0.01529952 -0.01678235 -0.1657992\n\n### Graphs of individuals including the supplementary individuals\np <- fviz_pca_ind(res_pca, repel = TRUE)\n# Add supplementary individuals\nfviz_add(p, ind_sup_coord, color =\"blue\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){fig-align='center' width=672}\n:::\n:::\n\n\n## Qualitative or categorical variables\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ngroups <- as.factor(decathlon2$Competition[1:23])\nfviz_pca_ind(\n    res_pca,\n    col.ind = groups, # color by groups\n    palette = c(\"#00AFBB\",  \"#FC4E07\"),\n    addEllipses = TRUE, # Concentration ellipses\n    ellipse.type = \"confidence\",\n    legend.title = \"Groups\",\n    repel = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=672}\n:::\n:::\n\n\n## Quantitative variables\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nquanti_sup <- decathlon2[1:23, 11:12, drop = FALSE]\nhead(quanti_sup)\n##           Rank Points\n## SEBRLE       1   8217\n## CLAY         2   8122\n## BERNARD      4   8067\n## YURKOV       5   8036\n## ZSIVOCZKY    7   8004\n## McMULLEN     8   7995\n\n# Predict coordinates and compute cos2\nquanti_coord <- cor(quanti_sup, res_pca$x)\nquanti_cos2 <- quanti_coord^2\n# Graph of variables including supplementary variables\np <- fviz_pca_var(res_pca)\nfviz_add(p, quanti_coord, color =\"blue\", geom=\"arrow\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=672}\n:::\n:::\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## Reference\n\n1. [Principal Component Analysis in R: prcomp vs princomp](http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/118-principal-component-analysis-in-r-prcomp-vs-princomp)",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}