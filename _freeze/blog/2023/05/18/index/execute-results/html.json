{
  "hash": "4f14807bf6cc13a5b8feba1246626446",
  "result": {
    "markdown": "---\ntitle: \"PCA Graph Customization\"\ndate: 2023-05-18\n# date-modified: 2023-04-05\ncategories:\n  - r\n  - pca\n  - unsupervised\n  - dimensional reduction\nimage: pca_biplot.png\ndescription: Arguments to customize the PCA graph of variables and individuals.\n---\n\n\n\n\n\n## Compute PCA\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n### Load packages\nlibrary(pacman)\np_load(\n    tidyverse,  # tidy data\n    FactoMineR, # compute principal component methods\n    factoextra,  # extract, visualize and interpretate the results\n    corrplot  # visualize cos2 of variables\n)\n\n### compute pca\nhead(iris, 3)\n##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n## 1          5.1         3.5          1.4         0.2  setosa\n## 2          4.9         3.0          1.4         0.2  setosa\n## 3          4.7         3.2          1.3         0.2  setosa\n# The variable Species (index = 5) is removed\n# before PCA analysis\niris_pca <- PCA(iris[,-5], graph = FALSE)\niris_pca\n## **Results for the Principal Component Analysis (PCA)**\n## The analysis was performed on 150 individuals, described by 4 variables\n## *The results are available in the following objects:\n## \n##    name               description                          \n## 1  \"$eig\"             \"eigenvalues\"                        \n## 2  \"$var\"             \"results for the variables\"          \n## 3  \"$var$coord\"       \"coord. for the variables\"           \n## 4  \"$var$cor\"         \"correlations variables - dimensions\"\n## 5  \"$var$cos2\"        \"cos2 for the variables\"             \n## 6  \"$var$contrib\"     \"contributions of the variables\"     \n## 7  \"$ind\"             \"results for the individuals\"        \n## 8  \"$ind$coord\"       \"coord. for the individuals\"         \n## 9  \"$ind$cos2\"        \"cos2 for the individuals\"           \n## 10 \"$ind$contrib\"     \"contributions of the individuals\"   \n## 11 \"$call\"            \"summary statistics\"                 \n## 12 \"$call$centre\"     \"mean of the variables\"              \n## 13 \"$call$ecart.type\" \"standard error of the variables\"    \n## 14 \"$call$row.w\"      \"weights for the individuals\"        \n## 15 \"$call$col.w\"      \"weights for the variables\"\n```\n:::\n\n## Color individuals by groups\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfviz_pca_ind(\n  iris_pca,\n  geom.ind = \"point\", # show points only (nbut not \"text\")\n  col.ind = iris$Species, # color by groups\n  palette = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n  addEllipses = TRUE, # Concentration ellipses\n  legend.title = \"Groups\"\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){fig-align='center' width=672}\n:::\n:::\n\n## Add confidence ellipses\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfviz_pca_ind(\n  iris_pca, \n  geom.ind = \"point\", \n  col.ind = iris$Species, \n  palette = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n  addEllipses = TRUE, ellipse.type = \"confidence\",\n  legend.title = \"Groups\"\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){fig-align='center' width=672}\n:::\n\n```{.r .cell-code}\n\n### use color from jco\nfviz_pca_ind(\n  iris_pca,\n  label = \"none\", # hide individual labels\n  habillage = iris$Species, # color by groups\n  addEllipses = TRUE, # Concentration ellipses\n  palette = \"jco\"\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-2.png){fig-align='center' width=672}\n:::\n\n```{.r .cell-code}\n\n# Add confidence ellipses\nfviz_pca_ind(\n  iris_pca, \n  geom.ind = \"point\", \n  col.ind = iris$Species, # color by groups\n  palette = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n  addEllipses = TRUE, \n  ellipse.type = \"confidence\",\n  legend.title = \"Groups\"\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-3.png){fig-align='center' width=672}\n:::\n\n```{.r .cell-code}\n\n# Convex hull\nfviz_pca_ind(\n  iris_pca, \n  geom.ind = \"point\",\n  col.ind = iris$Species, # color by groups\n  palette = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n  addEllipses = TRUE, \n  ellipse.type = \"convex\",\n  legend.title = \"Groups\"\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-4.png){fig-align='center' width=672}\n:::\n:::\n\n\n## Group mean points\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfviz_pca_ind(\n  iris_pca,\n  geom.ind = \"point\", # show points only (but not \"text\")\n  group.ind = iris$Species, # color by groups\n  legend.title = \"Groups\",\n  mean.point = FALSE\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){fig-align='center' width=672}\n:::\n:::\n\n## Graphical parameters\n\nTo change easily the graphical of any ggplots, you can use the function ggpar() [ggpubr package]\n\nThe graphical parameters that can be changed using ggpar() include:\n\n- Main titles, axis labels and legend titles\n- Legend position. Possible values: “top”, “bottom”, “left”, “right”, “none”.\n- Color palette.\n- Themes. Allowed values include: theme_gray(), theme_bw(), theme_minimal(), theme_classic(), theme_void().\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nind_p <- fviz_pca_ind(iris_pca, geom = \"point\", col.ind = iris$Species)\n\nggpubr::ggpar(ind_p,\n              title = \"Principal Component Analysis\",\n              subtitle = \"Iris data set\",\n              caption = \"Source: factoextra\",\n              xlab = \"PC1\", ylab = \"PC2\",\n              legend.title = \"Species\", legend.position = \"top\",\n              ggtheme = theme_gray(), palette = \"jco\"\n              )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=672}\n:::\n:::\n\n## Biplot\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfviz_pca_biplot(\n  iris_pca, \n  col.ind = iris$Species, \n  palette = \"jco\", \n  addEllipses = TRUE, \n  label = \"var\",\n  col.var = \"black\", \n  repel = TRUE,\n  legend.title = \"Species\"\n) \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=672}\n:::\n:::\n\n## Color by groups\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfviz_pca_biplot(\n  iris_pca, \n  # Fill individuals by groups\n  geom.ind = \"point\",\n  pointshape = 21,\n  pointsize = 2.5,\n  fill.ind = iris$Species,\n  col.ind = \"black\",\n  # Color variable by groups\n  col.var = factor(c(\"sepal\", \"sepal\", \"petal\", \"petal\")),\n  legend.title = list(fill = \"Species\", color = \"Clusters\"),\n  repel = TRUE        # Avoid label overplotting\n) +\n  ggpubr::fill_palette(\"jco\")+      # Indiviual fill color\n  ggpubr::color_palette(\"npg\")      # Variable colors\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=672}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfviz_pca_biplot(\n  iris_pca, \n  # Individuals\n  geom.ind = \"point\",\n  fill.ind = iris$Species, \n  col.ind = \"black\",\n  pointshape = 21, \n  pointsize = 2,\n  palette = \"jco\",\n  addEllipses = TRUE,\n  # Variables\n  alpha.var =\"contrib\", \n  col.var = \"contrib\",\n  gradient.cols = \"RdYlBu\",\n  legend.title = list(\n    fill = \"Species\", \n    color = \"Contrib\", \n    alpha = \"Contrib\"\n    )\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){fig-align='center' width=672}\n:::\n:::\n\n\n## Reference\n\n- [Principal Component Methods in R: Practical Guide](http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/)\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}