{
  "hash": "55d2dba74ccfda504d30a65a25000f22",
  "result": {
    "markdown": "---\ntitle: \"Essentials for Principal Component Analysis \"\ndate: 2023-05-14\n# date-modified: 2023-04-05\ncategories:\n  - PCA\nimage: iris_pca.png\n---\n\n\n\n![](pca.png)\n\nPrinciple component methods are used to summarize and viusalize the information contained in a large multivariate datasets.\n\nPrinciple component analysis is used to extract the important information from a multivariate data table and to express this information as a set of few new variables called principle components. These new variables correspond to a linear combination of the originals. The number of principal components is less than or equal to the number of original variables.\n\nPCA assumes that the directions with the largest variances are the most “important” (i.e, the most principal).\n\nTechnically speaking, the amount of variance retained by each principal component is measured by the so-called eigenvalue.\n\nNote that, the PCA method is particularly useful when the variables within the data set are highly correlated. Correlation indicates that there is redundancy in the data. Due to this redundancy, PCA can be used to reduce the original variables into a smaller number of new variables ( = principal components) explaining most of the variance in the original variables.\n\n\n\nTaken together, the main purpose of principal component analysis is to:\n\n  - identify hidden pattern in a data set,\n  - reduce the dimensionnality of the data by removing the noise and redundancy in the data,\n  - identify correlated variables\n\n![](pca2.png)\n\n## Compute PCA\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n### Load packages\nlibrary(pacman)\np_load(\n    tidyverse,  # tidy data\n    FactoMineR, # compute principal component methods\n    factoextra  # extract, visualize and interpretate the results\n)\n\n### subset active individuals and active variables\ndata(decathlon2)\ndecathlon2_active <- decathlon2[1:23, 1:10]\nhead(decathlon2_active[, 1:6], 4)\n##         X100m Long.jump Shot.put High.jump X400m X110m.hurdle\n## SEBRLE  11.04      7.58    14.83      2.07 49.81        14.69\n## CLAY    10.76      7.40    14.26      1.86 49.37        14.05\n## BERNARD 11.02      7.23    14.25      1.92 48.93        14.99\n## YURKOV  11.34      7.09    15.19      2.10 50.42        15.31\n\n### compute pca\nres_pca <- PCA(decathlon2_active, graph = FALSE)\nres_pca\n## **Results for the Principal Component Analysis (PCA)**\n## The analysis was performed on 23 individuals, described by 10 variables\n## *The results are available in the following objects:\n## \n##    name               description                          \n## 1  \"$eig\"             \"eigenvalues\"                        \n## 2  \"$var\"             \"results for the variables\"          \n## 3  \"$var$coord\"       \"coord. for the variables\"           \n## 4  \"$var$cor\"         \"correlations variables - dimensions\"\n## 5  \"$var$cos2\"        \"cos2 for the variables\"             \n## 6  \"$var$contrib\"     \"contributions of the variables\"     \n## 7  \"$ind\"             \"results for the individuals\"        \n## 8  \"$ind$coord\"       \"coord. for the individuals\"         \n## 9  \"$ind$cos2\"        \"cos2 for the individuals\"           \n## 10 \"$ind$contrib\"     \"contributions of the individuals\"   \n## 11 \"$call\"            \"summary statistics\"                 \n## 12 \"$call$centre\"     \"mean of the variables\"              \n## 13 \"$call$ecart.type\" \"standard error of the variables\"    \n## 14 \"$call$row.w\"      \"weights for the individuals\"        \n## 15 \"$call$col.w\"      \"weights for the variables\"\n```\n:::\n\n\n\n## Visualization and interpretation\n\n### Eigenvalues/Variances\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n### eigenvalues measure the amount of variation retained by each principal component\neig_val <- get_eigenvalue(res_pca)\neig_val\n##        eigenvalue variance.percent cumulative.variance.percent\n## Dim.1   4.1242133        41.242133                    41.24213\n## Dim.2   1.8385309        18.385309                    59.62744\n## Dim.3   1.2391403        12.391403                    72.01885\n## Dim.4   0.8194402         8.194402                    80.21325\n## Dim.5   0.7015528         7.015528                    87.22878\n## Dim.6   0.4228828         4.228828                    91.45760\n## Dim.7   0.3025817         3.025817                    94.48342\n## Dim.8   0.2744700         2.744700                    97.22812\n## Dim.9   0.1552169         1.552169                    98.78029\n## Dim.10  0.1219710         1.219710                   100.00000\n\n### scree plot\nfviz_eig(res_pca, addlabels = TRUE, ylim = c(0, 50))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){fig-align='center' width=672}\n:::\n:::\n\n\n### Variables\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n\nvar <- get_pca_var(res_pca)\n# Coordinates\nhead(var$coord)\n##                   Dim.1       Dim.2      Dim.3       Dim.4      Dim.5\n## X100m        -0.8506257 -0.17939806  0.3015564  0.03357320 -0.1944440\n## Long.jump     0.7941806  0.28085695 -0.1905465 -0.11538956  0.2331567\n## Shot.put      0.7339127  0.08540412  0.5175978  0.12846837 -0.2488129\n## High.jump     0.6100840 -0.46521415  0.3300852  0.14455012  0.4027002\n## X400m        -0.7016034  0.29017826  0.2835329  0.43082552  0.1039085\n## X110m.hurdle -0.7641252 -0.02474081  0.4488873 -0.01689589  0.2242200\n# Cos2: quality on the factore map\nhead(var$cos2)\n##                  Dim.1        Dim.2      Dim.3        Dim.4      Dim.5\n## X100m        0.7235641 0.0321836641 0.09093628 0.0011271597 0.03780845\n## Long.jump    0.6307229 0.0788806285 0.03630798 0.0133147506 0.05436203\n## Shot.put     0.5386279 0.0072938636 0.26790749 0.0165041211 0.06190783\n## High.jump    0.3722025 0.2164242070 0.10895622 0.0208947375 0.16216747\n## X400m        0.4922473 0.0842034209 0.08039091 0.1856106269 0.01079698\n## X110m.hurdle 0.5838873 0.0006121077 0.20149984 0.0002854712 0.05027463\n# Contributions to the principal components\nhead(var$contrib)\n##                  Dim.1      Dim.2     Dim.3       Dim.4     Dim.5\n## X100m        17.544293  1.7505098  7.338659  0.13755240  5.389252\n## Long.jump    15.293168  4.2904162  2.930094  1.62485936  7.748815\n## Shot.put     13.060137  0.3967224 21.620432  2.01407269  8.824401\n## High.jump     9.024811 11.7715838  8.792888  2.54987951 23.115504\n## X400m        11.935544  4.5799296  6.487636 22.65090599  1.539012\n## X110m.hurdle 14.157544  0.0332933 16.261261  0.03483735  7.166193\n```\n:::\n\n\n### color by groups\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhead(iris, 3)\n##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n## 1          5.1         3.5          1.4         0.2  setosa\n## 2          4.9         3.0          1.4         0.2  setosa\n## 3          4.7         3.2          1.3         0.2  setosa\niris_pca <- PCA(iris[, -5], graph = FALSE)\n\nfviz_pca_ind(\n  iris_pca,\n  geom.ind = \"point\", # show points only\n  col.ind = iris$Species, # color by groups\n  palette = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n  addEllipses = TRUE, # concentratoin ellipse\n  legend.title = \"Groups\"\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){fig-align='center' width=672}\n:::\n\n```{.r .cell-code}\n\n# Add confidence ellipses\nfviz_pca_ind(\n  iris_pca, \n  geom.ind = \"point\", \n  col.ind = iris$Species, \n  palette = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n  addEllipses = TRUE, \n  ellipse.type = \"confidence\",\n  legend.title = \"Groups\"\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-2.png){fig-align='center' width=672}\n:::\n\n```{.r .cell-code}\n\nfviz_pca_ind(\n  iris_pca,\n  label = \"none\", # hide individual labels\n  habillage = iris$Species, # color by groups\n  addEllipses = TRUE, # Concentration ellipses\n  palette = \"jco\"\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-3.png){fig-align='center' width=672}\n:::\n\n```{.r .cell-code}\n\n# Variables on dimensions 2 and 3\nfviz_pca_var(res_pca, axes = c(2, 3))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-4.png){fig-align='center' width=672}\n:::\n\n```{.r .cell-code}\n# Individuals on dimensions 2 and 3\nfviz_pca_ind(res_pca, axes = c(2, 3))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-5.png){fig-align='center' width=672}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Show variable points and text labels\nfviz_pca_var(res_pca, geom.var = c(\"point\", \"text\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=672}\n:::\n\n```{.r .cell-code}\n\n# Show individuals text labels only\nfviz_pca_ind(res_pca, geom.ind =  \"text\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-2.png){fig-align='center' width=672}\n:::\n\n```{.r .cell-code}\n\n# Change the size of arrows an labels\nfviz_pca_var(\n  res_pca, \n  arrowsize = 1, \n  labelsize = 5, \n  repel = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-3.png){fig-align='center' width=672}\n:::\n\n```{.r .cell-code}\n\n# Change points size, shape and fill color\n# Change labelsize\nfviz_pca_ind(\n  res_pca, \n  pointsize = 3, \n  pointshape = 21, \n  fill = \"lightblue\",\n  labelsize = 5, \n  repel = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-4.png){fig-align='center' width=672}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Add confidence ellipses\nfviz_pca_ind(\n  iris_pca, \n  geom.ind = \"point\", \n  col.ind = iris$Species, # color by groups\n  palette = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n  addEllipses = TRUE, \n  ellipse.type = \"confidence\",\n  legend.title = \"Groups\"\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=672}\n:::\n\n```{.r .cell-code}\n\n# Convex hull\nfviz_pca_ind(\n  iris_pca, \n  geom.ind = \"point\",\n  col.ind = iris$Species, # color by groups\n  palette = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n  addEllipses = TRUE, \n  ellipse.type = \"convex\",\n  legend.title = \"Groups\"\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-2.png){fig-align='center' width=672}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfviz_pca_ind(\n  iris_pca,\n  geom.ind = \"point\", # show points only (but not \"text\")\n  group.ind = iris$Species, # color by groups\n  legend.title = \"Groups\",\n  mean.point = FALSE\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=672}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nind.p <- fviz_pca_ind(\n  iris_pca, \n  geom = \"point\", \n  col.ind = iris$Species\n)\n\nggpubr::ggpar(\n  ind.p,\n  title = \"Principal Component Analysis\",\n  subtitle = \"Iris data set\",\n  caption = \"Source: factoextra\",\n  xlab = \"PC1\", ylab = \"PC2\",\n  legend.title = \"Species\", \n  legend.position = \"top\",\n  ggtheme = theme_gray(), palette = \"jco\"\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){fig-align='center' width=672}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfviz_pca_biplot(res_pca, repel = TRUE,\n                col.var = \"#2E9FDF\", # Variables color\n                col.ind = \"#696969\"  # Individuals color\n                )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){fig-align='center' width=672}\n:::\n\n```{.r .cell-code}\n\nfviz_pca_biplot(\n  iris_pca, \n  col.ind = iris$Species, \n  palette = \"jco\", \n  addEllipses = TRUE, \n  label = \"var\",\n  col.var = \"black\", \n  repel = TRUE,\n  legend.title = \"Species\"\n) \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-2.png){fig-align='center' width=672}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfviz_pca_biplot(\n  iris_pca, \n  # Fill individuals by groups\n  geom.ind = \"point\",\n  pointshape = 21,\n  pointsize = 2.5,\n  fill.ind = iris$Species,\n  col.ind = \"black\",\n  # Color variable by groups\n  col.var = factor(c(\"sepal\", \"sepal\", \"petal\", \"petal\")),\n  \n  legend.title = list(fill = \"Species\", color = \"Clusters\"),\n  repel = TRUE    # Avoid label overplotting\n)+\n  ggpubr::fill_palette(\"jco\")+      # Indiviual fill color\n  ggpubr::color_palette(\"npg\")      # Variable colors\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){fig-align='center' width=672}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfviz_pca_biplot(\n  iris_pca, \n  # Individuals\n  geom.ind = \"point\",\n  fill.ind = iris$Species, \n  col.ind = \"black\",\n  pointshape = 21, \n  pointsize = 2,\n  palette = \"jco\",\n  addEllipses = TRUE,\n  # Variables\n  alpha.var =\"contrib\", \n  col.var = \"contrib\",\n  gradient.cols = \"RdYlBu\",\n  legend.title = list(\n    fill = \"Species\", \n    color = \"Contrib\",\n    alpha = \"Contrib\"\n    )\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){fig-align='center' width=672}\n:::\n:::\n\n\n## Reference\n\n1. [Principal Component Methods in R: Practical Guide](http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/)\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}