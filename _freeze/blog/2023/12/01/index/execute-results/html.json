{
  "hash": "512db48fd89e8926759c32b953f2b34f",
  "result": {
    "markdown": "---\ntitle: \"Use colorblind-friendly palette for visualization\"\ndate: 2023-12-01\ndate-modified: last-modified\ncategories:\n  - colors\n  - ggplot2\nimage: colorblind_palette.jpg\ndescription: Use ggplot2 to make nice coordinate, colors, and size with friendly colors.\n---\n\n\n\n## Color packages\n\n![](colorblind_palette.jpg)\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(here)\nlibrary(tidyverse)\nlibrary(patchwork)\nlibrary(ggsci)\nlibrary(Seurat)\nlibrary(RColorBrewer)\nlibrary(viridis)\nlibrary(paletteer)\nlibrary(cols4all)\nlibrary(RImagePalette)\nlibrary(scales)\n```\n:::\n\n\n\n## Basic colors \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# gray colors\ncbp <- c(\"gray\", \"lightgray\", \"darkgray\", \"black\")\nbarplot(1:4, col = cbp)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){fig-align='center' width=100%}\n:::\n\n```{.r .cell-code}\n# 4 colors\ncbp <- c(\n  \"#b8b8b8\", \"#02ff00\", \"#f9a506\", \"#ff3c31\"\n)\nbarplot(1:4, col = cbp)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-2.png){fig-align='center' width=100%}\n:::\n\n```{.r .cell-code}\n# 6 colors\ncbp <- c(\n  \"#4C72B0\", \"#55A868\", \"#C44E52\", \"#8172B2\", \"#CCB974\", \"#64B5CD\"\n)\nbarplot(1:6, col = cbp)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-3.png){fig-align='center' width=100%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# 8 colors\ncbp <- c(\n  \"#999999\", \"#E69F00\", \"#56B4E9\", \"#009E73\", \"#F0E442\", \"#0072B2\", \n  \"#D55E00\", \"#CC79A7\"\n)\nbarplot(1:8, col = cbp)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){fig-align='center' width=100%}\n:::\n\n```{.r .cell-code}\n# 9 colors\ncbp <- c(\n    \"#000000\", \"#999999\", \"#E69F00\", \"#56B4E9\", \"#009E73\", \"#F0E442\", \n    \"#0072B2\", \"#D55E00\", \"#CC79A7\"\n)\nbarplot(1:9, col = cbp)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-2.png){fig-align='center' width=100%}\n:::\n:::\n\n## Color()\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nload(here(\"projects\", \"2023_scRNA_Seurat\", \"pbmc_tutorial.RData\"))\n# 657 colors\nlength(colors())\n## [1] 657\nshow_col(colors()[1:50])\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){fig-align='center' width=100%}\n:::\n\n```{.r .cell-code}\ncbp <-c(\n  \"#80d7e1\",\"#e4cbf2\",\"#ffb7ba\",\"#bf5046\",\"#b781d2\",\"#ece7a3\",          \"#f5cbe1\",\"#e6e5e3\",\"#d2b5ab\",\"#d9e3f5\",\"#f29432\",\"#9c9895\"\n)\nshow_col(cbp)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-2.png){fig-align='center' width=100%}\n:::\n\n```{.r .cell-code}\n## Single cell plot\np1 <- DimPlot(pbmc, reduction = \"umap\",label = T) + NoLegend()\np2 <- DimPlot(pbmc, reduction = \"umap\",cols = cbp,label = T)+ NoLegend()\np1 + p2\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-3.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## RColorBrewer\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(RColorBrewer)\ndisplay.brewer.all()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=100%}\n:::\n\n```{.r .cell-code}\ncol <- brewer.pal(9, \"Set1\")\nb1 <- brewer.pal(9, \"Set1\")\nb2 <- brewer.pal(8, \"Set2\")\nmycolor <- c(b1,b2) \n```\n:::\n\n## ggsci\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(ggsci)\n# vignette(\"ggsci\")\nDimPlot(pbmc, reduction = \"umap\", label = TRUE) + \n  scale_color_nejm() +\n  NoLegend()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=100%}\n:::\n\n```{.r .cell-code}\nmycolor <- pal_nejm(\"default\", alpha = 0.5)(8) \n```\n:::\n\n## paletteer\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(paletteer)  \npaletteer_c(\"scico::berlin\", n = 10)\n## <colors>\n## #9EB0FFFF #5AA3DAFF #2D7597FF #194155FF #11181DFF #270C01FF #501802FF #8A3F2AFF #C37469FF #FFACACFF\npaletteer_d(\"RColorBrewer::Paired\",n=12)\n## <colors>\n## #A6CEE3FF #1F78B4FF #B2DF8AFF #33A02CFF #FB9A99FF #E31A1CFF #FDBF6FFF #FF7F00FF #CAB2D6FF #6A3D9AFF #FFFF99FF #B15928FF\npaletteer_dynamic(\"cartography::green.pal\", 20)\n## <colors>\n## #E5F0DAFF #D9E8CEFF #CDE1C2FF #C1D9B6FF #B5D2AAFF #A9CB9FFF #9DC393FF #91BC87FF #85B47BFF #75AA6BFF #65A15CFF #55974CFF #458D3DFF #35832DFF #287721FF #22651DFF #1C5319FF #164116FF #102F12FF #0A1E0FFF\n```\n:::\n\n## cols4all\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# remotes::install_github(\"mtennekes/cols4all\")\nlibrary(cols4all)\n# c4a_gui()\nmycolor <-c4a(\"light24\", 9)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Color from：Nat Med. 2019 Aug;25(8):1251-1259. \ncbp <-c(\n    \"#80d7e1\",\"#e4cbf2\",\"#ffb7ba\",\"#bf5046\",\"#b781d2\",\"#ece7a3\",\n    \"#f5cbe1\",\"#e6e5e3\",\"#d2b5ab\",\"#d9e3f5\",\"#f29432\",\"#9c9895\"\n)\nshow_col(cbp, labels = TRUE)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){fig-align='center' width=100%}\n:::\n\n```{.r .cell-code}\nDimPlot(pbmc, reduction = \"umap\", group.by='seurat_clusters', label = T) +\n  scale_color_manual(values = cbp)+\n  NoLegend()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-2.png){fig-align='center' width=100%}\n:::\n\n```{.r .cell-code}\n\n# Color from：Immunity. 2020 May 19;52(5):808-824.e7.\ncbp <- c(\n   \"#e41e25\",\"#307eb9\",\"#4cb049\",\"#974e9e\",\"#f57f21\",\"#f4ed35\",\n  \"#a65527\",\"#9bc7e0\",\"#b11f2b\",\"#f6b293\"\n)\nshow_col(cbp, labels = TRUE)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-3.png){fig-align='center' width=100%}\n:::\n\n```{.r .cell-code}\nDimPlot(pbmc, reduction = \"umap\", group.by='seurat_clusters', label=T) + \n  scale_color_manual(values = cbp)+\n  NoLegend()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-4.png){fig-align='center' width=100%}\n:::\n\n```{.r .cell-code}\n\n# Color from：Cell. 2019 Oct 31;179(4):829-845.e20.\ncbp <- c(\n  \"#b38a8f\",\"#bba6a6\",\"#d5b3a5\",\"#e69db8\",\"#c5ae8d\",\"#87b2d4\",\n  \"#babb72\",\"#4975a5\",\"#499994\",\"#8e8786\",\"#93a95d\",\"#f19538\",\n  \"#fcba75\",\"#8ec872\",\"#ad9f35\",\"#8ec872\",\"#d07794\",\"#ff9796\",\n  \"#b178a3\",\"#e56464\",\"#6cb25e\",\"#ca9abe\",\"#d6b54c\"\n)\nshow_col(cbp, labels = TRUE)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-5.png){fig-align='center' width=100%}\n:::\n\n```{.r .cell-code}\nDimPlot(pbmc, reduction = \"umap\", group.by='seurat_clusters', label = T) + \n  scale_color_manual(values = cbp) +\n  NoLegend()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-6.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Pick color from images  \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# devtools::install_github(\"joelcarlson/RImagePalette\")\nlibrary(RImagePalette)\nlifeAquatic <- jpeg::readJPEG(\"color.jpg\")\ndisplay_image(lifeAquatic)\nmycolor <- image_palette(lifeAquatic, n=16) \nshow_col(mycolor)\n```\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}