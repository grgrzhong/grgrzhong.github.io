{
  "hash": "6392fa2ace22ad83e94dbdbced8368c4",
  "result": {
    "markdown": "---\ntitle: \"Visualizing clusters with heatmaps\"\nimage: pheatmap.png\ndate: 2023-04-01\ncategories:\n  - R\n  - ComplexHeatmap\n---\n\n\n\n\n## Heatmap packages \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(pheatmap) ## for heatmap generation\nlibrary(tidyverse) ## for data wrangling\nlibrary(ggplotify) ## to convert pheatmap to ggplot2\nlibrary(heatmaply) ## for constructing interactive heatmap\nlibrary(ComplexHeatmap)\n```\n:::\n\n## Prepare data\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntest <- matrix(rnorm(200), 20, 10)\ntest[1:10, seq(1, 10, 2)] <- test[1:10, seq(1, 10, 2)] + 3\ntest[11:20, seq(2, 10, 2)] <- test[11:20, seq(2, 10, 2)] + 2\ntest[15:20, seq(2, 10, 2)] <- test[15:20, seq(2, 10, 2)] + 4\ncolnames(test) <- paste(\"Test\", 1:10, sep = \"\")\nrownames(test) <- paste(\"Gene\", 1:20, sep = \"\")\ntest\n##              Test1       Test2      Test3       Test4        Test5      Test6\n## Gene1   3.29827612 -0.87621651  2.7763138  0.09023811  3.618493465  0.7716333\n## Gene2   4.98815846  0.85613103  1.7319032  0.86449530  1.678122771  0.3063586\n## Gene3   2.30836740  0.54392227  1.4654226  0.98232003  4.239514019  0.6131728\n## Gene4   2.03641113  1.93977017  5.5442658  0.42551107  4.353064323  0.1787913\n## Gene5   3.41076022  0.19785817  3.9798210 -1.44468005  3.291673164  0.3663163\n## Gene6   3.62247747 -0.01434155  5.2423116 -0.08013944  1.337763142 -0.3149104\n## Gene7   3.60511906 -0.95017171  3.7245990  0.45132414  3.373480793 -1.0698939\n## Gene8   3.06322744  1.17350558  3.8383914 -0.71846961  4.395249013  1.2312440\n## Gene9   3.60299559 -1.20299328  2.7723816 -0.47883496  2.623612712 -1.0448883\n## Gene10  1.57074874 -0.92120129  2.9280791 -2.42319122  2.601444580  0.4092615\n## Gene11  0.38743437  1.30621782 -1.9002927  2.81676717  3.571799140  2.6507903\n## Gene12  0.60254094  3.07975833  0.3312724  1.32990754 -0.913924754  0.8222173\n## Gene13 -2.99340648  0.94196602 -1.1178386  1.46727131  0.033702398  0.4191317\n## Gene14 -0.79358934  1.80527546 -0.4291855  2.24838476  0.009060976  3.5132369\n## Gene15  0.09342517  4.38786150  0.1032278  6.34090782 -0.661074009  5.4086261\n## Gene16 -0.13066651  6.48652551 -0.8233148  5.36138950  0.757969768  6.5648108\n## Gene17  0.94325699  6.02381783 -0.8873547  6.89115106 -0.465953785  6.3928607\n## Gene18  0.28664942  7.04536746 -0.1479087  5.83668501 -0.581045125  5.0488453\n## Gene19 -0.82632179  7.59115045 -0.4218928  5.19480416 -0.952507525  6.2336783\n## Gene20 -0.63727861  6.33235953 -0.4793741  6.10040439  0.351843594  6.3247202\n##              Test7      Test8      Test9     Test10\n## Gene1   1.37707232 -0.6483669  3.5637635  1.7895930\n## Gene2   3.44835165  0.3194182  1.4739887 -0.4208579\n## Gene3   3.32711848  1.1797726  1.9687826  0.5982648\n## Gene4   2.78165284 -2.1386344  2.3982715 -1.2117740\n## Gene5   3.23381377 -0.3854446  2.7541032  0.9082663\n## Gene6   3.68377788 -0.5944368  3.9205032  1.5895425\n## Gene7   2.32831971  0.5879925  3.6706443  0.1172051\n## Gene8   2.78568909  2.4371306  3.3729743 -1.3365536\n## Gene9   2.08232781 -0.7971552  2.5924048  1.9071499\n## Gene10  2.56994782 -1.5646306  2.6046343  0.2021302\n## Gene11  0.09859900  2.5173789 -1.9075033  0.7557390\n## Gene12  0.85810535  0.4840679 -1.7887879  1.7645325\n## Gene13  0.14359343  2.2054778  1.5143368  2.1135658\n## Gene14  0.20139344  3.5131069 -0.1083876  2.3139663\n## Gene15  2.63833994  6.0456605  1.6759728  6.3912360\n## Gene16  0.81881541  5.1486048  1.0172390  7.1951253\n## Gene17 -0.68850831  7.2381241  0.4273698  5.7447285\n## Gene18 -0.81075009  7.8784650  1.4742341  6.4288431\n## Gene19  1.79463987  4.1920376 -1.2279247  5.7135620\n## Gene20  0.04720069  5.3135131 -0.8385567  5.6329396\n```\n:::\n\n## pheatmap\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n### Add anotation col\nannotation_col <- data.frame(\n  CellType = factor(rep(c(\"CT1\", \"CT2\"), 5)),\n  Time = 1:5\n)\nrownames(annotation_col) <- paste(\"Test\", 1:10, sep = \"\")\n\nannotation_row <- data.frame(\n  GeneClass = factor(rep(c(\"Path1\", \"Path2\", \"Path3\"), c(10, 4, 6)))\n)\nrownames(annotation_row) <- paste(\"Gene\", 1:20, sep = \"\")\n\nann_colors <- list(\n  Time = c(\"white\", \"firebrick\"),\n  CellType = c(CT1 = \"#1B9E77\", CT2 = \"#D95F02\"),\n  GeneClass = c(Path1 = \"#7570B3\", Path2 = \"#E7298A\", Path3 = \"#66A61E\")\n)\npheatmap(test,\n  annotation_col = annotation_col,\n  annotation_row = annotation_row,\n  annotation_colors = ann_colors\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){fig-align='center' width=100%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n### split column and row\npheatmap(test,\n  annotation_col = annotation_col,\n  annotation_row = annotation_row,\n  annotation_colors = ann_colors,\n  row_split = annotation_row$GeneClass,\n  column_split = annotation_col$CellType\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){fig-align='center' width=100%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n## Combine multiple heatmap\np1 <- pheatmap(test, name = \"mat1\")\np2 <- rowAnnotation(foo = anno_barplot(1:nrow(test)))\np3 <- pheatmap(test,\n  name = \"mat2\",\n  col = c(\"navy\", \"white\", \"firebrick3\")\n)\np1 + p2 + p3\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=100%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n## Don't cluster\npheatmap(test,\n  annotation_col = annotation_col,\n  annotation_row = annotation_row,\n  annotation_colors = ann_colors,\n  row_split = annotation_row$GeneClass,\n  column_split = annotation_col$CellType,\n  cluster_rows = FALSE,\n  cluster_cols = FALSE\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Reference\n\n1. <https://jokergoo.github.io/ComplexHeatmap-reference/book/index.html>\n2. <https://jcoliver.github.io/learn-r/006-heatmaps.html>\n3. <https://statisticsglobe.com/draw-heatmap-like-plot-categorical-variables-r>\n4. <https://btep.ccr.cancer.gov/docs/data-visualization-with-r/Lesson5_intro_to_ggplot/>\n\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}