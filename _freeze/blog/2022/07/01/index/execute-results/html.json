{
  "hash": "c67d6eefd0931826925a933b3e986712",
  "result": {
    "markdown": "---\ntitle: \"Volano plot with ggvolcano\"\ndate: 2022-07-01\nimage: ggvolcano.png\ncategories:\n  - ggvolcano\n  - R\n# draft: true\n---\n\n\n\n\n\n## ggvolcano\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(ggVolcano)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndata(deg_data)\nview(deg_data)\ndata <- add_regulate(deg_data,\n  log2FC_name = \"log2FoldChange\",\n  fdr_name = \"padj\", log2FC = 1, fdr = 0.05\n) # add column\n\nggvolcano(data,\n  x = \"log2FoldChange\", y = \"padj\",\n  label = \"row\", label_number = 10, output = FALSE\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){fig-align='center' width=85%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Change the fill and color manually:\np1 <- ggvolcano(data,\n  x = \"log2FoldChange\", y = \"padj\",\n  fills = c(\"#e94234\", \"#b4b4d8\", \"#269846\"),\n  colors = c(\"#e94234\", \"#b4b4d8\", \"#269846\"),\n  label = \"row\", label_number = 10, output = FALSE\n)\n\np2 <- ggvolcano(data,\n  x = \"log2FoldChange\", y = \"padj\",\n  label = \"row\", label_number = 10, output = FALSE\n) +\n  ggsci::scale_color_aaas() +\n  ggsci::scale_fill_aaas()\n## Scale for colour is already present.\n## Adding another scale for colour, which will replace the existing scale.\n## Scale for fill is already present.\n## Adding another scale for fill, which will replace the existing scale.\n#> Scale for 'colour' is already present. Adding another scale for 'colour', which\n#> will replace the existing scale.\n#> Scale for 'fill' is already present. Adding another scale for 'fill', which\n#> will replace the existing scale.\n\nlibrary(patchwork)\np1 | p2\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\n## gradual_volcano\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# plot\ngradual_volcano(deg_data,\n  x = \"log2FoldChange\", y = \"padj\",\n  label = \"row\", label_number = 10, output = FALSE\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){fig-align='center' width=85%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(RColorBrewer)\n\n# Change the fill and color manually:\np1 <- gradual_volcano(data,\n  x = \"log2FoldChange\", y = \"padj\",\n  fills = brewer.pal(5, \"RdYlBu\"),\n  colors = brewer.pal(8, \"RdYlBu\"),\n  label = \"row\", label_number = 10, output = FALSE\n)\n\np2 <- gradual_volcano(data,\n  x = \"log2FoldChange\", y = \"padj\",\n  label = \"row\", label_number = 10, output = FALSE\n) +\n  ggsci::scale_color_gsea() +\n  ggsci::scale_fill_gsea()\n## Scale for colour is already present.\n## Adding another scale for colour, which will replace the existing scale.\n## Scale for fill is already present.\n## Adding another scale for fill, which will replace the existing scale.\n#> Scale for 'colour' is already present. Adding another scale for 'colour', which\n#> will replace the existing scale.\n#> Scale for 'fill' is already present. Adding another scale for 'fill', which\n#> will replace the existing scale.\n\nlibrary(patchwork)\np1 | p2\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\n## term_volcano for go pathway\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndata(\"term_data\")\n\n# plot\nterm_volcano(deg_data, term_data,\n  x = \"log2FoldChange\", y = \"padj\",\n  label = \"row\", label_number = 10, output = FALSE\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=85%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(RColorBrewer)\n\n# Change the fill and color manually:\ndeg_point_fill <- brewer.pal(5, \"RdYlBu\")\nnames(deg_point_fill) <- unique(term_data$term)\n\nterm_volcano(data, term_data,\n  x = \"log2FoldChange\", y = \"padj\",\n  normal_point_color = \"#75aadb\",\n  deg_point_fill = deg_point_fill,\n  deg_point_color = \"grey\",\n  legend_background_fill = \"#deeffc\",\n  label = \"row\", label_number = 10, output = FALSE\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\n## Reference\n\n1. <https://github.com/BioSenior/ggGantt>\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}