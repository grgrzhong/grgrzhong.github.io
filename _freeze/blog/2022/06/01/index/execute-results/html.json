{
  "hash": "73ba2dccd9a3679c37038fb1d2285e56",
  "result": {
    "markdown": "---\ntitle: \"Visualizing clusters with heatmaps\"\nimage: pheatmap.png\ndate: 2022-06-01\ncategories:\n  - pheatmap\n  - R\n---\n\n\n\n\n## Heatmap packages \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(pheatmap) ## for heatmap generation\nlibrary(tidyverse) ## for data wrangling\nlibrary(ggplotify) ## to convert pheatmap to ggplot2\nlibrary(heatmaply) ## for constructing interactive heatmap\nlibrary(ComplexHeatmap)\n```\n:::\n\n## Prepare data\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntest <- matrix(rnorm(200), 20, 10)\ntest[1:10, seq(1, 10, 2)] <- test[1:10, seq(1, 10, 2)] + 3\ntest[11:20, seq(2, 10, 2)] <- test[11:20, seq(2, 10, 2)] + 2\ntest[15:20, seq(2, 10, 2)] <- test[15:20, seq(2, 10, 2)] + 4\ncolnames(test) <- paste(\"Test\", 1:10, sep = \"\")\nrownames(test) <- paste(\"Gene\", 1:20, sep = \"\")\ntest\n##              Test1      Test2       Test3       Test4       Test5      Test6\n## Gene1   2.96961490  0.2596813  2.28606692 -0.23526810  2.36314724  0.6742177\n## Gene2   1.53805881  0.2008400  3.12660363 -0.84580257  1.74490243 -0.7179923\n## Gene3   2.21302240  0.2250813  2.37980533  0.60858224  3.54192320 -0.5959228\n## Gene4   2.85646638 -0.0522772  3.65689100  1.11336492  2.14690747 -0.6226544\n## Gene5   3.83777450 -0.3497523  1.46891133 -0.09623570  2.07394416 -0.2521980\n## Gene6   1.27648363 -0.2751262  4.08158718  1.63260782  1.19983301 -0.8609648\n## Gene7   4.30985159  1.4995259  1.98110622  1.59691493  3.41531577  1.0350832\n## Gene8   2.37368821  1.5699257  1.96114507 -0.18598372  2.53615512 -0.4109913\n## Gene9   4.02399704  0.6074831  4.00139011 -0.38755510  2.47673349 -0.8990361\n## Gene10  2.28014086  0.3772401  3.48582364 -0.08737544  1.59951711  1.4040083\n## Gene11  0.11705451  3.0433266  0.24321154  3.44233215 -1.08728636  1.9271106\n## Gene12 -0.71629138  2.0370444 -0.05421714  2.54767306  0.08269424  1.0415170\n## Gene13  0.37368356  2.0683409  0.35488899  1.30387756  1.33605415  1.8852607\n## Gene14 -0.96135035  1.2435812  1.89534716  2.25051370 -0.46132662 -0.2189456\n## Gene15  0.31974140  7.0532257  0.69917130  5.80564639  0.37592850  6.0581652\n## Gene16 -0.41099310  5.7581710  1.20376860  6.67088364  1.44650460  7.6227855\n## Gene17 -2.90271445  7.8540875 -0.72553657  7.38151560  1.53661074  4.3891962\n## Gene18  0.03161165  6.2196783  1.16710887  4.80491899 -0.14127037  6.5975239\n## Gene19  0.20585848  5.1183309 -0.26847068  6.85245485 -0.37051675  6.0979973\n## Gene20 -2.41038721  5.8917437  1.32646206  4.77631969  1.05316261  7.9000124\n##              Test7      Test8      Test9      Test10\n## Gene1   4.01212681  0.7297610  2.9570961 -0.83288838\n## Gene2   2.85326485  1.2991572  2.2954332 -0.81649495\n## Gene3   2.50877300  0.3287670  4.0506180 -1.44174288\n## Gene4   4.16256354  0.6816066  3.1772868 -0.56232602\n## Gene5   4.10327535  0.1534220  2.9481228 -0.03276101\n## Gene6   2.33812086 -1.2908672  1.5848757 -0.43483730\n## Gene7   2.99902510 -1.2676953  2.8438640  0.90887190\n## Gene8   4.50837756  1.0095248  2.6933994  1.07601474\n## Gene9   3.00902773 -0.9725028  2.1200360  0.17817904\n## Gene10  1.45379275 -1.1105594  2.7398896  0.08035392\n## Gene11 -0.44695217  3.3284341 -0.9917321  2.35106289\n## Gene12 -1.73921163  3.8651728  0.2506426  1.45971754\n## Gene13 -0.69951016  1.2570591  0.4222554  0.07858501\n## Gene14  0.69266052  3.0832400  0.9357311  1.16585234\n## Gene15  0.13355462  7.3766240 -1.3657743  6.87450648\n## Gene16  0.08916383  6.7372908  0.3043837  7.92828770\n## Gene17  0.63512566  7.1361167  1.2163559  5.11276042\n## Gene18  0.47340784  7.3441905 -1.4275964  6.29149237\n## Gene19  0.64793691  9.3093163  0.1990851  5.27811327\n## Gene20  1.08394131  7.9835794  0.1338681  5.48235186\n```\n:::\n\n## pheatmap\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n### Add anotation col\nannotation_col <- data.frame(\n  CellType = factor(rep(c(\"CT1\", \"CT2\"), 5)),\n  Time = 1:5\n)\nrownames(annotation_col) <- paste(\"Test\", 1:10, sep = \"\")\n\nannotation_row <- data.frame(\n  GeneClass = factor(rep(c(\"Path1\", \"Path2\", \"Path3\"), c(10, 4, 6)))\n)\nrownames(annotation_row) <- paste(\"Gene\", 1:20, sep = \"\")\n\nann_colors <- list(\n  Time = c(\"white\", \"firebrick\"),\n  CellType = c(CT1 = \"#1B9E77\", CT2 = \"#D95F02\"),\n  GeneClass = c(Path1 = \"#7570B3\", Path2 = \"#E7298A\", Path3 = \"#66A61E\")\n)\npheatmap(test,\n  annotation_col = annotation_col,\n  annotation_row = annotation_row,\n  annotation_colors = ann_colors\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){fig-align='center' width=100%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n### split column and row\npheatmap(test,\n  annotation_col = annotation_col,\n  annotation_row = annotation_row,\n  annotation_colors = ann_colors,\n  row_split = annotation_row$GeneClass,\n  column_split = annotation_col$CellType\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){fig-align='center' width=100%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n## Combine multiple heatmap\np1 <- pheatmap(test, name = \"mat1\")\np2 <- rowAnnotation(foo = anno_barplot(1:nrow(test)))\np3 <- pheatmap(test,\n  name = \"mat2\",\n  col = c(\"navy\", \"white\", \"firebrick3\")\n)\np1 + p2 + p3\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=100%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n## Don't cluster\npheatmap(test,\n  annotation_col = annotation_col,\n  annotation_row = annotation_row,\n  annotation_colors = ann_colors,\n  row_split = annotation_row$GeneClass,\n  column_split = annotation_col$CellType,\n  cluster_rows = FALSE,\n  cluster_cols = FALSE\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Reference\n\n1. <https://jokergoo.github.io/ComplexHeatmap-reference/book/index.html>\n2. <https://jcoliver.github.io/learn-r/006-heatmaps.html>\n3. <https://statisticsglobe.com/draw-heatmap-like-plot-categorical-variables-r>\n4. <https://btep.ccr.cancer.gov/docs/data-visualization-with-r/Lesson5_intro_to_ggplot/>\n\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}