{
  "hash": "42940fbf0c3ec4e44cc84d575224b200",
  "result": {
    "markdown": "---\ntitle: \"Add errorbar and p-value on barplot with ggsignif\"\ndate: 2022-02-01\ndescription: \"\"\nimage: barplot.png\ncategories:\n  - ggsignif\n  - ggh4x\n  - ggplot2\n  - tidyverse\n  - R\n\n---\n\n\n\n\n\n## Prepare data\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggsignif)\nlibrary(ggh4x)\ndfb <- read.csv(\"221001_barplot.csv\", header = FALSE)\ndfb\n##                    V1   V2   V3   V4   V5   V6   V7 V8\n## 1             Control 0.06 0.00 0.39 0.22 0.22 0.36 NA\n## 2                  F5 0.99 1.00 0.95 0.97 0.97   NA NA\n## 3 pAtUbi3:CDS-Rps11-1 1.00 0.67 0.94 1.00 1.00   NA NA\n## 4 pAtUbi3:CDS-Rps11-2 0.94 1.00 0.94 0.94 1.00 1.00  1\ndfb.1 <- dfb %>%\n    pivot_longer(!V1) %>%\n    select(V1, value) %>%\n    na.omit()\ndfb.1\n## # A tibble: 23 × 2\n##    V1      value\n##    <chr>   <dbl>\n##  1 Control  0.06\n##  2 Control  0   \n##  3 Control  0.39\n##  4 Control  0.22\n##  5 Control  0.22\n##  6 Control  0.36\n##  7 F5       0.99\n##  8 F5       1   \n##  9 F5       0.95\n## 10 F5       0.97\n## # ℹ 13 more rows\n```\n:::\n\n\n## Define errorbar function\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nebtop <- function(x) {\n    return(mean(x) + sd(x) / sqrt(length(x)))\n}\nebbottom <- function(x) {\n    return(mean(x) - sd(x) / sqrt(length(x)))\n}\n```\n:::\n\n\n## Add errorbar and p-value\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np <- ggplot(data = dfb.1, aes(x = V1, y = value)) +\n    stat_summary(\n        geom = \"bar\",\n        fun = mean,\n        fill = \"#c6c3c3\"\n    ) +\n    stat_summary(\n        geom = \"errorbar\",\n        fun.min = ebbottom,\n        fun.max = ebtop,\n        width = 0.2\n    ) +\n    geom_jitter(width = 0.3) +\n    geom_signif(\n        comparisons = list(\n            c(\"Control\", \"F5\"),\n            c(\"Control\", \"pAtUbi3:CDS-Rps11-1\"),\n            c(\"Control\", \"pAtUbi3:CDS-Rps11-2\")\n        ),\n        test = t.test,\n        test.args = list(\n            var.equal = T,\n            alternative = \"two.side\"\n        ),\n        y_position = c(1.1, 1.3, 1.5),\n        annotations = c(\"\"),\n        parse = T\n    ) +\n    annotate(\n        geom = \"text\",\n        x = 1.5, y = 1.15,\n        label = expression(italic(P) ~ \"=\" ~ 1.83 %*% 10^-6)\n    ) +\n    annotate(\n        geom = \"text\",\n        x = 2, y = 1.35,\n        label = expression(italic(P) ~ \"=\" ~ 2.71 %*% 10^-5)\n    ) +\n    annotate(\n        geom = \"text\",\n        x = 2.5, y = 1.55,\n        label = expression(italic(P) ~ \"=\" ~ 5.75 %*% 10^-8)\n    ) +\n    scale_y_continuous(\n        expand = c(0, 0),\n        limits = c(0, 1.6),\n        breaks = seq(0, 1, 0.2)\n    ) +\n    theme_minimal() +\n    theme(\n        panel.grid = element_blank(),\n        axis.line.y = element_line(),\n        axis.ticks.y = element_line(),\n        axis.title.y = element_text(\n            hjust = 0.25,\n            size = 15\n        ),\n        axis.text.x = element_text(\n            angle = 30,\n            hjust = 1,\n            size = 10\n        )\n    ) +\n    guides(y = guide_axis_truncated(\n        trunc_lower = 0,\n        trunc_upper = 1\n    )) +\n    labs(x = NULL, y = \"Survival Rate\")\np\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\n## Reference\n\n1. <https://www.nature.com/articles/s41467-021-26554-8#Sec23>\n2. <https://statisticsglobe.com/ggsignif-package-r>\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}