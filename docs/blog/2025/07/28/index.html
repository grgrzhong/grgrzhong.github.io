<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Guorui Zhong">

<title>Bulk RNA-seq | From reads to DEGs – Guorui Zhong</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../">
<script src="../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-html/quarto-syntax-highlighting-cee8642dd6abb73bb51e0193ec9c0780.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../site_libs/bootstrap/bootstrap-a122eddc3d35102178d4fe042f5b75d5.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="../../../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner {
        background: #212529;
      }
</style>


</head>

<body class="floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../../index.html">
    <span class="navbar-title">Guorui Zhong</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../index.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../wiki/index.html"> 
<span class="menu-text">Wiki</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../programming/linux/index.html"> 
<span class="menu-text">Linux</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../programming/python/index.html"> 
<span class="menu-text">Python</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../programming/r/index.html"> 
<span class="menu-text">R</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../keyboard/index.html"> 
<span class="menu-text">Keyboard</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://scholar.google.com/citations?user=g0MfTPMAAAAJ&amp;hl=en"> <i class="bi bi-journal-check" role="img" aria-label="journal-check">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/guorui-zhong-754761185/"> <i class="bi bi-linkedin" role="img" aria-label="linkedin">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/guoruizhong"> <i class="bi bi-github" role="img" aria-label="github">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Bulk RNA-seq | From reads to DEGs</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">NGS</div>
                <div class="quarto-category">RNA-seq</div>
                <div class="quarto-category">scRNA-seq</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p><a href="https://grgrzhong.github.io/">Guorui Zhong</a> <a href="https://orcid.org/0000-0002-1955-2847" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">Monday, July 28, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#experimental-design" id="toc-experimental-design" class="nav-link active" data-scroll-target="#experimental-design">Experimental design</a>
  <ul class="collapse">
  <li><a href="#replicates" id="toc-replicates" class="nav-link" data-scroll-target="#replicates">Replicates</a></li>
  <li><a href="#confounding" id="toc-confounding" class="nav-link" data-scroll-target="#confounding">Confounding</a></li>
  <li><a href="#batch-effects" id="toc-batch-effects" class="nav-link" data-scroll-target="#batch-effects">Batch effects</a></li>
  </ul></li>
  <li><a href="#overall-workflow" id="toc-overall-workflow" class="nav-link" data-scroll-target="#overall-workflow">Overall Workflow</a>
  <ul class="collapse">
  <li><a href="#rna-extraction-and-library-preparation" id="toc-rna-extraction-and-library-preparation" class="nav-link" data-scroll-target="#rna-extraction-and-library-preparation">1. RNA extraction and library preparation</a></li>
  <li><a href="#sequencing---illumina" id="toc-sequencing---illumina" class="nav-link" data-scroll-target="#sequencing---illumina">2. Sequencing - Illumina</a></li>
  </ul></li>
  <li><a href="#counting-reads-associated-with-genes" id="toc-counting-reads-associated-with-genes" class="nav-link" data-scroll-target="#counting-reads-associated-with-genes">Counting reads associated with genes</a>
  <ul class="collapse">
  <li><a href="#quality-control-of-raw-reads" id="toc-quality-control-of-raw-reads" class="nav-link" data-scroll-target="#quality-control-of-raw-reads">1. Quality control of raw reads</a></li>
  <li><a href="#quantify-expression" id="toc-quantify-expression" class="nav-link" data-scroll-target="#quantify-expression">2. Quantify expression</a></li>
  </ul></li>
  <li><a href="#deg-analysis-tools" id="toc-deg-analysis-tools" class="nav-link" data-scroll-target="#deg-analysis-tools">DEG Analysis Tools</a>
  <ul class="collapse">
  <li><a href="#key-differences" id="toc-key-differences" class="nav-link" data-scroll-target="#key-differences">Key Differences</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul></li>
  <li><a href="#bulk-rna-seq" id="toc-bulk-rna-seq" class="nav-link" data-scroll-target="#bulk-rna-seq">Bulk RNA-seq</a></li>
  <li><a href="#single-cell-rna-seq" id="toc-single-cell-rna-seq" class="nav-link" data-scroll-target="#single-cell-rna-seq">Single-Cell RNA-seq</a></li>
  <li><a href="#reference" id="toc-reference" class="nav-link" data-scroll-target="#reference">Reference</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<section id="experimental-design" class="level2">
<h2 class="anchored" data-anchor-id="experimental-design">Experimental design</h2>
<ol type="1">
<li>Number and type of replicates</li>
<li>Avoiding confounding factors</li>
<li>Addressing batch effects</li>
</ol>
<section id="replicates" class="level3">
<h3 class="anchored" data-anchor-id="replicates">Replicates</h3>
<ul>
<li>Technical replicates: use the same biological sample to repeat the technical or experimental steps in order to accurately measure technical variation and remove it during analysis.</li>
<li>Biological replicates: use different biological samples of the same condition to measure the biological variation between samples.</li>
</ul>
<p><img src="replicates.png" class="img-fluid"></p>
<div class="callout-Note">
<ul>
<li>With the current RNA-seq technologies, technical variation is minimal, so technical replicates are generally not necessary.</li>
<li>In contrast, biological variation can be substantial, so biological replicates are essential for robust statistical analysis.</li>
<li>For differential expression analysis, the more biological replicates, the better the estimates of biological variation and the more precise our estimates of the mean expression levels.</li>
<li>Biological replicates are of greater importance than sequencing depth</li>
</ul>
</div>
<p><img src="de_replicates_img2.png" width="300"></p>
<ul>
<li>General gene-level differntial expression:
<ul>
<li>30M reads per sample for single-end reads</li>
<li>15M reads per sample if replicates &gt;=3</li>
<li>Length of reads: &gt;=50-100bp</li>
</ul></li>
<li>lowly expressed gene-level differntial expression:
<ul>
<li>30-60M reads</li>
<li>Length of reads: &gt;=50bp</li>
</ul></li>
<li>Isoform-level differntial expression:
<ul>
<li>Known isoforms, at least &gt;=30M reads per sample and paired-end reads</li>
<li>Novel isoforms, at least &gt;=60M reads per sample and paired-end reads</li>
<li>Length of reads: &gt;=50bp paired-end reads</li>
</ul></li>
</ul>
</section>
<section id="confounding" class="level3">
<h3 class="anchored" data-anchor-id="confounding">Confounding</h3>
<p>A confounded RNA-seq experiment is one where you <strong>cannot distinguish the separate effects of two different sources of variation</strong> in the data.</p>
<p>For example, we know that sex has large effects on gene expression, and if all of our <em>control</em> mice were female and all of the <em>treatment</em> mice were male, then our treatment effect would be confounded by sex. <strong>We could not differentiate the effect of treatment from the effect of sex.</strong></p>
<p><img src="confounded_design.png" width="500"></p>
<p><strong>To AVOID confounding:</strong></p>
<ul>
<li><p>Ensure animals in each condition are all the <strong>same sex, age, litter, and batch</strong>, if possible.</p></li>
<li><p>If not possible, then ensure to split the animals equally between conditions</p></li>
</ul>
<p><img src="non_confounded_design.png" width="500"></p>
</section>
<section id="batch-effects" class="level3">
<h3 class="anchored" data-anchor-id="batch-effects">Batch effects</h3>
<p>Batch effects are a significant issue for RNA-seq analyses, since you can see significant differences in expression due solely to the batch effect.</p>
<p><img src="batch_effect_pca.png" width="500"></p>
<p><strong>How to know whether you have batches?</strong></p>
<ul>
<li><p>Were all RNA isolations performed on the same day?</p></li>
<li><p>Were all library preparations performed on the same day?</p></li>
<li><p>Did the same person perform the RNA isolation/library preparation for all samples?</p></li>
<li><p>Did you use the same reagents for all samples?</p></li>
<li><p>Did you perform the RNA isolation/library preparation in the same location?</p></li>
</ul>
<p>If <em>any</em> of the answers is <strong>‘No’</strong>, then you have batches.</p>
<p><strong>Best practices regarding batches:</strong></p>
<ul>
<li><p>Design the experiment in a way to <strong>avoid batches</strong>, if possible.</p></li>
<li><p>If unable to avoid batches:</p>
<ul>
<li><strong>Do NOT confound</strong> your experiment by batch:</li>
</ul></li>
</ul>
<p><img src="confounded_batch.png" width="300"></p>
<ul>
<li><p><strong>DO</strong> split replicates of the different sample groups across batches. The more replicates, the better (definitely more than 2).</p>
<p><img src="batch_effect.png" width="300"></p></li>
<li><p><strong>DO</strong> include batch information in your <strong>experimental metadata</strong>. During the analysis, we can regress out the variation due to batch if not confounded so it doesn’t affect our results – if we have that information.</p></li>
</ul>
<p><img src="metadata_batch.png" width="300"></p>
</section>
</section>
<section id="overall-workflow" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="overall-workflow">Overall Workflow</h2>
<ul>
<li>Sequencing depth: total number of reads sequenced for a sample</li>
<li>Read length: number of base pairs in each read</li>
<li>Coverage: average number of reads that align to, or “cover,” each base in a reference sequence</li>
</ul>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="counts-workflow.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">RNA-seq Workflow</figcaption>
</figure>
</div>
<section id="rna-extraction-and-library-preparation" class="level3">
<h3 class="anchored" data-anchor-id="rna-extraction-and-library-preparation">1. RNA extraction and library preparation</h3>
<ul>
<li>Enriching for RNA: DNAse to remove any contaminating DNA -&gt; rRNA depletion or polyA selection.
<ul>
<li>Generally, ribosomal RNA represents the majority of the RNAs present in a cell, while messenger RNAs represent a small percentage of total RNA (~2% in humans).</li>
<li>Therefore, if we want to study the protein-coding genes, we need to enrich for mRNA or deplete the rRNA.</li>
<li>For differential gene expression analysis, it is best to enrich for Poly(A)+, unless you are aiming to obtain information about long non-coding RNAs, in which case ribosomal RNA depletion is recommended.</li>
</ul></li>
<li>RNA quality check: check for the RNA integrity prior to starting the cDNA library preparation.
<ul>
<li>Inspection of the ribosomal RNA bands via gel electrophoresis</li>
<li>Agilent Bioanalyzer -&gt; RIN (RNA Integrity Number) -&gt; provides a means by which RNA quality from different sources can be compared.</li>
</ul></li>
<li>Fragmentation and size selection
<ul>
<li>Chemical, enzymatic (e.g., RNAses), or physical process</li>
<li>Size selection to retain only those fragments that Illumina sequencing machines can handle</li>
<li>~150-300bp</li>
</ul></li>
<li>Reverse transcribe RNA into double-stranded cDNA
<ul>
<li>Most commonly used method incorporates deoxy-UTP (dUTP) during second strand synthesis</li>
<li>Add sequence adapters to the ends of the cDNA fragments</li>
</ul></li>
<li>PCR amplification
<ul>
<li>Run as few amplication cycles as possible to avoid PCR artefacets.</li>
</ul></li>
</ul>
<p><a href="library_prep.png"></a></p>
</section>
<section id="sequencing---illumina" class="level3">
<h3 class="anchored" data-anchor-id="sequencing---illumina">2. Sequencing - Illumina</h3>
<ul>
<li>Sequencing of the cDNA libraries will generate reads
<ul>
<li>SE-Single end dataset -&gt; Only Read1</li>
<li>PE-Paired end dataset -&gt; Read1 + Read2</li>
</ul></li>
<li>Sequencing by synthesis**
<ul>
<li>Cluster growth: Number of clusters ~= Number of reads</li>
<li>Sequencing</li>
<li>Image acquisition</li>
<li>Base calling: Number of sequencing cycles = Length of reads</li>
</ul></li>
</ul>
<p><a href="illumina_sequencing_process.png"></a></p>
</section>
</section>
<section id="counting-reads-associated-with-genes" class="level2">
<h2 class="anchored" data-anchor-id="counting-reads-associated-with-genes">Counting reads associated with genes</h2>
<section id="quality-control-of-raw-reads" class="level3">
<h3 class="anchored" data-anchor-id="quality-control-of-raw-reads">1. Quality control of raw reads</h3>
<ul>
<li>FastQC: https://www.bioinformatics.babraham.ac.uk/projects/fastqc/</li>
</ul>
</section>
<section id="quantify-expression" class="level3">
<h3 class="anchored" data-anchor-id="quantify-expression">2. Quantify expression</h3>
<p>To identify from which transcript each of the reads originated from and the total number of reads associated with each transcript. Lightweight alignment tools &amp; avoid base-to-base genomic alignment of the reads * Kallisto * Sailfish * Salmon</p>
<p>Genomic alignment Splice aware alignment tools * STAR * HISAT2</p>
<p>Quality control of aligned reads</p>
<ul>
<li>QualiMap: https://qualimap.bioinfo.cipf.es/
<ul>
<li>DNA or rRNA contamination</li>
<li>5’ to 3’ bias</li>
<li>Coverage biases</li>
</ul></li>
</ul>
<p>Quantification tools * featureCounts (subread package) * HTSeq-count</p>
<p><a href="deseq_counts_overview.png"></a></p>
<div class="callout-Note">
<p>The higher number of counts indicates more reads are associated with that gene and suggests a higher expression of that gene. However, this is not necessarily true, as the number of reads associated with a gene is also dependent on: - The length of the gene: longer genes will have more reads associated with them, even if they are expressed at the same level as shorter genes. - The sequencing depth: samples with more total reads will have more reads associated with each gene.</p>
</div>
<p>The above tools only report the “raw” counts of reads that map to a single location (uniquely mapping) and are best at counting at the gene level. Essentially, total read count associated with a gene (meta-feature) = the sum of reads associated with each of the exons (feature) that “belong” to that gene.</p>
<p>There are other tools available that are able to account for multiple transcripts for a given gene. In this case the counts are not whole numbers, but have fractions. In the simplest example case, if 1 read is associated with 2 transcripts, it can get counted as 0.5 and 0.5 and the resulting count for that transcript is not a whole number.</p>
<p>In addition there are other tools that will count multimapping reads, but this is a dangerous thing to do since you will be overcounting the total number of reads which can cause issues with normalization and eventually with accuracy of differential gene expression results.</p>
</section>
</section>
<section id="deg-analysis-tools" class="level2">
<h2 class="anchored" data-anchor-id="deg-analysis-tools">DEG Analysis Tools</h2>
<p>DESeq2, edgeR, and limma are widely used Bioconductor packages in R for differential gene expression analysis of RNA-seq or microarray data. Each employs distinct statistical approaches to identify differentially expressed genes, with differences in their underlying models, assumptions, and use cases. Below is an introduction and a summary of their key differences.</p>
<ul>
<li><p><strong>DESeq2</strong>: DESeq2 is designed for analyzing count-based data, primarily RNA-seq, using a negative binomial distribution to model read counts. It estimates variance-mean dependence in count data and applies shrinkage techniques for dispersion and fold-change estimates to improve robustness, especially for low-count genes. DESeq2 is particularly suited for experiments with small sample sizes and handles complex experimental designs well.</p></li>
<li><p><strong>edgeR</strong>: edgeR (empirical analysis of digital gene expression in R) is also tailored for count-based data like RNA-seq, using a negative binomial model. It emphasizes empirical Bayes methods to moderate dispersion estimates across genes, enhancing statistical power. edgeR is flexible for various experimental designs and is known for its speed and efficiency, particularly for large datasets.</p></li>
<li><p><strong>limma</strong>: Originally developed for microarray data, limma (linear models for microarray analysis) uses linear modeling and empirical Bayes methods to analyze log-transformed expression data. For RNA-seq, it employs the voom transformation to adapt count data for linear modeling, making it suitable for both microarray and RNA-seq. limma excels in handling complex experimental designs and is computationally efficient.</p></li>
</ul>
<section id="key-differences" class="level3">
<h3 class="anchored" data-anchor-id="key-differences">Key Differences</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 30%">
<col style="width: 30%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Aspect</strong></th>
<th><strong>DESeq2</strong></th>
<th><strong>edgeR</strong></th>
<th><strong>limma</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Primary Data Type</strong></td>
<td>RNA-seq count data (negative binomial model)</td>
<td>RNA-seq count data (negative binomial model)</td>
<td>Microarray (log-transformed) or RNA-seq (via voom transformation)</td>
</tr>
<tr class="even">
<td><strong>Statistical Model</strong></td>
<td>Negative binomial generalized linear model</td>
<td>Negative binomial generalized linear model</td>
<td>Linear model with empirical Bayes moderation (voom for RNA-seq)</td>
</tr>
<tr class="odd">
<td><strong>Normalization</strong></td>
<td>Median of ratios (geometric mean-based)</td>
<td>TMM (trimmed mean of M-values) or other methods</td>
<td>Quantile normalization (microarray) or voom (RNA-seq)</td>
</tr>
<tr class="even">
<td><strong>Dispersion Estimation</strong></td>
<td>Shrinkage of gene-wise dispersions toward a fitted trend</td>
<td>Empirical Bayes shrinkage of dispersions</td>
<td>Empirical Bayes moderation of variance (via voom weights for RNA-seq)</td>
</tr>
<tr class="odd">
<td><strong>Shrinkage Approach</strong></td>
<td>Shrinks both dispersions and log-fold changes for stable estimates</td>
<td>Shrinks dispersions but not log-fold changes</td>
<td>Shrinks variance estimates (not directly log-fold changes)</td>
</tr>
<tr class="even">
<td><strong>Performance</strong></td>
<td>Robust for small sample sizes; slower for large datasets</td>
<td>Fast and efficient, especially for large datasets</td>
<td>Very fast, especially for large datasets; less optimal for small samples</td>
</tr>
<tr class="odd">
<td><strong>Use Case</strong></td>
<td>RNA-seq, small sample sizes, complex designs</td>
<td>RNA-seq, large datasets, flexible designs</td>
<td>Microarray or RNA-seq, complex designs, large sample sizes</td>
</tr>
<tr class="even">
<td><strong>Transformation</strong></td>
<td>No transformation; directly models counts</td>
<td>No transformation; directly models counts</td>
<td>Log-transformation (voom for RNA-seq to estimate precision weights)</td>
</tr>
<tr class="odd">
<td><strong>Input and Outputs</strong></td>
<td><strong>Input</strong>: Raw count data (integer counts from RNA-seq) <br> <strong>Output</strong>: Log2 fold changes, p-values, adjusted p-values (FDR)</td>
<td><strong>Input</strong>: Raw count data (integer counts from RNA-seq) <br> <strong>Output</strong>: Log2 fold changes, p-values, adjusted p-values (FDR)</td>
<td><strong>Input</strong>: Log-transformed data (microarray) or raw counts transformed via voom (RNA-seq) <br> <strong>Output</strong>: Log2 fold changes, p-values, adjusted p-values (FDR)</td>
</tr>
<tr class="even">
<td><strong>Flexibility</strong></td>
<td>Handles complex designs; less flexible for non-count data</td>
<td>Highly flexible for count-based data and designs</td>
<td>Most flexible for complex designs across microarray and RNA-seq</td>
</tr>
</tbody>
</table>
</section>
<section id="summary" class="level3">
<h3 class="anchored" data-anchor-id="summary">Summary</h3>
<ul>
<li><strong>DESeq2</strong> is ideal for RNA-seq data with small sample sizes, offering robust shrinkage for dispersion and fold-change estimates, making it reliable for low-count genes. It uses a negative binomial model and median-of-ratios normalization.</li>
<li><strong>edgeR</strong> is also tailored for RNA-seq, with fast performance and empirical Bayes dispersion shrinkage, making it suitable for large datasets and flexible designs. It uses TMM normalization and is less aggressive in fold-change shrinkage.</li>
<li><strong>limma</strong> is versatile for both microarray and RNA-seq (via voom), excelling in complex experimental designs and large datasets. It uses linear models with empirical Bayes variance moderation, requiring log-transformation of data.</li>
</ul>
<p>In practice, the choice depends on the data type (RNA-seq vs.&nbsp;microarray), sample size, and experimental complexity. DESeq2 and edgeR are preferred for RNA-seq with count data, while limma is more versatile for both data types, especially with large samples or complex designs. All three produce comparable results in many cases, but their performance can vary based on dataset characteristics.</p>
</section>
</section>
<section id="bulk-rna-seq" class="level2">
<h2 class="anchored" data-anchor-id="bulk-rna-seq">Bulk RNA-seq</h2>
<ul>
<li>Cheaper</li>
<li>Simpler</li>
<li>Statistically stronger with replicates</li>
</ul>
<p>Suitable for: ✔️ Homogeneous samples (like cell lines) ✔️ High-throughput designs with many conditions ✔️ Studies where replication is key (e.g., drug treatments, time-course) ✔️ Situations where per-cell resolution won’t change your biological conclusion</p>
</section>
<section id="single-cell-rna-seq" class="level2">
<h2 class="anchored" data-anchor-id="single-cell-rna-seq">Single-Cell RNA-seq</h2>
<p>Use scRNA-seq if your question depends on:</p>
<ul>
<li>Detecting rare populations</li>
<li>Disentangling heterogeneous tissues</li>
<li>Discovering cell-type-specific signals</li>
</ul>
<p>In these cases, resolution matters—and scRNA-seq earns its price tag.</p>
<p>But know this: you’re trading off simplicity, QC, and replicability.</p>
</section>
<section id="reference" class="level2">
<h2 class="anchored" data-anchor-id="reference">Reference</h2>
<ul>
<li><a href="https://hbctraining.github.io/Intro-to-bulk-RNAseq/schedule/links-to-lessons.html">Introduction to bulk RNA-seq: From reads to count matrix</a></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/grgrzhong\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p><span class="faux-block"><i class="fa-brands fa-creative-commons" aria-label="creative-commons"></i> 2021-2024 Guorui Zhong ~ Made with <a href="https://www.r-project.org/"><i class="fa-brands fa-r-project" aria-label="r-project"></i></a> and <a href="https://quarto.org/">Quarto</a></span></p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>